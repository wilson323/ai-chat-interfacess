# FastGPT é›†æˆä¸“å®¶åˆ†ææŠ¥å‘Š

## ğŸ“‹ åˆ†ææ¦‚è¿°

é€šè¿‡å¯¹å½“å‰FastGPTé›†æˆç³»ç»Ÿçš„æ·±å…¥åˆ†æï¼Œå·²å®Œæˆå…¨é¢çš„é›†æˆéœ€æ±‚è¯„ä¼°å’Œä¼˜åŒ–æ–¹æ¡ˆè®¾è®¡ã€‚

## ğŸ” å½“å‰é›†æˆç°çŠ¶åˆ†æ

### 1. FastGPT APIé›†æˆæ¶æ„

- **APIç«¯ç‚¹**: ç»Ÿä¸€ä½¿ç”¨ `https://zktecoaihub.com/api/v1/chat/completions`
- **è®¤è¯æ–¹å¼**: Bearer Token + AppId åŒé‡è®¤è¯
- **æ”¯æŒåŠŸèƒ½**: æµå¼/éæµå¼å¯¹è¯ã€åˆå§‹åŒ–ã€é—®é¢˜å»ºè®®
- **ä»£ç†æœºåˆ¶**: é€šè¿‡ `/api/chat-proxy` å¤„ç†è·¨åŸŸè¯·æ±‚

### 2. å¤šæ™ºèƒ½ä½“é…ç½®ç®¡ç†

- **æ•°æ®æ¨¡å‹**: `AgentConfig` æ•°æ®è¡¨å­˜å‚¨é…ç½®ä¿¡æ¯
- **ç±»å‹åŒºåˆ†**:
  - `fastgpt`: FastGPT API æ™ºèƒ½ä½“ï¼Œæ•°æ®ä¸æœ¬åœ°å­˜å‚¨
  - `cad-analyzer`/`image-editor`: è‡ªç ”æ™ºèƒ½ä½“ï¼Œæ•°æ®æœ¬åœ°å­˜å‚¨
- **é…ç½®é¡¹**: APIå¯†é’¥ã€AppIdã€ç³»ç»Ÿæç¤ºè¯ã€æ¸©åº¦ã€æœ€å¤§Tokenç­‰

### 3. ç°æœ‰å®‰å…¨æœºåˆ¶

- **æ•°æ®åŠ å¯†**: AES-256-CBC åŠ å¯†æ•æ„Ÿä¿¡æ¯
- **è¾“å…¥éªŒè¯**: XSS/SQLæ³¨å…¥æ£€æµ‹
- **æƒé™æ§åˆ¶**: ç®¡ç†ç«¯TokenéªŒè¯
- **å¯†é’¥è„±æ•**: æ˜¾ç¤ºæ—¶éšè—æ•æ„Ÿä¿¡æ¯

## ğŸ¯ ä¼˜åŒ–æ–¹æ¡ˆè®¾è®¡

### 1. å‡è½»FastGPTå‹åŠ›çš„ç¼“å­˜ç­–ç•¥

#### å¤šå±‚ç¼“å­˜æ¶æ„

```
å®¢æˆ·ç«¯ç¼“å­˜ â†’ Redisç¼“å­˜ â†’ æ•°æ®åº“ç¼“å­˜ â†’ FastGPT API
```

#### ç¼“å­˜ç­–ç•¥é…ç½®

```typescript
interface CacheStrategy {
  // å¯¹è¯å†å²ç¼“å­˜ (24å°æ—¶)
  chatHistory: {
    ttl: 86400;
    maxSize: 1000;
    keyPattern: `chat:${agentId}:${userId}:${chatId}`;
  };

  // æ™ºèƒ½ä½“é…ç½®ç¼“å­˜ (1å°æ—¶)
  agentConfig: {
    ttl: 3600;
    keyPattern: `agent:${agentId}`;
  };

  // é—®é¢˜å»ºè®®ç¼“å­˜ (5åˆ†é’Ÿ)
  suggestions: {
    ttl: 300;
    keyPattern: `suggestions:${agentId}:${contextHash}`;
  };

  // ä¼šè¯åˆå§‹åŒ–ç¼“å­˜ (30åˆ†é’Ÿ)
  chatInit: {
    ttl: 1800;
    keyPattern: `init:${agentId}:${chatId}`;
  };
}
```

#### æ™ºèƒ½ç¼“å­˜æ·˜æ±°ç­–ç•¥

- **LRUç®—æ³•**: æœ€è¿‘æœ€å°‘ä½¿ç”¨æ·˜æ±°
- **çƒ­ç‚¹æ•°æ®é¢„åŠ è½½**: å¸¸ç”¨é—®é¢˜é¢„ç¼“å­˜
- **åˆ†å¸ƒå¼ç¼“å­˜**: Redisé›†ç¾¤æ”¯æŒ

### 2. APIè°ƒç”¨ä¼˜åŒ–ç­–ç•¥

#### æ‰¹é‡è¯·æ±‚åˆå¹¶

```typescript
interface BatchRequest {
  agentId: string;
  requests: ChatMessage[];
  priority: 'high' | 'normal' | 'low';
  timeout: number;
}
```

#### è¯·æ±‚å»é‡å’ŒèŠ‚æµ

- **å†…å®¹å»é‡**: ç›¸åŒè¯·æ±‚åˆå¹¶å¤„ç†
- **é¢‘ç‡é™åˆ¶**: ç”¨æˆ·çº§åˆ«å’Œæ™ºèƒ½ä½“çº§åˆ«é™åˆ¶
- **ä¼˜å…ˆçº§é˜Ÿåˆ—**: é«˜ä¼˜å…ˆçº§è¯·æ±‚ä¼˜å…ˆå¤„ç†

#### è¿æ¥æ± ä¼˜åŒ–

- **è¿æ¥å¤ç”¨**: HTTP Keep-Alive
- **è¶…æ—¶æ§åˆ¶**: æ™ºèƒ½è¶…æ—¶å’Œé‡è¯•
- **ç†”æ–­æœºåˆ¶**: æ•…éšœè‡ªåŠ¨åˆ‡æ¢

### 3. é…ç½®ç®¡ç†ä¼˜åŒ–

#### çƒ­æ›´æ–°æœºåˆ¶

```typescript
interface ConfigHotUpdate {
  // é…ç½®ç‰ˆæœ¬æ§åˆ¶
  version: string;

  // å¢é‡æ›´æ–°
  deltaChanges: ConfigChange[];

  // å®æ—¶æ¨é€
  pushStrategy: 'websocket' | 'polling' | 'sse';
}
```

#### é…ç½®åŒæ­¥ç­–ç•¥

- **ç‰ˆæœ¬æ§åˆ¶**: é…ç½®å˜æ›´ç‰ˆæœ¬è·Ÿè¸ª
- **å¢é‡åŒæ­¥**: åªåŒæ­¥å˜æ›´çš„éƒ¨åˆ†
- **å†²çªè§£å†³**: å¤šå®¢æˆ·ç«¯é…ç½®å†²çªå¤„ç†
- **å›æ»šæœºåˆ¶**: é…ç½®é”™è¯¯å¿«é€Ÿå›æ»š

### 4. ç›‘æ§å’Œå‘Šè­¦ç³»ç»Ÿ

#### æ€§èƒ½ç›‘æ§æŒ‡æ ‡

```typescript
interface MonitoringMetrics {
  // APIæ€§èƒ½
  api: {
    responseTime: number[];
    errorRate: number;
    throughput: number;
  };

  // ç¼“å­˜æ€§èƒ½
  cache: {
    hitRate: number;
    memoryUsage: number;
    keyCount: number;
  };

  // ç³»ç»Ÿå¥åº·
  health: {
    cpuUsage: number;
    memoryUsage: number;
    diskUsage: number;
  };
}
```

#### å‘Šè­¦è§„åˆ™

- **æ€§èƒ½å‘Šè­¦**: å“åº”æ—¶é—´ > 2ç§’
- **é”™è¯¯å‘Šè­¦**: é”™è¯¯ç‡ > 5%
- **å®¹é‡å‘Šè­¦**: ç¼“å­˜ä½¿ç”¨ç‡ > 80%
- **å®‰å…¨å‘Šè­¦**: å¼‚å¸¸è¯·æ±‚æ¨¡å¼æ£€æµ‹

## ğŸ” å®‰å…¨ç®¡ç†æ–¹æ¡ˆ

### 1. APIå¯†é’¥ç®¡ç†

#### åˆ†çº§å¯†é’¥ç­–ç•¥

```typescript
interface KeyManagement {
  // ä¸»å¯†é’¥ - ç®¡ç†å‘˜ä½¿ç”¨
  masterKey: string;

  // åº”ç”¨å¯†é’¥ - æ™ºèƒ½ä½“ä¸“ç”¨
  appKeys: {
    [agentId: string]: {
      key: string;
      permissions: string[];
      rateLimit: number;
    };
  };

  // ä¸´æ—¶å¯†é’¥ - çŸ­æœŸè®¿é—®
  tempKeys: {
    [token: string]: {
      expiresAt: Date;
      scope: string[];
    };
  };
}
```

#### å¯†é’¥è½®æ¢æœºåˆ¶

- **å®šæœŸè½®æ¢**: æ¯90å¤©è‡ªåŠ¨è½®æ¢
- **ç´§æ€¥è½®æ¢**: å®‰å…¨äº‹ä»¶è§¦å‘ç«‹å³è½®æ¢
- **å¹³æ»‘è¿‡æ¸¡**: æ–°æ—§å¯†é’¥å¹¶è¡Œä½¿ç”¨æœŸ

### 2. è®¿é—®æ§åˆ¶

#### åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ (RBAC)

```typescript
interface RoleBasedAccess {
  roles: {
    admin: {
      permissions: ['*'];
    };
    agent_manager: {
      permissions: ['agent:read', 'agent:write', 'agent:config'];
    };
    user: {
      permissions: ['chat:read', 'chat:write'];
    };
  };
}
```

#### APIè®¿é—®æ§åˆ¶

- **IPç™½åå•**: é™åˆ¶è®¿é—®æ¥æº
- **æ—¶é—´çª—å£**: è®¿é—®æ—¶é—´é™åˆ¶
- **åœ°ç†ä½ç½®**: åœ°ç†ä½ç½®é™åˆ¶
- **è®¾å¤‡æŒ‡çº¹**: è®¾å¤‡ç»‘å®šéªŒè¯

### 3. æ•°æ®å®‰å…¨

#### ä¼ è¾“å®‰å…¨

- **HTTPSå¼ºåˆ¶**: æ‰€æœ‰APIå¿…é¡»ä½¿ç”¨HTTPS
- **HSTS**: ä¸¥æ ¼ä¼ è¾“å®‰å…¨
- **CORS**: è·¨åŸŸè®¿é—®æ§åˆ¶
- **CSRFä¿æŠ¤**: è·¨ç«™è¯·æ±‚ä¼ªé€ é˜²æŠ¤

#### å­˜å‚¨å®‰å…¨

- **å­—æ®µçº§åŠ å¯†**: æ•æ„Ÿå­—æ®µå•ç‹¬åŠ å¯†
- **è®¿é—®å®¡è®¡**: å®Œæ•´çš„è®¿é—®æ—¥å¿—
- **æ•°æ®è„±æ•**: æ˜¾ç¤ºæ—¶è‡ªåŠ¨è„±æ•
- **å¤‡ä»½åŠ å¯†**: æ•°æ®åº“å¤‡ä»½åŠ å¯†

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–ç›®æ ‡

### 1. å“åº”æ—¶é—´ç›®æ ‡

- **å¯¹è¯å“åº”**: < 500ms (ç¼“å­˜å‘½ä¸­)
- **APIè°ƒç”¨**: < 2ç§’ (FastGPTå“åº”)
- **é…ç½®åŠ è½½**: < 100ms (æœ¬åœ°ç¼“å­˜)
- **åˆå§‹åŒ–**: < 1ç§’ (ä¼šè¯å»ºç«‹)

### 2. å¯ç”¨æ€§ç›®æ ‡

- **ç³»ç»Ÿå¯ç”¨æ€§**: 99.9%
- **APIæˆåŠŸç‡**: 99.5%
- **ç¼“å­˜å‘½ä¸­ç‡**: 85%
- **é”™è¯¯æ¢å¤**: < 30ç§’

### 3. æ‰©å±•æ€§ç›®æ ‡

- **å¹¶å‘ç”¨æˆ·**: 10,000+
- **QPSå¤„ç†**: 1,000+
- **æ•°æ®å­˜å‚¨**: 1TB+
- **æ™ºèƒ½ä½“æ•°é‡**: 100+

## ğŸ› ï¸ å®æ–½è®¡åˆ’

### é˜¶æ®µä¸€: ç¼“å­˜ä¼˜åŒ– (1-2å‘¨)

1. éƒ¨ç½²Redisé›†ç¾¤
2. å®ç°å¤šå±‚ç¼“å­˜ç­–ç•¥
3. é…ç½®ç¼“å­˜æ·˜æ±°ç®—æ³•
4. æµ‹è¯•ç¼“å­˜æ€§èƒ½

### é˜¶æ®µäºŒ: APIä¼˜åŒ– (2-3å‘¨)

1. å®ç°è¯·æ±‚æ‰¹å¤„ç†
2. ä¼˜åŒ–è¿æ¥æ± ç®¡ç†
3. æ·»åŠ ç†”æ–­æœºåˆ¶
4. æ€§èƒ½ç›‘æ§é›†æˆ

### é˜¶æ®µä¸‰: å®‰å…¨åŠ å›º (2-3å‘¨)

1. å¯†é’¥ç®¡ç†ç³»ç»Ÿå‡çº§
2. RBACæƒé™ç³»ç»Ÿå®ç°
3. æ•°æ®åŠ å¯†å¢å¼º
4. å®‰å…¨å®¡è®¡å®Œå–„

### é˜¶æ®µå››: ç›‘æ§ç³»ç»Ÿ (1-2å‘¨)

1. ç›‘æ§æŒ‡æ ‡å®šä¹‰
2. å‘Šè­¦è§„åˆ™é…ç½®
3. å¯è§†åŒ–ä»ªè¡¨æ¿
4. æ€§èƒ½æŠ¥å‘Šç”Ÿæˆ

## ğŸ“Š é¢„æœŸæ”¶ç›Š

### 1. æ€§èƒ½æå‡

- **å“åº”æ—¶é—´**: å‡å°‘60-80%
- **APIè°ƒç”¨**: å‡å°‘40-60%
- **å¹¶å‘èƒ½åŠ›**: æå‡3-5å€
- **ç³»ç»Ÿç¨³å®šæ€§**: æå‡50%

### 2. æˆæœ¬ä¼˜åŒ–

- **APIè´¹ç”¨**: å‡å°‘50-70%
- **æœåŠ¡å™¨èµ„æº**: å‡å°‘30-50%
- **è¿ç»´æˆæœ¬**: å‡å°‘40%
- **å¼€å‘æ•ˆç‡**: æå‡30%

### 3. ç”¨æˆ·ä½“éªŒ

- **å“åº”é€Ÿåº¦**: æå‡3-5å€
- **ç³»ç»Ÿç¨³å®šæ€§**: 99.9%å¯ç”¨æ€§
- **åŠŸèƒ½ä¸°å¯Œåº¦**: å¢åŠ 2-3å€
- **å®‰å…¨æ€§**: ä¼ä¸šçº§ä¿éšœ

## ğŸ”§ æŠ€æœ¯æ¶æ„å‡çº§å»ºè®®

### 1. å¾®æœåŠ¡åŒ–æ”¹é€ 

- **æ™ºèƒ½ä½“æœåŠ¡**: ç‹¬ç«‹éƒ¨ç½²å’Œç®¡ç†
- **ç¼“å­˜æœåŠ¡**: Redisé›†ç¾¤ç‹¬ç«‹æœåŠ¡
- **é…ç½®æœåŠ¡**: é›†ä¸­é…ç½®ç®¡ç†
- **ç›‘æ§æœåŠ¡**: ç»Ÿä¸€ç›‘æ§å¹³å°

### 2. å®¹å™¨åŒ–éƒ¨ç½²

- **Dockerå®¹å™¨**: æ ‡å‡†åŒ–éƒ¨ç½²
- **Kubernetes**: è‡ªåŠ¨æ‰©ç¼©å®¹
- **è´Ÿè½½å‡è¡¡**: å¤šå®ä¾‹éƒ¨ç½²
- **æœåŠ¡ç½‘æ ¼**: æœåŠ¡é—´é€šä¿¡ä¼˜åŒ–

### 3. DevOpsé›†æˆ

- **CI/CDç®¡é“**: è‡ªåŠ¨åŒ–éƒ¨ç½²
- **è‡ªåŠ¨åŒ–æµ‹è¯•**: è´¨é‡ä¿éšœ
- **æ—¥å¿—èšåˆ**: ç»Ÿä¸€æ—¥å¿—ç®¡ç†
- **æ€§èƒ½ç›‘æ§**: å®æ—¶æ€§èƒ½ç›‘æ§

## ğŸ“ é£é™©è¯„ä¼°ä¸å¯¹ç­–

### 1. æŠ€æœ¯é£é™©

- **ç¼“å­˜ä¸€è‡´æ€§**: å®ç°ç¼“å­˜å¤±æ•ˆç­–ç•¥
- **ç³»ç»Ÿå¤æ‚æ€§**: åˆ†é˜¶æ®µå®æ–½ï¼Œå……åˆ†æµ‹è¯•
- **æ€§èƒ½ç“¶é¢ˆ**: é¢„ç•™æ‰©å±•ç©ºé—´ï¼Œç›‘æ§å…³é”®æŒ‡æ ‡

### 2. å®‰å…¨é£é™©

- **å¯†é’¥æ³„éœ²**: å®æ–½å¯†é’¥è½®æ¢å’Œè®¿é—®æ§åˆ¶
- **æ•°æ®æ³„éœ²**: åŠ å¼ºæ•°æ®åŠ å¯†å’Œè®¿é—®å®¡è®¡
- **DDoSæ”»å‡»**: å®æ–½é™æµå’Œç†”æ–­æœºåˆ¶

### 3. è¿è¥é£é™©

- **ç³»ç»Ÿæ•…éšœ**: å»ºç«‹æ•…éšœæ¢å¤æœºåˆ¶
- **äººå‘˜å˜åŠ¨**: å®Œå–„æ–‡æ¡£å’ŒåŸ¹è®­
- **éœ€æ±‚å˜æ›´**: ä¿æŒæ¶æ„çµæ´»æ€§

---

**ç»“è®º**: é€šè¿‡å…¨é¢çš„ç¼“å­˜ä¼˜åŒ–ã€APIè°ƒç”¨ç­–ç•¥æ”¹è¿›ã€å®‰å…¨æœºåˆ¶åŠ å¼ºå’Œç›‘æ§ç³»ç»Ÿå®Œå–„ï¼Œå¯ä»¥æ˜¾è‘—æå‡FastGPTé›†æˆç³»ç»Ÿçš„æ€§èƒ½ã€å®‰å…¨æ€§å’Œå¯ç»´æŠ¤æ€§ï¼Œä¸ºä¼ä¸šçº§åº”ç”¨æä¾›ç¨³å®šå¯é çš„æ™ºèƒ½æœåŠ¡ã€‚
