# å…¨å±€ä»£ç è´¨é‡åˆ†ææŠ¥å‘Š

## ğŸ“Š ä»£ç è´¨é‡ç°çŠ¶åˆ†æ

### 1. æ•°æ®åº“å¤„ç†åˆ†æ

#### å½“å‰æ•°æ®åº“æ–¹æ¡ˆ

- **ORM**: Sequelize (æˆç†Ÿç¨³å®š)
- **æ•°æ®åº“**: PostgreSQL (ä¼ä¸šçº§)
- **è¿æ¥æ± **: å·²é…ç½® (max: 10, min: 0)
- **è¿ç§»**: æ‰‹åŠ¨ç®¡ç†

#### ä¼˜åŒ–å»ºè®®

1. **è¿æ¥æ± ä¼˜åŒ–**: å½“å‰é…ç½®åˆç†ï¼Œä½†å¯ä»¥æ·»åŠ ç›‘æ§
2. **æŸ¥è¯¢ä¼˜åŒ–**: ç¼ºå°‘æŸ¥è¯¢æ€§èƒ½ç›‘æ§
3. **é”™è¯¯å¤„ç†**: éœ€è¦ç»Ÿä¸€çš„æ•°æ®åº“é”™è¯¯å¤„ç†
4. **ç¼“å­˜ç­–ç•¥**: å·²é…ç½®Redisï¼Œä½†ä½¿ç”¨ä¸å¤Ÿå……åˆ†

### 2. ä»£ç è§„èŒƒåˆ†æ

#### æ–¹æ³•å‘½åè§„èŒƒ

**é—®é¢˜å‘ç°**:

- âœ… å¤§éƒ¨åˆ†æ–¹æ³•ä½¿ç”¨camelCase (å¦‚: `createNewConversation`, `debounce`)
- âŒ éƒ¨åˆ†æ–¹æ³•ç¼ºå°‘æè¿°æ€§å‘½å (å¦‚: `fn`, `timer`)
- âŒ éƒ¨åˆ†å˜é‡å‘½åä¸å¤Ÿæ¸…æ™° (å¦‚: `t`, `e`)

#### æ³¨é‡Šå®Œæ•´æ€§

**é—®é¢˜å‘ç°**:

- âœ… æ•°æ®åº“æ¨¡å‹æœ‰è¯¦ç»†æ³¨é‡Š
- âŒ ç»„ä»¶æ–¹æ³•ç¼ºå°‘JSDocæ³¨é‡Š
- âŒ å¤æ‚ä¸šåŠ¡é€»è¾‘ç¼ºå°‘è¡Œå†…æ³¨é‡Š
- âŒ ç±»å‹å®šä¹‰ç¼ºå°‘è¯¦ç»†è¯´æ˜

#### ä¾èµ–æ¸…ç†

**é—®é¢˜å‘ç°**:

- âŒ å­˜åœ¨æœªä½¿ç”¨çš„å¯¼å…¥ (å¦‚: `useState` å¤šæ¬¡å¯¼å…¥)
- âŒ å­˜åœ¨é‡å¤çš„å¯¼å…¥
- âŒ å­˜åœ¨æœªä½¿ç”¨çš„å˜é‡å’Œå‡½æ•°

### 3. æ¶æ„ä¼˜åŒ–åˆ†æ

#### ç»„ä»¶è®¾è®¡

**é—®é¢˜å‘ç°**:

- âŒ `ChatContainer` ç»„ä»¶è¿‡äºåºå¤§ (3000+ è¡Œ)
- âŒ çŠ¶æ€ç®¡ç†åˆ†æ•£ï¼Œç¼ºå°‘ç»Ÿä¸€ç®¡ç†
- âŒ ä¸šåŠ¡é€»è¾‘ä¸UIé€»è¾‘æ··åˆ

#### ç±»å‹å®šä¹‰

**é—®é¢˜å‘ç°**:

- âœ… å·²åˆ›å»ºç»Ÿä¸€ç±»å‹å®šä¹‰ä¸­å¿ƒ
- âŒ éƒ¨åˆ†ç±»å‹å®šä¹‰é‡å¤
- âŒ ç¼ºå°‘ä¸¥æ ¼çš„ç±»å‹çº¦æŸ

## ğŸ¯ ä¼˜åŒ–æ–¹æ¡ˆ

### 1. æ•°æ®åº“å¤„ç†ä¼˜åŒ–

#### ä½¿ç”¨æˆç†Ÿçš„æ•°æ®åº“è§£å†³æ–¹æ¡ˆ

```typescript
// æ¨èä½¿ç”¨ Prisma æ›¿ä»£ Sequelize
// ä¼˜åŠ¿: ç±»å‹å®‰å…¨ã€è‡ªåŠ¨ç”Ÿæˆå®¢æˆ·ç«¯ã€æ›´å¥½çš„å¼€å‘ä½“éªŒ
import { PrismaClient } from '@prisma/client';

const prisma = new PrismaClient({
  log: ['query', 'info', 'warn', 'error'],
  errorFormat: 'pretty',
});
```

#### æ•°æ®åº“è¿æ¥æ± ä¼˜åŒ–

```typescript
// ä¼˜åŒ–è¿æ¥æ± é…ç½®
const sequelize = new Sequelize(DB_NAME, DB_USER, DB_PASSWORD, {
  host: DB_HOST,
  port: DB_PORT,
  dialect: 'postgres',
  pool: {
    max: 20, // å¢åŠ æœ€å¤§è¿æ¥æ•°
    min: 5, // å¢åŠ æœ€å°è¿æ¥æ•°
    acquire: 30000,
    idle: 10000,
    evict: 1000, // æ·»åŠ æ¸…ç†é—´éš”
  },
  retry: {
    max: 3, // æ·»åŠ é‡è¯•æœºåˆ¶
  },
  benchmark: true, // æ·»åŠ æ€§èƒ½ç›‘æ§
});
```

### 2. ä»£ç è§„èŒƒä¼˜åŒ–

#### æ–¹æ³•å‘½åè§„èŒƒ

```typescript
// âœ… å¥½çš„å‘½åç¤ºä¾‹
function createNewConversation(): void;
function handleUserInput(input: string): void;
function validateMessageContent(content: string): boolean;

// âŒ ä¸å¥½çš„å‘½åç¤ºä¾‹
function fn(): void;
function handle(e: Event): void;
function process(data: any): any;
```

#### æ³¨é‡Šè§„èŒƒ

````typescript
/**
 * åˆ›å»ºæ–°çš„å¯¹è¯ä¼šè¯
 * @description åˆå§‹åŒ–æ–°çš„èŠå¤©ä¼šè¯ï¼Œé‡ç½®ç›¸å…³çŠ¶æ€
 * @returns {void}
 * @example
 * ```typescript
 * createNewConversation()
 * ```
 */
function createNewConversation(): void {
  // å®ç°é€»è¾‘
}
````

### 3. ç»„ä»¶æ¶æ„ä¼˜åŒ–

#### ç»„ä»¶æ‹†åˆ†

```typescript
// å°† ChatContainer æ‹†åˆ†ä¸ºå¤šä¸ªå°ç»„ä»¶
export function ChatContainer() {
  return (
    <div className="chat-container">
      <ChatHeader />
      <ChatMessages />
      <ChatInput />
      <ChatOptions />
    </div>
  )
}
```

#### çŠ¶æ€ç®¡ç†ä¼˜åŒ–

```typescript
// ä½¿ç”¨ Zustand è¿›è¡ŒçŠ¶æ€ç®¡ç†
interface ChatState {
  messages: Message[];
  input: string;
  isLoading: boolean;
  addMessage: (message: Message) => void;
  setInput: (input: string) => void;
  setLoading: (loading: boolean) => void;
}
```

## ğŸ“‹ å…·ä½“ä¼˜åŒ–ä»»åŠ¡

### é˜¶æ®µ1: ä»£ç è§„èŒƒä¼˜åŒ– (ç«‹å³æ‰§è¡Œ)

1. **æ–¹æ³•å‘½åè§„èŒƒåŒ–**
   - é‡å‘½åæ‰€æœ‰ä¸ç¬¦åˆcamelCaseçš„æ–¹æ³•
   - ç¡®ä¿æ–¹æ³•åå…·æœ‰æè¿°æ€§
   - é¿å…ä½¿ç”¨ç¼©å†™å’Œå•å­—æ¯å˜é‡å

2. **æ³¨é‡Šå®Œæ•´æ€§**
   - ä¸ºæ‰€æœ‰å…¬å…±æ–¹æ³•æ·»åŠ JSDocæ³¨é‡Š
   - ä¸ºå¤æ‚ä¸šåŠ¡é€»è¾‘æ·»åŠ è¡Œå†…æ³¨é‡Š
   - ä¸ºç±»å‹å®šä¹‰æ·»åŠ è¯¦ç»†è¯´æ˜

3. **ä¾èµ–æ¸…ç†**
   - ç§»é™¤æœªä½¿ç”¨çš„å¯¼å…¥
   - ç§»é™¤æœªä½¿ç”¨çš„å˜é‡å’Œå‡½æ•°
   - ä¼˜åŒ–å¯¼å…¥é¡ºåº

### é˜¶æ®µ2: æ¶æ„ä¼˜åŒ– (æœ¬å‘¨å†…)

1. **ç»„ä»¶æ‹†åˆ†**
   - å°†å¤§å‹ç»„ä»¶æ‹†åˆ†ä¸ºå°ç»„ä»¶
   - åˆ†ç¦»ä¸šåŠ¡é€»è¾‘å’ŒUIé€»è¾‘
   - æé«˜ç»„ä»¶å¯å¤ç”¨æ€§

2. **çŠ¶æ€ç®¡ç†ä¼˜åŒ–**
   - ç»Ÿä¸€çŠ¶æ€ç®¡ç†
   - å‡å°‘ä¸å¿…è¦çš„çŠ¶æ€
   - ä¼˜åŒ–çŠ¶æ€æ›´æ–°é€»è¾‘

3. **ç±»å‹å®šä¹‰ä¼˜åŒ–**
   - æ¶ˆé™¤é‡å¤ç±»å‹å®šä¹‰
   - æ·»åŠ ä¸¥æ ¼çš„ç±»å‹çº¦æŸ
   - å®Œå–„ç±»å‹æ–‡æ¡£

### é˜¶æ®µ3: æ•°æ®åº“ä¼˜åŒ– (ä¸‹å‘¨å†…)

1. **æ•°æ®åº“æ–¹æ¡ˆå‡çº§**
   - è€ƒè™‘ä½¿ç”¨ Prisma æ›¿ä»£ Sequelize
   - ä¼˜åŒ–æ•°æ®åº“æŸ¥è¯¢
   - æ·»åŠ æŸ¥è¯¢æ€§èƒ½ç›‘æ§

2. **ç¼“å­˜ç­–ç•¥ä¼˜åŒ–**
   - å……åˆ†åˆ©ç”¨Redisç¼“å­˜
   - å®ç°æ™ºèƒ½ç¼“å­˜ç­–ç•¥
   - æ·»åŠ ç¼“å­˜ç›‘æ§

## ğŸ› ï¸ å·¥å…·å’Œé…ç½®

### ESLinté…ç½®ä¼˜åŒ–

```json
{
  "extends": [
    "next/core-web-vitals",
    "@typescript-eslint/recommended",
    "prettier"
  ],
  "rules": {
    "@typescript-eslint/no-explicit-any": "error",
    "@typescript-eslint/no-unused-vars": "error",
    "@typescript-eslint/naming-convention": [
      "error",
      {
        "selector": "function",
        "format": ["camelCase"]
      },
      {
        "selector": "variable",
        "format": ["camelCase", "UPPER_CASE"]
      }
    ],
    "prefer-const": "error",
    "no-var": "error"
  }
}
```

### ä»£ç è´¨é‡æ£€æŸ¥è„šæœ¬

```json
{
  "scripts": {
    "lint": "eslint . --ext .ts,.tsx --fix",
    "type-check": "tsc --noEmit",
    "clean": "find . -name '*.ts' -o -name '*.tsx' | xargs grep -l 'import.*unused'",
    "analyze": "npm run lint && npm run type-check && npm run clean"
  }
}
```

## ğŸ“Š è´¨é‡æŒ‡æ ‡

### ä»£ç è´¨é‡æŒ‡æ ‡

- **æ–¹æ³•å‘½åè§„èŒƒç‡**: ç›®æ ‡ 100%
- **æ³¨é‡Šè¦†ç›–ç‡**: ç›®æ ‡ 90%
- **ç±»å‹å®‰å…¨ç‡**: ç›®æ ‡ 100%
- **é‡å¤ä»£ç ç‡**: ç›®æ ‡ < 2%

### æ€§èƒ½æŒ‡æ ‡

- **ç»„ä»¶æ¸²æŸ“æ—¶é—´**: ç›®æ ‡ < 100ms
- **æ•°æ®åº“æŸ¥è¯¢æ—¶é—´**: ç›®æ ‡ < 50ms
- **å†…å­˜ä½¿ç”¨ç‡**: ç›®æ ‡ < 80%
- **åŒ…ä½“ç§¯**: ç›®æ ‡ < 2MB

## ğŸ¯ å®æ–½è®¡åˆ’

### ç«‹å³æ‰§è¡Œ (ä»Šå¤©)

1. åˆ›å»ºä»£ç è§„èŒƒmdcæ–‡ä»¶
2. é…ç½®ESLintè§„åˆ™
3. å¼€å§‹æ¸…ç†æœªä½¿ç”¨çš„ä¾èµ–

### æœ¬å‘¨å®Œæˆ

1. å®Œæˆæ–¹æ³•å‘½åè§„èŒƒåŒ–
2. æ·»åŠ å®Œæ•´çš„æ³¨é‡Š
3. å®Œæˆç»„ä»¶æ‹†åˆ†

### ä¸‹å‘¨å®Œæˆ

1. å®Œæˆæ•°æ®åº“ä¼˜åŒ–
2. å®ŒæˆçŠ¶æ€ç®¡ç†ä¼˜åŒ–
3. å®Œæˆæ€§èƒ½ä¼˜åŒ–

---

## âš ï¸ é‡è¦æé†’

1. **ä¸¥æ ¼éµå¾ª**: æ‰€æœ‰ä¼˜åŒ–å¿…é¡»éµå¾ªæœ¬æ–¹æ¡ˆ
2. **é›¶é—æ¼**: ç¡®ä¿ä¸é—æ¼ä»»ä½•éœ€è¦ä¼˜åŒ–çš„ä»£ç 
3. **é«˜è´¨é‡**: ç¡®ä¿ä¼˜åŒ–åçš„ä»£ç è¾¾åˆ°é«˜è´¨é‡æ ‡å‡†
4. **ä¸€è‡´æ€§**: ç¡®ä¿å…¨å±€ä»£ç é£æ ¼ä¸€è‡´æ€§

**è®°ä½: å¥½çš„ä»£ç æ˜¯è®¾è®¡å‡ºæ¥çš„ï¼Œä¸æ˜¯æ”¹å‡ºæ¥çš„ã€‚ä»ä¼˜åŒ–é˜¶æ®µå°±è¦è€ƒè™‘è´¨é‡ã€æ€§èƒ½å’Œå¯ç»´æŠ¤æ€§ã€‚**
