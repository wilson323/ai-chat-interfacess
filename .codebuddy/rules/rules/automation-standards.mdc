---
alwaysApply: true
description: è‡ªåŠ¨åŒ–å·¥å…·å’Œæµç¨‹è§„èŒƒ
---

# è‡ªåŠ¨åŒ–å·¥å…·å’Œæµç¨‹è§„èŒƒ

## æ ¸å¿ƒè‡ªåŠ¨åŒ–åŸåˆ™
- æ¯ä¸ªé˜¶æ®µè½å®å¥½ä¸”ä¹Ÿæµ‹è¯•éªŒè¯åè¯·è‡ªåŠ¨æäº¤git
- ç¦æ­¢ä»£ç ç»„ä»¶åŠŸèƒ½ç­‰çš„å†—ä½™
- æ–°å¢å‰å…ˆå…¨å±€æ¢³ç†ç¡®ä¿ä¸å†—ä½™å†å»æ–°å¢
- å»ºç«‹å®Œæ•´çš„è‡ªåŠ¨åŒ–è´¨é‡æ£€æŸ¥æµç¨‹
- å®ç°æŒç»­é›†æˆå’ŒæŒç»­éƒ¨ç½²

## Gitè‡ªåŠ¨åŒ–æµç¨‹

### è‡ªåŠ¨æäº¤è§„èŒƒ
```bash
# âœ… æ­£ç¡®ï¼šé˜¶æ®µæ€§æäº¤
git add .
git commit -m "feat: å®ç°ç”¨æˆ·ç®¡ç†åŠŸèƒ½

- æ·»åŠ ç”¨æˆ·è¡¨å•ç»„ä»¶
- å®ç°ç”¨æˆ·CRUDæ“ä½œ
- æ·»åŠ ç”¨æˆ·æƒé™éªŒè¯
- å®Œæˆå•å…ƒæµ‹è¯•è¦†ç›–

æµ‹è¯•é€šè¿‡: âœ…
ç±»å‹æ£€æŸ¥: âœ…
ä»£ç è§„èŒƒ: âœ…"

git push origin feature/user-management
```

### æäº¤ä¿¡æ¯è§„èŒƒ
```bash
# æäº¤ç±»å‹
feat:     æ–°åŠŸèƒ½
fix:      ä¿®å¤é—®é¢˜
docs:     æ–‡æ¡£æ›´æ–°
style:    ä»£ç æ ¼å¼
refactor: é‡æ„ä»£ç 
test:     æµ‹è¯•ç›¸å…³
chore:    æ„å»ºè¿‡ç¨‹æˆ–è¾…åŠ©å·¥å…·çš„å˜åŠ¨

# æäº¤æ ¼å¼
<type>(<scope>): <subject>

<body>

<footer>
```

## ä»£ç è´¨é‡è‡ªåŠ¨åŒ–

### Pre-commité’©å­
```json
// package.json
{
  "husky": {
    "hooks": {
      "pre-commit": "lint-staged"
    }
  },
  "lint-staged": {
    "*.{ts,tsx}": [
      "eslint --fix",
      "prettier --write",
      "git add"
    ],
    "*.{json,md}": [
      "prettier --write",
      "git add"
    ]
  }
}
```

### è‡ªåŠ¨åŒ–æ£€æŸ¥è„šæœ¬
```bash
# âœ… æ­£ç¡®ï¼šè´¨é‡æ£€æŸ¥è„šæœ¬
#!/bin/bash
echo "ğŸ” å¼€å§‹ä»£ç è´¨é‡æ£€æŸ¥..."

# 1. ç±»å‹æ£€æŸ¥
echo "ğŸ“‹ è¿è¡ŒTypeScriptç±»å‹æ£€æŸ¥..."
npm run check-types
if [ $? -ne 0 ]; then
  echo "âŒ ç±»å‹æ£€æŸ¥å¤±è´¥"
  exit 1
fi

# 2. ä»£ç è§„èŒƒæ£€æŸ¥
echo "ğŸ“‹ è¿è¡ŒESLintæ£€æŸ¥..."
npm run lint
if [ $? -ne 0 ]; then
  echo "âŒ ä»£ç è§„èŒƒæ£€æŸ¥å¤±è´¥"
  exit 1
fi

# 3. æ ¼å¼åŒ–æ£€æŸ¥
echo "ğŸ“‹ è¿è¡ŒPrettieræ£€æŸ¥..."
npm run format:check
if [ $? -ne 0 ]; then
  echo "âŒ ä»£ç æ ¼å¼åŒ–æ£€æŸ¥å¤±è´¥"
  exit 1
fi

# 4. æµ‹è¯•è¿è¡Œ
echo "ğŸ“‹ è¿è¡Œæµ‹è¯•..."
npm run test
if [ $? -ne 0 ]; then
  echo "âŒ æµ‹è¯•å¤±è´¥"
  exit 1
fi

echo "âœ… æ‰€æœ‰æ£€æŸ¥é€šè¿‡"
```

## æ„å»ºè‡ªåŠ¨åŒ–

### æ„å»ºæµç¨‹
```bash
# âœ… æ­£ç¡®ï¼šæ„å»ºæµç¨‹
#!/bin/bash
echo "ğŸ—ï¸ å¼€å§‹æ„å»ºæµç¨‹..."

# 1. æ¸…ç†
echo "ğŸ§¹ æ¸…ç†æ„å»ºç›®å½•..."
rm -rf .next
rm -rf dist

# 2. å®‰è£…ä¾èµ–
echo "ğŸ“¦ å®‰è£…ä¾èµ–..."
npm ci

# 3. ç±»å‹æ£€æŸ¥
echo "ğŸ“‹ ç±»å‹æ£€æŸ¥..."
npm run check-types

# 4. ä»£ç è§„èŒƒæ£€æŸ¥
echo "ğŸ“‹ ä»£ç è§„èŒƒæ£€æŸ¥..."
npm run lint

# 5. æµ‹è¯•
echo "ğŸ§ª è¿è¡Œæµ‹è¯•..."
npm run test

# 6. æ„å»º
echo "ğŸ—ï¸ æ„å»ºåº”ç”¨..."
npm run build

# 7. éªŒè¯æ„å»ºç»“æœ
echo "âœ… éªŒè¯æ„å»ºç»“æœ..."
if [ -d ".next" ]; then
  echo "âœ… æ„å»ºæˆåŠŸ"
else
  echo "âŒ æ„å»ºå¤±è´¥"
  exit 1
fi
```

### éƒ¨ç½²è‡ªåŠ¨åŒ–
```bash
# âœ… æ­£ç¡®ï¼šéƒ¨ç½²æµç¨‹
#!/bin/bash
echo "ğŸš€ å¼€å§‹éƒ¨ç½²æµç¨‹..."

# 1. æ„å»º
echo "ğŸ—ï¸ æ„å»ºåº”ç”¨..."
npm run build

# 2. æµ‹è¯•æ„å»ºç»“æœ
echo "ğŸ§ª æµ‹è¯•æ„å»ºç»“æœ..."
npm run start &
SERVER_PID=$!
sleep 10

# 3. å¥åº·æ£€æŸ¥
echo "ğŸ¥ å¥åº·æ£€æŸ¥..."
curl -f http://localhost:3000/api/health
if [ $? -ne 0 ]; then
  echo "âŒ å¥åº·æ£€æŸ¥å¤±è´¥"
  kill $SERVER_PID
  exit 1
fi

# 4. åœæ­¢æµ‹è¯•æœåŠ¡å™¨
kill $SERVER_PID

# 5. éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ
echo "ğŸš€ éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ..."
# éƒ¨ç½²é€»è¾‘

echo "âœ… éƒ¨ç½²å®Œæˆ"
```

## æµ‹è¯•è‡ªåŠ¨åŒ–

### æµ‹è¯•æµç¨‹
```bash
# âœ… æ­£ç¡®ï¼šæµ‹è¯•æµç¨‹
#!/bin/bash
echo "ğŸ§ª å¼€å§‹æµ‹è¯•æµç¨‹..."

# 1. å•å…ƒæµ‹è¯•
echo "ğŸ“‹ è¿è¡Œå•å…ƒæµ‹è¯•..."
npm run test:unit
if [ $? -ne 0 ]; then
  echo "âŒ å•å…ƒæµ‹è¯•å¤±è´¥"
  exit 1
fi

# 2. é›†æˆæµ‹è¯•
echo "ğŸ“‹ è¿è¡Œé›†æˆæµ‹è¯•..."
npm run test:integration
if [ $? -ne 0 ]; then
  echo "âŒ é›†æˆæµ‹è¯•å¤±è´¥"
  exit 1
fi

# 3. E2Eæµ‹è¯•
echo "ğŸ“‹ è¿è¡ŒE2Eæµ‹è¯•..."
npm run test:e2e
if [ $? -ne 0 ]; then
  echo "âŒ E2Eæµ‹è¯•å¤±è´¥"
  exit 1
fi

# 4. è¦†ç›–ç‡æ£€æŸ¥
echo "ğŸ“Š æ£€æŸ¥æµ‹è¯•è¦†ç›–ç‡..."
npm run test:coverage
COVERAGE=$(npm run test:coverage:check)
if [ $COVERAGE -lt 80 ]; then
  echo "âŒ æµ‹è¯•è¦†ç›–ç‡ä¸è¶³: $COVERAGE%"
  exit 1
fi

echo "âœ… æ‰€æœ‰æµ‹è¯•é€šè¿‡"
```

## ä»£ç å®¡æŸ¥è‡ªåŠ¨åŒ–

### è‡ªåŠ¨ä»£ç å®¡æŸ¥
```bash
# âœ… æ­£ç¡®ï¼šä»£ç å®¡æŸ¥è„šæœ¬
#!/bin/bash
echo "ğŸ” å¼€å§‹ä»£ç å®¡æŸ¥..."

# 1. æ£€æŸ¥ä»£ç é‡å¤
echo "ğŸ“‹ æ£€æŸ¥ä»£ç é‡å¤..."
npx jscpd --min-lines 5 --min-tokens 50 src/
if [ $? -ne 0 ]; then
  echo "âŒ å‘ç°ä»£ç é‡å¤"
  exit 1
fi

# 2. æ£€æŸ¥ä»£ç å¤æ‚åº¦
echo "ğŸ“‹ æ£€æŸ¥ä»£ç å¤æ‚åº¦..."
npx complexity-report src/
if [ $? -ne 0 ]; then
  echo "âŒ ä»£ç å¤æ‚åº¦è¿‡é«˜"
  exit 1
fi

# 3. æ£€æŸ¥ä¾èµ–æ¼æ´
echo "ğŸ“‹ æ£€æŸ¥ä¾èµ–æ¼æ´..."
npm audit
if [ $? -ne 0 ]; then
  echo "âŒ å‘ç°ä¾èµ–æ¼æ´"
  exit 1
fi

echo "âœ… ä»£ç å®¡æŸ¥é€šè¿‡"
```

## ç›‘æ§è‡ªåŠ¨åŒ–

### æ€§èƒ½ç›‘æ§
```typescript
// âœ… æ­£ç¡®ï¼šæ€§èƒ½ç›‘æ§
export function PerformanceMonitor() {
  useEffect(() => {
    if (typeof window !== 'undefined') {
      // ç›‘æ§Core Web Vitals
      import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {
        getCLS((metric) => {
          console.log('CLS:', metric);
          // å‘é€åˆ°ç›‘æ§æœåŠ¡
        });

        getFID((metric) => {
          console.log('FID:', metric);
          // å‘é€åˆ°ç›‘æ§æœåŠ¡
        });
      });
    }
  }, []);

  return null;
}
```

### é”™è¯¯ç›‘æ§
```typescript
// âœ… æ­£ç¡®ï¼šé”™è¯¯ç›‘æ§
export function ErrorMonitor() {
  useEffect(() => {
    const handleError = (error: ErrorEvent) => {
      console.error('å…¨å±€é”™è¯¯:', error);
      // å‘é€åˆ°é”™è¯¯ç›‘æ§æœåŠ¡
    };

    window.addEventListener('error', handleError);
    return () => window.removeEventListener('error', handleError);
  }, []);

  return null;
}
```

## CI/CDé…ç½®

### GitHub Actions
```yaml
# âœ… æ­£ç¡®ï¼šGitHub Actionsé…ç½®
name: CI/CD Pipeline

on:
  push:
    branches: [main, develop]
  pull_request:
    branches: [main]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-node@v3
        with:
          node-version: '18'
          cache: 'npm'

      - run: npm ci
      - run: npm run check-types
      - run: npm run lint
      - run: npm run test
      - run: npm run build

  deploy:
    needs: test
    runs-on: ubuntu-latest
    if: github.ref == 'refs/heads/main'
    steps:
      - uses: actions/checkout@v3
      - run: npm ci
      - run: npm run build
      - run: npm run deploy
```

## è‡ªåŠ¨åŒ–æ£€æŸ¥æ¸…å•

### å¼€å‘é˜¶æ®µ
- [ ] Pre-commité’©å­é…ç½®
- [ ] ä»£ç è´¨é‡æ£€æŸ¥è„šæœ¬
- [ ] è‡ªåŠ¨æ ¼å¼åŒ–é…ç½®
- [ ] ç±»å‹æ£€æŸ¥è‡ªåŠ¨åŒ–
- [ ] æµ‹è¯•è¿è¡Œè‡ªåŠ¨åŒ–

### æ„å»ºé˜¶æ®µ
- [ ] æ„å»ºæµç¨‹è‡ªåŠ¨åŒ–
- [ ] æ„å»ºéªŒè¯è‡ªåŠ¨åŒ–
- [ ] éƒ¨ç½²æµç¨‹è‡ªåŠ¨åŒ–
- [ ] å›æ»šæœºåˆ¶é…ç½®
- [ ] ç¯å¢ƒå˜é‡ç®¡ç†

### ç›‘æ§é˜¶æ®µ
- [ ] æ€§èƒ½ç›‘æ§é…ç½®
- [ ] é”™è¯¯ç›‘æ§é…ç½®
- [ ] æ—¥å¿—æ”¶é›†é…ç½®
- [ ] å‘Šè­¦æœºåˆ¶é…ç½®
- [ ] å¥åº·æ£€æŸ¥é…ç½®

å‚è€ƒé…ç½®æ–‡ä»¶ï¼š[package.json](mdc:package.json), [jest.config.js](mdc:jest.config.js)
