try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="90afcc34-c00c-4a6b-8762-d4c7c6b1f42f",e._sentryDebugIdIdentifier="sentry-dbid-90afcc34-c00c-4a6b-8762-d4c7c6b1f42f")}catch(e){}("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{}).SENTRY_RELEASE={id:"ee8681250888aa891f2587e8576c9c5e77457690"};"use strict";(self.webpackChunk_shakkerai_web_pro=self.webpackChunk_shakkerai_web_pro||[]).push([["991"],{35607:function(){},18051:function(){},75569:function(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAE4AAABOCAYAAACOqiAdAAAACXBIWXMAACE4AAAhOAFFljFgAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAqFSURBVHgB7Vzra1RJFj/ptBqNOoNKEmMCeRiNUTEL7gZNcAisCBoniEL0g8ZkUTQ+UNhvCot+2H9AZBEVREQUFJ3VZdfXDkoWopNdTUxQNNnouokBXxM0UfPomvOrVLU33be77+3n7Yw/KG66cu+5Vb976tSpU48UiiOEECkMoX83NjZO6+rqKmpra/ttZ2dnaXd3d97r16+zBwYG0kdGRibintTU1MG0tLSBjIyM7pycnK65c+e2FBcX31u4cOF/ly5d2qfl4mqUnfRApXTFmpqapjc0NGwtLCy8N2HChI/4dyTJ5XINFhQUNEMmf4Bv1ftc+n1JCV2Bp0+fTqqrq9s5bdq0V8hWWuG9RpogR8uaOXPm/7ds2dKAd6sypFKyQBf29OnTGYsWLfoHjVbOw9rhoSgQRcE1cES/Z/78+bcuX76cayyTI6E17OzZs7OysrJakMX2aSRammU34WPhmpeX92+2pdmqjM4hUNmwVFzZYP9Ao4QNUwLIMkv4eDSqgX9T5U1NuA3kArhxra+v/54SrGGhkiawpqamylj2uEO/ODc3twlk6YI5OcEG4sq9eqOqQ/yarm6asGX8cygZCCN/7YMp8Vy7di0jLuQp0lzsXnyHn+yLDRGFX4FEJrfbLe3w9u3bK42+ZtShhS9btqyeyFkdQLiJm66sQ1lZWb2qo/T/ogZNWklJyR/VC5OueVJg8mRdVN0oapqnm6f6KuOKNF/yKioq6qNJnJvdjUrjC8Zj0nXbvHnzdxF3GBCAnkcJTnqbFippDwEeQyg/LyUYaeyfQZCHeyDP8PBw8gyYIwB7CsNDQ0PyTwMHfjDtRVTcbIRDNo38FX41pAFMGuuJO0U59iO2bB6Y3rBhQ5VTh0/xSKg7h6iqA9m7FDPSlHrCrnkY0fVtYgQuM8pumg+Y/S8YdN2Vb5eioi1f/m/yohFEEtBEnUwaCOEyyr+XLFlCJ0+epOfPn9OHDx/o8+fP8trR0UHHjh0jjgvK+5gML5GhgLrDtvOzl2lUCwMD2nb9+nXEroSTmylXSF43bdok+vv7RTAwAfLKRIq1a9fK57gDsPU+1csGVyIE/pw8cAdpqHhvb68khSd1hBXo+1gLvXKsvA9cZGZmtgYkTPlsuYkmJhRps2bNkgRw7yfCAXsI8jp16lTL5CFhKiCg1rFt+6cOOTuRNGhaJKRp6OdZmyw1W4wqOLp93chVitI2XFMCOXuJhu4x37x5Q9OnTycm0fs/5CPB8N+6dYsuXrxIPT09xHOwxDaQysvLYejl/41gzaNXr15RdnZ2wB7ZFzxjl8bzuoPe+VuoIKbVWLjjNA0JmrFv3z4/e6Z/nzt3TmpkoA7t6tWrY+43Pl9bWyus1BstcevWrQ3C1yHmOckXThzEazJ8K657S1Rche4Dko7r3r17xzyn5X369MlSOeDXqblh0tqWombBHUWYkbhVq1YJX8DInzhxYsyEdDAZuJ4/f960F16xYoVl9wurEbzE7d69u87JftudO3eEGZQmWNUYSY4voIFXrlyxXJadO3fWeZsrD+Z/cjJxfX19fhXmkYJtJx33X7p0yU8WdzpWn/cUFRU1kQYWrySKFCvJDJWVlbblgLjq6mo/WXBPrMpQi4XI1dzc/A2r6wRyKCZNmmSa/+LFC7ILtG6z5+De+LorgcAkp2F5muvhw4f55GCooKIfeARhecBuxIwZM/zy4OchWQXW9LmePHlSZvWBcAoaqQxU6OPHj375VVVVZBfQqnXr1vnlI5JiB48fP17qZm+41M5D+/fvp/fv34e8b+LEiXTz5k3iDzMmf/LkyXTw4EF69+6dNy89PZ1OnTpFz549M5XFZaTFixePIX3Pnj1SjlWvH/fhI2zbtk3eb5TV1tZGdsDl+Q2GJH8ni4YRXbod7Nixw08GRxpM7129enVAg86VHeO4AvgN5zeQ42tWdibb1I9jLbTVQ0vOuHttiRVxdXV1fjIyMjJM74WTG4g47iC8ZGloAtiVCjrcQj7KzRo75jmjPH2fVR4KCwtbXFioTA4G6jU4OEhnzpwZ0yRhrzBQ7+zslPZOqIG+EboZ8zicWltb5f3Ge9B0jxw5IvOEjdA6D9PSKSsr638UI43btWtXxBqn30vKn/MNKWkNevnypWhoaBAcvcBaYHlFYODt27emAU8txyjfagJnthbX4T1si8B4yHsxH2DX6AYCNAO+1oIFC+jRo0fEJHjnG7QGse2ko0ePmj4LzTN2BtA8yMvPz5dyIM825syZ00EWmY7GsCwcjSOD5ukBf7jBTP3c8uXLbUWAjQmcudLS0vrJIoTNKbZoA9oDF6e0tFRqjB1NQdm15nIzprt374anaYwpU6b0u7i99lASAZVtb2+XTY9n5GQeCAn2UYXy2y5cuCCv8BchJ1xF4FbT45o9e/YzSjLARsE2wd7y16fDhw9LMnyJADnIP3DggHSyN27cGL5NM4DD7V1u9uMeUBJCVx4dFYg7dOiQ/I2RCUcwJLnsask842x+pKQB7Mc9cJeUlPxESQxfLcO41ndsG23bzLOB91zcJT+lr7AFDrV3uSoqKt6zaod2zL5Cgl2iIW6qfdJ7zMvLaxlXez1jBNhK5kr2CXLjGjuVx0Qy7/GMI7gn/4uXqxs3bnxDEY4IrKZIRg5OSJhKBXGyqa5cubKPJ1tfq8HuV5gA3HDwoJs7059lqAqZYHD9+vV/+tpcg2PNmjV/HsORUFvAKYFNtayszLIMuwsDo5WEYb+/DCupHvUzljLxRMTv2buO6xJWjDVv374tvf1QwNAJo4NAs1+xAPiZN2/ej77rgCXAJhbPUYI0zg44ohN3bcOiSxFsOStHS1pjuTMw2YjDUlb23f5DwSC+bODFQzFZmZlMxOnALRaUi1D7u8TooQR/jdUCatZoWXmsSwsnxZM4cKAPQfCF2QYRl2LbE4sNItGIhyFsFOvOAfs8VCcpt9L7LvM12yCCJuqqr6+vFtHeMUwUlXhYPHpUKExNTc1aEWQjnB+E8lWwEUzvXf81JXSOhpMiTAcFVrZdDqmmkZhzOuIMVpQR9ifR0lzC7rZLQG05dHMvOxukqYXV4xroDLDFlH22LFtN1AwQoI/LGM9by/WOSXWcRnRaFzqJ8vLyP4xX8vRuIhzYIKJ5/pwWNB6Pz9CkoW4iFge3aNfEcIxG0ve2emiJ1qRIi01wQwuHHcBPbPyPpOCJTPp4I9jvqDbPYBBfjtXwJONRQXA5+Dqkj8kQ8Qzg6kFvQUHBv/AzGeweyoiBe05OTpOqQ2LPkFOH2Tn2DDnj+Xa1tbXfq7In9kgQZfdkIVQkAYV0zGZhTRj3mj8Iw7GU5BRo8hC7wr5+oi9dfbyTUcM4jPVQ2bKUhGtZMOjCIdTMGvgjjdoWTzxsIN6jPxbHFK8dP348U5UpKc5OkdAECrX7GhuJicjS/lKrScnxaHnYiItdzJixi6lfFg8YK3D//v1vcbw2jtmOxo5F7OQrKiq6B5l6A25MvH8TxNVICp/D3LFzsb29vYCnJH/X0dGxpKenJ7+3t3cOh8incMBTzvPikHieDhzIzMzsxkpInqZ7UFxc3IzlaVhpZZQdz4VDvwB+fcuDgFf7kgAAAABJRU5ErkJggg=="},66666:function(e,t,i){i.d(t,{Z:()=>r});var n=i(97458);i(52983);let r=e=>(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:14,height:14,fill:"none",viewBox:"0 0 14 14",...e,children:(0,n.jsx)("path",{fill:"#4A535F",d:"M11.296 1.963a.4.4 0 0 1 .565 0l.178.177a.4.4 0 0 1 0 .565L7.743 7.001l4.296 4.295a.4.4 0 0 1 0 .566l-.178.177a.4.4 0 0 1-.566 0L7 7.744 2.705 12.04a.4.4 0 0 1-.566 0l-.177-.177a.4.4 0 0 1 0-.566L6.257 7 1.962 2.705a.4.4 0 0 1 0-.565l.177-.177a.4.4 0 0 1 .566 0L7 6.258z"})})},77455:function(e,t,i){i.d(t,{Z:()=>r});var n=i(97458);i(52983);let r=e=>(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:12,height:12,fill:"none",viewBox:"0 0 12 12",...e,children:(0,n.jsx)("path",{fill:"#2D2D2D",fillRule:"evenodd",d:"M2.5 4.707 3.207 4l2.647 2.646L8.5 4l.707.707-3.353 3.354z",clipRule:"evenodd"})})},70777:function(e,t,i){i.d(t,{Z:()=>r});var n=i(97458);i(52983);let r=e=>(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:30,height:18,fill:"none",viewBox:"0 0 30 18",...e,children:[(0,n.jsxs)("g",{fill:"#000",clipPath:"url(#logo_svg__a)",children:[(0,n.jsx)("path",{d:"M13.448 14.4H9.865V18h3.583zM13.448 0H9.865v3.6h3.583zM9.865 3.6h-4.48v3.6h4.48zM5.386 10.8V7.2H0v3.6zv3.6h4.479v-3.6z"}),(0,n.jsx)("path",{d:"m23.087 4.968-.146-.126C21.496 3.563 20.614 1.864 20.614 0h-4.479v3.6h-2.687v3.6H9.865v3.6h3.583v3.6h2.687V18h4.48c0-1.863.88-3.562 2.326-4.841q.072-.064.146-.126c1.632-1.375 3.933-2.233 6.484-2.233V7.2c-2.55 0-4.852-.856-6.484-2.232"})]}),(0,n.jsx)("defs",{children:(0,n.jsx)("clipPath",{id:"logo_svg__a",children:(0,n.jsx)("path",{fill:"#fff",d:"M0 0h29.571v18H0z"})})})]})},44768:function(e,t,i){i.d(t,{H8:()=>l,ZP:()=>c,iI:()=>d});var n=i(97458),r=i(52983);let o={isLovart:!0,handlePreviewFile:()=>{},handleDragFiles:()=>{},useInputParamSelectHandler:()=>({selectedMap:{},handleSelect:()=>{}}),handleResumeReplay:()=>{}},a={...o};function l(){return a}let s=(0,r.createContext)(o);function d(){return(0,r.useContext)(s)}let c=(0,r.memo)(function(e){let{children:t,config:i={}}=e,l=(0,r.useMemo)(()=>({...o,...i}),[i]);return Object.assign(a,l),(0,n.jsx)(s.Provider,{value:l,children:t})})},19042:function(e,t,i){i.d(t,{V:()=>l});var n=i(39378),r=i(12634),o=i.n(r),a=i(20941);function l(e,t){if(!Array.isArray(e))return{sessions:[],replayControl:{length:0,replaySnapshotIndexes:[],contents:[]}};let i=[],r=o()(),l=null,s=[],d=null,c=[],u=[];for(let h of e??[]){let{id:e,type:f,text:g,name:m,content:p,action_id:y,tool_call_id:v}=h,w={threadId:t,actionId:null==y?void 0:y.toString(),toolCallId:v};if("user"===f)l&&(i.push({id:r,input:l,messages:s}),r=o()(),l=null,s=[]),l=function e(t){try{if((0,n.isArray)(t))return t.map(t=>e(t));if((0,n.isObject)(t))return(0,n.transform)(t,(t,i,r)=>{t[(0,n.camelCase)(r)]=e(i)},{});return t}catch(e){return null==e||e.message,null}}(h),d&&((0,a.S3)(d,l),d=null);else if("assistant"===f)s.push({...h,id:e,type:"text",text:g,...w});else if("tool_use"===f){s.push({...h,id:e,type:f,name:m,content:p,...w}),p&&u.push({groupId:`${t}-${r}`,content:p});let i=null==s?void 0:s[(null==s?void 0:s.length)-1];!d&&i&&(0,a.bB)(i)&&(d=i)}c.push({sessionIndex:null==i?void 0:i.length,messageIndex:null==s?void 0:s.length,contentIndex:null==u?void 0:u.length})}return l&&i.push({id:r,input:l,messages:s}),{sessions:i,replayControl:{length:null==e?void 0:e.length,replaySnapshotIndexes:c,contents:u}}}},4569:function(e,t,i){i.d(t,{Kd:()=>l});let n={...{comma:",",questionMark:"?",language:"Language",whatAreWeCreatingToday:"What are we creating today",UploadImage:"Upload Image",WebSearch:"Web Search",dailyCreditsRefreshed:"{total} daily credits refreshed",Usetheprompt:"Use the prompt",Usetheimage:"Use the image",Shareyouruniqueinvitelink:'Invite friends and you\'ll both earn <span style="position:relative;margin-left:4px"><strong>{total} credits each</strong><span style="position:absolute;bottom:0;left:0;z-index:-1;height:7px;width:100%;background:#c4ff8c"></span></span>, plus you\'ll get <span style="position:relative;margin-left:4px"><strong>{plus} extra</strong><span style="position:absolute;bottom:0;left:0;z-index:-1;height:7px;width:100%;background:#c4ff8c"></span></span> when they subscribe!',ShareyouruniqueinvitelinkLimit:"Max {total} invites per user, up to {credits} credits. No refunds for subscriptions with referral rewards.",Invitees:"Invitees",Credits:"Credits",ExpireAfter:"Expire after {date}",NonExpiringCredits:"Non-Expiring Credits",FreeDailyCredits:"Free Daily Credits",FreeCreditsRenewsDaily:"Free {num} credits renews daily",Time:"Time",Nodata:"No data",NodMoreDta:"No more data",LoadingMore:"Loading more...",ClickToLoadMore:"Click to load more",ManageAccount:"Manage Account",Usage:"Usage",Billing:"Billing",Editprofile:"Edit profile",AccountInfo:"Account Info",CurrentPlan:"Current Plan:",ExpirationDate:"Expiration Date:",Upgrade:"Upgrade",AvailableCredits:"Available Credits:",Neverexpires:"Permanent credits:",Monthlycredits:"Monthly credits:",Dailyrefreshcredits:"Daily refresh credits:",DeleteAccount:"Delete Account",DeleteYourAccount:"Delete Your Account",Recharge:"Recharge",sorrytoseeyougo:"We’re sorry to see you go.",sorrytoseeyougoDesc:`For your account security, please send an email with the subject \u{201C}Delete Account\u{201D} from your Lovart account email to:<a href="mailto:support@lovart.ai" class="text-[#c4ff8c] underline ml-1">support@lovart.ai</a>`,wewillassist:"We'll assist you with the process.",CreditsDetail:"Detail",Date:"Date",Creditschange:"Credits change",Type:"Type",CreditsAmount:"Amount",Status:"Status",RechargeCredits:"Recharge Credits",creditsPer:"100 credits per $1",Custom:"Custom",Customize:"Customize",UpgradeYourPlan:"Upgrade your plan",FrequentlyAskedQuestions:"Frequently Asked Questions",FreeUsersEnjoy:"Free users can enjoy {num} credits every day",Publish:"Publish",Like:"Like",UserName:"User Name",Pleaseenteryourusername:"Please enter your username",LengthLimit:'Length 1-40 characters, supports letters, numbers, "-"',AboutYou:"About",Tellyourstory:"Tell your story",Usernameisrequired:"Username is required",userNameTooLong:"Username must be between 1-40 characters",userNameInlaid:"Username can only contain letters, numbers, Chinese characters and hyphens",Purchase:"Purchase",AddCredits:"Add Credits to continue",ThisGenerationRequires:"This generation requires more credits than your current balance.",YourBalance:'Your balance: <span class="text-[#c4ff8c]">{num} credits</span>',OnetimeRefill:"One-time Refill",PleaseEnterNumber:"Please enter a number from {min} to {max} in multiples of 10.",Share:"Share",SelectPaymentMethod:"Select Payment Method",UsageDetail:"Usage details",ExploreUseCases:"Explore use cases",Free:"Free",Preview:"Preview",droptochat:"Drop files here to add to chat"},app:{tryLovartOnDesktop:"Try Lovart on desktop!",desc:"Great work so far! While mobile is perfect for on-the-go edits, Lovart desktop unlocks finetuned controls and precision editing.",info1:'Try desktop and earn <span style="position:relative;margin-left:4px">300 free credits<span style="position:absolute;bottom:0;left:0;z-index:-1;height:4px;width:100%;background:#c4ff8c"></span></span>',info2:"Fine tuned controls and precision editing",info3:"Infinite canvas",WeEmailLink:"We'll Email The Link To Your Account",EmailMeTheDesktopLink:"Email me the link"},brand:{lovartersCreateTitle:"See what lovarters create",lovartersCreateDesc:"Discover inspiring projects, artwork, and designs made by our vibrant community."},dashboard:{myCollections:"Recent Projects",lastRefinedOn:"Last refined on ",createProject:"New Project",TimeToStart:"Time to start",communityHighlights:"Created by Lovarters",confirmDeleteCollection:"Confirm Delete your work ?",confirmDeletePost:"Delete this post? This post cannot be recovered after deletion.",placeholder:"Start with a creative idea or task",Projects:"Projects",TermOfUse:"Term of Use",PrivacyPolicy:"Privacy Policy",TermOfUseLink:"https://www.lovart.ai/statement/terms-of-use",PrivacyPolicyLink:"https://www.lovart.ai/statement/privacy-policy",linkedinLink:"https://www.linkedin.com/company/lovart-ai/",discordLink:"https://discord.gg/lovart",XLink:"https://x.com/lovart_ai",instagramLink:"https://www.instagram.com/lovart_ai/",tiktokLink:"https://www.tiktok.com/@lovart_ai",youtubeLink:"https://www.youtube.com/@lovart_ai"},home:{feature:{idea:{title:"Just give the idea.",desc:"Lovart plans, explores, and creates like a real designer — calling the right tools, mapping out directions, and bringing your creative vision to life.",video:"https://assets-persist.lovart.ai/web/model/fe3c6dd31ea341ed83710ba3c561c2ac/36456f0bf50fbe63ebcd9a5ffb59e8e38abae9a00811e62f25255178e14fc95c.mp4",poster:"https://assets-persist.lovart.ai/web/model/fe3c6dd31ea341ed83710ba3c561c2ac/23a4ac21d85662b51f7b00f1a92f5adb947ddfc2877cd6795c932811b36ec645.png"},create:{title:"Co-create with Lovart — one canvas, shared intelligence.",desc:"On ChatCanvas, your ideas speak — and design sees, understands and responds. Mark what matters, leave a note, sketch a frame. Lovart reads your intent — and designs in dialogue with you.",video:"https://assets-persist.lovart.ai/web/model/fe3c6dd31ea341ed83710ba3c561c2ac/4b3a986a72722891ea479f07a05031cf6b7b9fc7038db80b55eb076fa6663f12.mp4",poster:"https://assets-persist.lovart.ai/web/model/fe3c6dd31ea341ed83710ba3c561c2ac/bdd5ba622f9dafae0534f7e8786fe787d9c3d63ee7a59bcca724dcb322213778.png"},all:{title:"All formats in one place.",desc:"You imagine it — Lovart brings it to life in image, video, audio, even 3D. Every format you need, ready in an instant.",video:"https://assets-persist.lovart.ai/web/model/fe3c6dd31ea341ed83710ba3c561c2ac/8e83763953d9c9a94d612c52fc7fd95b122ec11cea963cf6f9cbddd66ea0e239.mp4",poster:"https://assets-persist.lovart.ai/web/model/fe3c6dd31ea341ed83710ba3c561c2ac/4a00b7f5025ca85f79eaa0a384000f1dd7b38b52445b892ee97592f409f48627.png"}},communityVoices:"Love from the community",communityVoicesDesc:"See what the community is saying about Lovart",letsMakeSomethingAmazing:"Design smarter.<br>Design faster.",letsMakeSomethingAmazingDesc:"Experience the world’s first AI design agent—no wait, no limits. Sign up and bring your ideas to life today.",whyLovart:"WHY LOVART",whyLovartDesc:"Lovart automates the entire design journey, from concept to images, videos, 3D, and more.",examples:{simple:"Hello World",interpolation:"Hello {name}, you have {count} messages",plurals:{item:{zero:"No items",one:"1 item",other:"{count} items"},message:{zero:"No messages",one:"You have 1 message",other:"You have {count} messages"}}}},case:{viewReplay:"View Replay",tryItNow:"Try it now"},Languages:"Languages",tdk:{home:{title:"Lovart | The World's First Design Agent",description:"Transform prompts into masterpieces with Lovart, the revolutionary AI design agent. From storyboards to brand visuals, our auto-design technology crafts compelling creative stories for designers. Try Lovart.ai today!",keywords:"AI design agent, Auto-design agent, AI design tools, Lovart"},blog:{title:"AI Design Trends, Tutorials & Creative Inspiration",desc:"Stay updated with the latest AI design trends, tutorials, and creative inspiration on the Lovart blog.",keywords:"AI design blog"},start:{poster:{title:"Create Amazing Posters with AI | Lovart",description:"Design stunning posters with Lovart AI. From event flyers to promotional materials, create professional posters in minutes.",keywords:"AI poster maker, poster design, AI graphics, Lovart poster"}}},styles:{applyButton:"Apply Now"},changelog:{title:"What's New",desc:"Every update is designed to help you achieve more."},event:{title:"Upcoming Event",desc:""},gallery:{title:"Discover Community Creations",desc:"See what amazing posters, artworks, designs, and videos others are creating with Lovart."},features:{title:"Lovart's Features",subTitle:"TOOLS & RESOURCES",desc:"Discover how Lovart empower you to bring bold ideas to life."},usecase:{title:"Lovart's Use Cases",subTitle:"TOOLS & RESOURCES",desc:"See how creators and teams use Lovart to turn imagination into action."},tools:{title:"Lovart's Tools",subTitle:"TOOLS & RESOURCES",desc:"Discover tools that help you use Lovart to bring bold ideas to life."},news:{title:"Lovart Newsroom",subTitle:"PRESS & MEDIA RESOURCES",desc:"Find the latest news, download media assets, and more."},blog:{title:"Lovart's Blog",subTitle:"INSIGHTS & STORIES",desc:"Explore fresh perspectives, creative journeys, and behind-the-scenes at Lovart.",category:{101:{title:"Guides"},102:{title:"News"},103:{title:"Tips"},104:{title:"User Story"},105:{title:"Best"}},viewAll:"View All",readMore:"Read More",contents:"Contents",shareArticle:"Share Article",copyArticleLinkSuccess:"Copy Article Link Success",popularPosts:"POPULAR POSTS",testimonial:{quote:"We are building a future where designers and AI create side by side, united on the same canvas.",author:"Elena Leung",title:"Co-founder and COO"}},nav:{home:"Home",collection:"Projects",solution:"Solution",profile:"Profile",inspiration:"Inspiration",create:"Create",tools:"Tools",blog:"Blog",news:"News",discovery:"Discovery",community:"Community",pricing:"Pricing",styles:"Styles",useCases:"Use Cases",features:"Features",testimonials:"Testimonials",challenges:"Challenges",gallery:"Gallery",communityGallery:"Inspiration",Product:"Product",Resources:"Resources",About:"About",HelpCenter:"Help Center",company:"Company",contactUs:"Contact Us",communityVoices:"Community Voices",changelog:"Release Notes"},notFound:{pageNotFound:"404: Page not found!",description:"We’ve looked everywhere but couldn’t find the page you were looking for.",backToHome:"Back to Home"},ui:{loading:"Loading...",noMore:"No more content for now",images:"Images"},greeting:{goodNight:"Good Night",goodMorning:"Good Morning",goodAfternoon:"Good Afternoon",goodEvening:"Good Evening",greetingDesc:"Ready to turn your ideas into art?"},tryNow:"Try Now",Next:"Next",Prev:"Prev",Bycontinuing:"By continuing you agree to the",Termsof:"Terms of Use",PrivacyPolicy:"Privacy Policy",and:"and",WelcomeToLovart:"Welcome to Lovart",login:"Log in",singUp:"Sign up",signout:"Sign out",signup:"Log in or Sign up to Continue",OR:"OR",withGoogle:"with Google",withApple:"with Apple",Email:"Email",ContinueWithEmail:"Continue with Email",InvalidEmail:"Invalid Email",CheckYourEmailOnComputer:"Check your email to continue",WeHaveSentALoginLinkToYourEmailAddress:"We've sent a temporary login link to your email. Please check your inbox at",DidntReceiveLink:"Didn't receive your link? Resend",WeHaveSentALoginCodeToYourEmailAddress:"We've sent a one-time password to your email. Please check your inbox at",DidntReceiveCode:"Didn't receive your code? Resend",EmailResentSuccessfully:"Email resent successfully",ResendAvailableIn:"Resend in {seconds}s",MaximumAttemptsReached:"Maximum attempts reached, please request a new code.",DailyLimitReached:"Daily limit reached. Try again tomorrow.",TooManyRequests:"Too many requests. Please try again later.",IncorrectVerificationCode:"Incorrect verification code.",logoutConfirm:"Are you sure you want to sign out?",logout:"Log Out",iHaveACode:"I have a code",Confirm:"Confirm",Cancel:"Cancel",save:"Save",ConfirmFailed:"Confirm failed",Replay:"Replay",Success:"Success!",OK:"Okay!",joinDiscord:"Join Discord",readMore:"Read More",aboutus:"About Us",applyNow:"Apply Now",tryLovartNow:"Try Lovart Now",designNow:"Design Now",pause:"Pause",play:"Play",seeAll:"See All",view:"View",submit:"Submit",profile:"Edit Profile",ManageAccount:"Manage account",submitErrorMessage:"Your submission failed due to some issues. Please try again.",copyMyShareLink:"Copy my share link",copyMyShareLinkSuccess:"Copy my share link success",startDesigningWithLovartToday:"Start Designing with Lovart today",createJawDroppingDesignsByTalkingWithAI:"Create jaw dropping designs by talking with AI.",learnMore:"Learn more",startForFree:"Start for free",NEW:"NEW",questionAnswered:"Your Questions, answered",PRICING:"Flexible plans for every need",StartCreating:"Start Creating",pricing:{comparison:{title:"Not sure which plan is right for you?",tiers:{starter:{name:"Starter",description:"are perfect for individuals",perfectFor:"Perfect for",perfectForItems:["Working mostly on images","Individuals or part of a small team","Making moderate designs"],keyFeatures:"Key Features",keyFeaturesItems:["Full Agent Abilities","Unlimited project","Access all the most powerful models"]},basic:{name:"Basic",description:"are perfect for video creators and brands",perfectFor:"Perfect for",perfectForItems:["Working on images and videos","Brand and small business","Making more designs"],keyFeatures:"Key Features",keyFeaturesItems:["Full Agent Abilities","Higher credit limit","Perfect for creating video and images"]},pro:{name:"Pro",description:"are designed for teams and agencies",perfectFor:"Perfect for",perfectForItems:["Working on images and videos","Business and agency","Cheapest credits"],keyFeatures:"Key Features",keyFeaturesItems:["Full Agent Abilities","Highest credit limit","Best price on credit refills"]}}}},copied:"Copied",invitationCodeInfo:{INVITATION_CODE:"Invite Friends",tutorials:"User Guide",myLink:"My Link",shareWithFriends:"Referral Statistics"},getCredits:{newMemberSpecial:"New Member Special!",subscribeToday:"Subscribe today and get 2x credits!",starterGets:"Starter gets",basicGets:"Basic gets",proGets:"Pro gets",credits:"credits",not:"not",subscribeNowToReceive:"Subscribe now to receive",doubleCredits:"2x",creditsForFirstMonth:"credits for your first month",subscribeNow:"Get Extra Credit",dontWantCredits:"I don't want free credits",extra:"Extra"},BilledAnnually:"Billed annually"},r={en:()=>Promise.resolve(n),de:()=>i.e("871").then(i.bind(i,63454)).then(e=>e.default),ru:()=>i.e("869").then(i.bind(i,14049)).then(e=>e.default),fr:()=>i.e("398").then(i.bind(i,25116)).then(e=>e.default),ko:()=>i.e("994").then(i.bind(i,50886)).then(e=>e.default),pt:()=>i.e("229").then(i.bind(i,81628)).then(e=>e.default),ja:()=>i.e("27").then(i.bind(i,91346)).then(e=>e.default),it:()=>i.e("396").then(i.bind(i,30440)).then(e=>e.default),zh:()=>i.e("32").then(i.bind(i,16997)).then(e=>e.default),"zh-TW":()=>i.e("455").then(i.bind(i,33284)).then(e=>e.default)},o=new Map;async function a(e){if(o.has(e))return o.get(e);if("en"===e)return o.set(e,n),n;try{let t=r[e];if(!t)return o.set(e,n),n;let i=await t(),a=function e(t,i){let n={};return Object.keys(i).forEach(e=>{n[e]=i[e]}),Object.keys(t).forEach(i=>{let r=t[i],o=n[i];!r||!o||"object"!=typeof r||"object"!=typeof o||Array.isArray(r)||r instanceof Function?n[i]=r:n[i]=e(r,o)}),n}(i,n);return o.set(e,a),a}catch(t){return o.set(e,n),n}}function l(e){return o.has(e)?o.get(e):"en"===e||"undefined"==typeof window?(o.set(e,n),n):(a(e).catch(console.warn),o.has("en"))?o.get("en"):(o.set("en",n),n)}},75746:function(e,t,i){i.d(t,{Qz:()=>a});var n,r=i(4569);let o={lang:"en",keySeparator:".",nsSeparator:":",fallbackLang:["en"]};function a(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i={...o,...t};return function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{namespace:r,key:o}=function(e,t){if(e.includes(t)){let[i,n]=e.split(t,2);return{namespace:i,key:n}}return{key:e}}(t,i.nsSeparator),a=e;r&&e[r]&&(a=e[r]);let l=function(e,t,i){if(!t)return e;let n=t.split(i),r=e;for(let e of n){if(null==r||"object"!=typeof r)return;r=r[e]}return r}(a,o,i.keySeparator);return null==l?t:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"en";return e.replace(/\{(\w+)\}/g,(e,n)=>{let r=t[n];if(void 0===r)return e;if("number"==typeof r&&t.formatNumber)try{return new Intl.NumberFormat(i).format(r)}catch{return String(r)}if("number"==typeof r&&t.currency){var o=t.currency;try{return new Intl.NumberFormat(i,{style:"currency",currency:o.toUpperCase()}).format(r)}catch{return`${o} ${r}`}}if(r instanceof Date&&t.formatDate){var a=t.formatDate;try{let e={};return"short"===a?e.dateStyle="short":"medium"===a?e.dateStyle="medium":"long"===a?e.dateStyle="long":"full"===a&&(e.dateStyle="full"),new Intl.DateTimeFormat(i,e).format(r)}catch{return r.toLocaleDateString()}}return r instanceof Date&&t.relativeTime?function(e,t){try{let i=new Intl.RelativeTimeFormat(t,{numeric:"auto"}),n=new Date,r=e.getTime()-n.getTime(),o=Math.round(r/6e4),a=Math.round(r/36e5),l=Math.round(r/864e5);if(60>Math.abs(o))return i.format(o,"minute");if(24>Math.abs(a))return i.format(a,"hour");return i.format(l,"day")}catch{return String(e)}}(r,i):String(r)})}(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0,n=t.count;if("object"==typeof(e=function(e,t){if("object"==typeof e&&null!==e&&t){if(t in e)return e[t];if("default"in e)return e.default}return e}(e,t.context))&&null!==e&&"number"==typeof n){let t=function(e,t){let i=Math.abs(e);switch(t){case"ru":if(i%10==1&&i%100!=11)return"one";if([2,3,4].includes(i%10)&&![12,13,14].includes(i%100))return"few";return"many";case"zh":case"zh-TW":case"ja":case"ko":return"other";case"fr":if(0===i||1===i)return"one";return"other";default:if(0===e)return"zero";if(1===e)return"one";if(2===e)return"two";return"other"}}(n,i);if(t in e)return e[t];if(0===n&&"zero"in e)return e.zero;if(1===n&&"one"in e)return e.one;if(2===n&&("two"in e||"dual"in e))return e.two||e.dual;else if("other"in e)return e.other;return Object.values(e)[0]}return"string"==typeof e?e:String(e||"")}(l,n,i.lang),n,i.lang)}}n=r.Kd},36981:function(e,t,i){i.d(t,{o:()=>l});var n=i(52983);let r="loading",o="loadStateSuccess",a="loadStateFailed",l=()=>{let[e,t]=(0,n.useState)("init"),[i,l]=(0,n.useState)(),s=(0,n.useMemo)(()=>e===r,[e]),d=(0,n.useMemo)(()=>e===o,[e]),c=(0,n.useMemo)(()=>e===a,[e]),u=(0,n.useCallback)(()=>{t(r),l("")},[]);return{isLoading:s,isLoadSuccess:d,isLoadFailed:c,errorMsg:i,setLoadingState:u,setSuccessState:(0,n.useCallback)(()=>{t(o)},[]),setFailState:(0,n.useCallback)(e=>{t(a),l(e)},[])}}},39679:function(e,t,i){i.d(t,{c:()=>a});var n=i(52983),r=i(2587),o=i(36981);let a=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],[i,a]=(0,n.useState)(),{setLoadingState:l,setSuccessState:s,setFailState:d,...c}=(0,o.o)(),u=(0,n.useCallback)(async()=>{l();let t=await (0,r.GU)(e);if(t.data)try{let e=JSON.parse(t.data.linkUrl);a(e),s()}catch(e){t.data.linkUrl,d(null==e?void 0:e.message)}else d()},[e]);return(0,n.useEffect)(()=>{t&&u()},[t]),{...c,loadRemoteConfig:u,remoteConfig:i}}},41931:function(e,t,i){i.d(t,{u:()=>y});var n=i(97458),r=i(52983),o=i(66085),a=i(60731),l=i(66231),s=i(34158),d=i(36981),c=i(75790),u=i(28377);let h=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2?arguments[2]:void 0,n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=new URLSearchParams(window.location.search),a=r.get("bd_vid"),l=r.get("track_id"),d=r.get("qhclickid"),c=r.get("msclkid"),u=r.get("cb"),h="";a&&(h=`&bd_vid=${a}`),l&&(h=`&track_id=${l}`),d&&(h=`&qhclickid=${d}`),c&&(h=`&msclkid=${c}`),u&&(h=`&cb=${u}`);let f=`&xl_cid=${(0,s.ey)()}`,g=r.get("configId"),m=g?`&configId=${g}`:"",p="";if(t){let e=r.get("code")||(null==i?void 0:i.code),t=(null==i?void 0:i.title)||"",n=r.get("third")||"",o=r.get("isNewUser");p=`&code=${e}&third=${n}&isNewUser=${o}&title=${t}&bindPhone=1`}return e?"http://localhost:3001/login":"test"===o.config.name?`https://www-test.liblib.art/login?platform=xingliu${f}${h}${m}${p}${n?"&needInviteCode=1":""}`:"pre"===o.config.name?`https://www-pre.liblib.art/login?platform=xingliu${f}${h}${m}${p}${n?"&needInviteCode=1":""}`:"online"===o.config.name?`https://www.liblib.art/login?platform=xingliu${f}${h}${m}${p}${n?"&needInviteCode=1":""}`:void 0},f=e=>{let{onClose:t,visible:i,bindPhone:o,bindPhoneData:a,needInvitedCode:l}=e,{isLoading:s,setLoadingState:f,setSuccessState:g,setFailState:m}=(0,d.o)(),p=(0,r.useRef)(null);(0,r.useEffect)(()=>{if(!i)return()=>{};{f(),p.current&&clearTimeout(p.current),p.current=setTimeout(()=>{null==t||t(),(0,u.cB)("资源未能成功加载"),m("")},15e3);let e=async e=>{try{if(!e.data)return;let i="object"==typeof e.data?e.data:JSON.parse(e.data);"onLoginClose"===i.type?null==t||t():"onLoginPageLoadFinish"===i.type&&(g(),p.current&&clearTimeout(p.current))}catch(e){console.error("LibLogin messageListener error",e)}};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}}},[i,t,f,g,m]);let y=(0,r.useMemo)(()=>h(!1,o,a,l),[o,a,l]);return i?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(c.f,{visible:s,zIndex:1e3,overlayProps:{color:"#000000"}}),(0,n.jsx)("iframe",{src:y,style:{width:"100%",height:"100%",background:"transparent"}})]}):null};var g=i(73234);let m=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=`platform=canvas${t?"&needInviteCode=1":""}${i?"&hideClose=1":""}`;if(e)return`http://localhost:3010/login?${n}`;if("test"===o.config.name)return`https://www-test.lovart.ai/login?${n}`;if("pre"===o.config.name)return`https://www-pre.lovart.ai/login?${n}`;if("online"===o.config.name)return`https://www.lovart.ai/login?${n}`;if("insight"===o.config.name)return`https://insight.lovart.ai/login?${n}`},p=e=>{let{onClose:t,visible:i,redirectUrl:o,needInvitedCode:a,hideClose:l}=e,{isLoading:s,setLoadingState:h,setSuccessState:f,setFailState:p}=(0,d.o)(),y=(0,r.useRef)(null);(0,r.useEffect)(()=>{if(!i)return()=>{};{h(),y.current&&clearTimeout(y.current),y.current=setTimeout(()=>{null==t||t(),(0,u.cB)("资源未能成功加载"),p("")},3e4);let e=async e=>{try{if(!e.data)return;let i="object"==typeof e.data?e.data:JSON.parse(e.data);"onLoginClose"===i.type?null==t||t():"onLoginPageLoadFinish"===i.type&&(f(),y.current&&clearTimeout(y.current),o&&(window.location.href=o))}catch(e){console.error(e)}};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}}},[i,t,h,f,p,o]);let v=m(!1,a,l);return i?(0,n.jsxs)(g.M,{children:[(0,n.jsx)(c.f,{visible:s,zIndex:1e3,overlayProps:{color:"#000000"}}),(0,n.jsx)("iframe",{src:v,style:{width:"100%",height:"100%",background:"transparent"}})]}):null},y=e=>{let[t,i]=(0,r.useState)(null),[d,c]=(0,r.useState)(""),[u,h]=(0,r.useState)(!1),[g,m]=(0,r.useState)(null),[y,v]=(0,r.useState)(!1),[w,x]=(0,r.useState)(!1),[b,E]=(0,r.useState)(!1),T=(0,r.useRef)(null),k=(0,r.useCallback)(e=>{m(e),h(!0),v(!0)},[]);(0,r.useEffect)(()=>{(async()=>{let e=await (0,a.bf)(!0);c("done"),i((null==e?void 0:e.userInfo)||null)})()},[]),(0,r.useEffect)(()=>{let e=e=>{if(e.data&&"string"==typeof e.data&&-1==e.data.indexOf("webpackHot")){let t={};try{t=JSON.parse(e.data)||{}}catch(e){return}let{type:i,token:n,data:r,isNewUser:o,mobile:a,third:d,inviteCode:c}=t;"loginSuccessWithInviteCode"===i||"loginSuccess"===i?"1"!==o||a?((0,s.AR)("usertoken",n||r||"",{secure:"https"===window.location.protocol,sameSite:"https"===window.location.protocol?"none":""}),T.current?T.current():setTimeout(()=>{(0,l.Gv)(),window.location.reload()},0)):(v(!1),((e,t,i)=>{let{pathname:n,search:r}=window.location;if(r.indexOf("code")>-1&&r.indexOf("third")>-1)return;let o=r?`${r}&code=${e}&third=${i}&isNewUser=${t}`:`?code=${e}&third=${i}&isNewUser=${t}`;history.replaceState(null,"",`${n}${o}`)})(n||r||"",o,d||""),setTimeout(()=>{k()},100)):"bindPhoneSuccess"===i?("1"===o&&(0,s.AR)("usertoken",n||r||"",{secure:"https"===window.location.protocol,sameSite:"https"===window.location.protocol?"none":""}),v(!1),T.current?T.current():window.location.href=(()=>{let{pathname:e,search:t}=window.location,i=t.replace(/&?code=[^&]*/,"").replace(/&?third=[^&]*/,"").replace(/&?isNewUser=[^&]*/,"");return`${e}${i}`})()):"onPageColse"===i?v(!1):"redirectUrl"===i&&r&&(window.location.href=r)}};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}},[]);let R=(0,r.useMemo)(()=>y?(0,n.jsx)("div",{className:"login-modal-container",style:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:y?99999:-1},children:"aws"===o.config.env?(0,n.jsx)(p,{visible:y,needInvitedCode:!1,hideClose:b,onClose:()=>{null==e||e(),v(!1)}}):(0,n.jsx)(f,{visible:y,bindPhone:u,bindPhoneData:g,needInvitedCode:!1,onClose:()=>{null==e||e(),v(!1)}})}):null,[y,w,u,g,e,b]),S=(0,r.useMemo)(()=>!!t&&"done"===d,[t,d]),I=(0,r.useMemo)(()=>"done"===d&&!t,[t,d]);return{isLogin:S,showLogin:I,loginStatus:d,openLoginModal:(0,r.useCallback)(function(){let{needInvitedCode:e=!1,hideClose:t=!1,onLoginSuccess:i}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};v(!0),x(e||!1),E(t||!1),T.current=i},[]),openBindPhone:k,quitLogin:(0,r.useCallback)(()=>{(0,s.I4)(),window.location.href="/"},[]),LoginModal:R,userInfo:t}}},89135:function(e,t,i){i.d(t,{Z:()=>D});var n=i(97458),r=i(18839),o=i(38146),a=i(66711),l=i(4723),s=i(61194),d=i(81151),c=i(86909),u=i(52983),h=i(4925),f=i(5824),g=i(91255),m=i(11281);i(58450);var p=i(92769),y=i(43011),v=i(93516),w=i(41229),x=i.n(w),b=i(77875),E=i(23006),T=i(66666),k=i(71577),R=i(3365);let S=e=>{let{url:t}=e,{scene:i}=(0,a.L)(t);return(0,n.jsx)("primitive",{object:i})},I=(0,u.forwardRef)((e,t)=>{let{url:i}=e,{gl:o}=(0,r.A)(),a=(0,u.useRef)(null),[c,h]=(0,u.useState)(!0);return((0,u.useImperativeHandle)(t,()=>({capture:()=>{let e=o.domElement;if(!e)throw Error("Canvas not found");return e.toDataURL("image/png")},toggleAutoRotate:()=>{h(e=>!e)}}),[o.domElement]),i)?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(u.Suspense,{fallback:(0,n.jsx)(A,{}),children:(0,n.jsxs)(l.H,{environment:null,intensity:.5,adjustCamera:!1,children:[(0,n.jsx)(S,{url:i}),(0,n.jsx)(s.qA,{files:k,background:!1,blur:.5})]})}),(0,n.jsx)(d.z,{ref:a,enablePan:!0,enableZoom:!0,enableRotate:!0,rotateSpeed:1.2,zoomSpeed:1.2,panSpeed:1.2,minDistance:1,maxDistance:10,enableDamping:!1,screenSpacePanning:!0,autoRotate:c,autoRotateSpeed:2})]}):null});function P(e){let{visible:t,onClose:i,children:r}=e;return t?(0,n.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-black/50",children:(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("button",{onClick:i,className:"absolute top-4 right-4 z-[100] rounded-full bg-white/20 p-2 text-gray-400 hover:bg-white/40 hover:text-gray-200",children:(0,n.jsx)(T.Z,{})}),r]})}):null}function A(){let[e,t]=(0,u.useState)(0);return(0,u.useEffect)(()=>{let e=setInterval(()=>{t(t=>t>=98?(clearInterval(e),98):t+1)},50);return()=>clearInterval(e)},[]),(0,n.jsx)(c.V,{center:!0,children:(0,n.jsx)("div",{style:{width:300},children:(0,n.jsx)(y.Z,{percent:e,showInfo:!1,strokeColor:"#fff",trailColor:"#4A535F",size:"small"})})})}function C(e){let{url:t,name:i="This is the name of 3D image",threadId:r,actionId:a}=e,l=(0,u.useRef)(null),[s,d]=(0,u.useState)(!0);return(0,n.jsxs)("div",{style:{width:"calc(100vw - 48px)",maxWidth:"1098px",height:"624px"},className:"relative flex h-full w-full flex-col items-center justify-center",children:[(0,n.jsx)("div",{className:"absolute h-full w-full overflow-hidden rounded-3xl",style:{backgroundImage:`url(${R})`},children:(0,n.jsx)(o.Xz,{shadows:!0,camera:{position:[0,0,2],fov:50},gl:{preserveDrawingBuffer:!0},children:(0,n.jsx)(I,{ref:l,url:t})})}),(0,n.jsx)("div",{className:"absolute top-8 flex w-full flex-col items-center",children:(0,n.jsx)("div",{className:"font-[Outfit] text-2xl leading-[160%] font-medium text-[#EBEBEB]",children:i})}),(0,n.jsx)("div",{className:"absolute right-0 bottom-14 left-0 flex items-center justify-center",children:(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)(v.Z,{title:s?(0,E.Iu)("viewer_3d_button_rotate_stop"):(0,E.Iu)("viewer_3d_button_rotate_start"),children:(0,n.jsx)("button",{className:x()("rounded-full px-6 py-3",`view-3d-button ${s?"active":""}`),onClick:()=>{l.current&&(l.current.toggleAutoRotate(),d(e=>!e))},children:(0,n.jsx)(g.Z,{})})}),(0,n.jsx)(v.Z,{title:(0,E.Iu)("viewer_3d_button_download_model"),children:(0,n.jsx)("button",{className:x()("rounded-full px-6 py-3","view-3d-button"),onClick:()=>{let e=document.createElement("a");e.href=t,e.download="model.glb",e.style.display="none",e.target="_self",document.body.appendChild(e),e.click(),document.body.removeChild(e),r&&(0,h.mc)("agent.export.click",{thread_id:r,action_id:a,action_type:"download",object_type:"3d_model",object_url:t})},children:(0,n.jsx)(f.Z,{})})}),(0,n.jsx)(v.Z,{title:(0,E.Iu)("viewer_3d_button_export_capture"),children:(0,n.jsx)("button",{className:x()("rounded-full px-6 py-3","view-3d-button"),onClick:()=>{if(!l.current)return;let e=l.current.capture(),t=document.createElement("a");t.href=e,t.download="capture.png",document.body.appendChild(t),t.click(),document.body.removeChild(t)},children:(0,n.jsx)(m.Z,{})})})]})})]})}function D(){let{isViewerOpen:e,closeViewer:t,url:i,title:r,threadId:o,actionId:a}=(0,p.dJ)();return(0,n.jsx)(b.E.div,{className:"absolute z-[300] h-full w-full",initial:{opacity:0},animate:{opacity:+!!e,pointerEvents:e?"auto":"none"},transition:{duration:.2},children:(0,n.jsx)(P,{visible:e,onClose:()=>t(),children:(0,n.jsx)(C,{url:i,name:r,threadId:o,actionId:a})})})}I.displayName="Scene"},92769:function(e,t,i){i.d(t,{dJ:()=>o,wE:()=>s});var n=i(72335),r=i(98830);let o=(0,n.Ue)(e=>({url:null,title:null,isViewerOpen:!1,openViewer:t=>e({...t,isViewerOpen:!0}),closeViewer:()=>e({isViewerOpen:!1,url:null,title:null})})),{useStore:a,setState:l,getState:s}=(0,r.b)(o)},57655:function(e,t,i){i.a(e,async function(e,n){try{i.d(t,{Z:()=>d});var r=i(97458),o=i(52983),a=i(30967),l=i(86423),s=e([l]);l=(s.then?(await s)():s)[0];let d=(0,o.memo)(e=>{let{element:t}=e;return(0,r.jsx)(a.ZA,{id:`${t.id}-${t.type}`,opacity:t.opacity,visible:t.visible,listening:!t.locked,ref:(0,l.Y)(t)})});n()}catch(e){n(e)}})},50094:function(e,t,i){i.a(e,async function(e,n){try{i.d(t,{A:()=>b});var r=i(97458),o=i(52983),a=i(30967),l=i(35040),s=i(33061),d=i(77619),c=i(60542),u=i(81949),h=i(99608),f=i(9867),g=i(98516),m=i(95421),p=i(74137),y=i(60017),v=i(10558),w=i(74288),x=e([u,h,y,g,d]);[u,h,y,g,d]=x.then?(await x)():x;let b=o.memo(e=>{var t,i;let{element:n,children:x}=e,[b,E]=(0,o.useState)(null),T=(0,w.md)("blurDep"),k=(0,m.xl)("pathKitReady"),R=(0,c.rq)("editor"),S=null==(t=(0,g.rI)(n.id))?void 0:t.blurEffect,I=(0,u.eT)("sceneGraph").findById(n.id),P=(0,f.qQ)("groupRenderDep"),A=(0,c.px)(n),C="vector"===n.type?P:null;(0,h.BT)("nodes");let D=async()=>{if(!S)return void E(null);let e=I.absoluteStrokeBounds,t=I.getAbsoluteBoundingBox(),i=t.x-e.x,r=t.y-e.y;try{let t=2*S,o=e.width,a=e.height,l=Math.max(o,a),s=(0,v.V)(I,l,S),d=Math.min(s/(o+t),s/(a+t)),c=s/(2*d)-o/2,u=s/(2*d)-a/2,h=document.createElement("canvas");h.width=s,h.height=s;let f=h.getContext("2d");f.translate(s/2,s/2),f.scale(d,d),f.translate(-o/2,-a/2),f.translate(i,r),await (0,y.l)(f,(0,g.rI)(n.id)),f.translate(-i,-r);let m=S*d,w=await (0,p.Af)(m,h);E({image:w,offsetX:-i-c,offsetY:-r-u,width:s,height:s,scale:d})}catch(e){console.error("Error generating shadow:",e)}};return((0,o.useEffect)(()=>{if(I&&S&&(null==I?void 0:I.isVisible)!==!1&&(null==I?void 0:I.opacity)!==0&&0!==S&&k){if(n.type===l.nX.vector){var e,t,i,r,o,a;if((null==n||null==(r=n.data)||null==(i=r.stroke)||null==(t=i.strokePosition)||null==(e=t.toLowerCase)?void 0:e.call(t))!=="center"&&!(null==n||null==(a=n.data)||null==(o=a.strokeGeometry)?void 0:o.length))return}(n.type!==l.nX.text||R)&&D()}},[JSON.stringify(n.gradient),null==n||null==(i=n.data)?void 0:i.booleanOperation,T,S,JSON.stringify((0,d.N_)(n)),JSON.stringify(null==I?void 0:I.fillPaint),JSON.stringify(null==I?void 0:I.effects),JSON.stringify(null==I?void 0:I.stroke),n.fillType,n.fillImageUrl,A,C,null==I?void 0:I.isVisible,null==I?void 0:I.width,null==I?void 0:I.height,null==I?void 0:I.opacity,k,R]),S&&(null==b?void 0:b.image)&&!(S<=.1))?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(a.Ee,{name:"element-blur",image:b.image,x:b.offsetX,y:b.offsetY,width:b.width,height:b.height,listening:!1,scale:{x:1/b.scale,y:1/b.scale}},`${n.id}-blur`),(0,r.jsx)(a.ZA,{visible:!1,listening:!1,children:x})]}):(s.U.add(n.id),x)});b.displayName="BlurWrapper",n()}catch(e){n(e)}})},74137:function(e,t,i){i.d(t,{Af:()=>m,Ey:()=>g});var n=i(72513);class r{addTexture(e){this.textures.add(e)}addFramebuffer(e){this.framebuffers.add(e)}addProgram(e){this.programs.add(e)}addBuffer(e){this.buffers.add(e)}cleanup(e){this.textures.forEach(t=>e.deleteTexture(t)),this.framebuffers.forEach(t=>e.deleteFramebuffer(t)),this.programs.forEach(t=>e.deleteProgram(t)),this.buffers.forEach(t=>e.deleteBuffer(t)),this.textures.clear(),this.framebuffers.clear(),this.programs.clear(),this.buffers.clear()}constructor(){(0,n._)(this,"textures",new Set),(0,n._)(this,"framebuffers",new Set),(0,n._)(this,"programs",new Set),(0,n._)(this,"buffers",new Set)}}function o(e,t,i){let n=e.createShader(t);if(!n)throw Error("无法创建着色器");if(e.shaderSource(n,i),e.compileShader(n),!e.getShaderParameter(n,e.COMPILE_STATUS)){let t=e.getShaderInfoLog(n);throw e.deleteShader(n),Error(`\u{7740}\u{8272}\u{5668}\u{7F16}\u{8BD1}\u{9519}\u{8BEF}\u{FF1A}${t}`)}return n}function a(e,t,i){let n=e.createProgram();if(!n)throw Error("无法创建程序");if(e.attachShader(n,t),e.attachShader(n,i),e.linkProgram(n),!e.getProgramParameter(n,e.LINK_STATUS)){let t=e.getProgramInfoLog(n);throw e.deleteProgram(n),Error(`\u{7A0B}\u{5E8F}\u{94FE}\u{63A5}\u{9519}\u{8BEF}\u{FF1A}${t}`)}return n}function l(e,t,i,n){let r=n||e.createTexture();if(!r)throw Error("无法创建纹理");return e.bindTexture(e.TEXTURE_2D,r),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,t,i,0,e.RGBA,e.UNSIGNED_BYTE,null),r}function s(e,t,i){let n=i||e.createFramebuffer();if(!n)throw Error("无法创建帧缓冲区");if(e.bindFramebuffer(e.FRAMEBUFFER,n),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0),e.checkFramebufferStatus(e.FRAMEBUFFER)!==e.FRAMEBUFFER_COMPLETE)throw i||e.deleteFramebuffer(n),Error("帧缓冲区创建失败");return n}let d=`#version 300 es
uniform vec4 quad;
in vec2 position2;
out vec2 _coord2;
void main() {
    _coord2 = mix(quad.xy, quad.zw, position2);
    gl_Position = vec4(_coord2 * 2.0 - 1.0, 0, 1);
}`,c=`#version 300 es
precision highp float;
const int maxRadiusInTexelsForBlurs = 250;
uniform int increaseMaxRadiusForBlurs;
uniform float count;
uniform vec2 blurDelta;
uniform sampler2D texture0;
in vec2 _coord2;
out vec4 fig_FragColor;
void main() {
    float weight = count;
    vec4 result = texture(texture0, _coord2) * weight;
    float total = weight;
    for (int i = 1; i < maxRadiusInTexelsForBlurs; i += 2) {
        if (!bool(increaseMaxRadiusForBlurs)) {
            if (i >= 32) {
                break;
            }
        }
        if (float(i) > count) {
            break;
        }
        float t0 = float(i);
        float t1 = min(t0 + 1.0, count);
        vec2 coord0_neg = _coord2 - blurDelta * t0;
        vec2 coord0_pos = _coord2 + blurDelta * t0;
        vec2 coord1_neg = _coord2 - blurDelta * t1;
        vec2 coord1_pos = _coord2 + blurDelta * t1;
        float weight0 = count - t0;
        float weight1 = count - t1;
        float weightSum = weight0 + weight1;
        vec2 coord_neg = (coord0_neg * weight0 + coord1_neg * weight1) / weightSum;
        vec2 coord_pos = (coord0_pos * weight0 + coord1_pos * weight1) / weightSum;
        result += weightSum * (texture(texture0, coord_neg) + texture(texture0, coord_pos));
        total += 2.0 * weightSum;
    }
    fig_FragColor = result / total;
}`,u=`#version 300 es
precision highp float;
uniform sampler2D texture0;
uniform vec4 colorFilter;
in vec2 _coord2;
out vec4 fig_FragColor;
void main() {
  vec2 flippedCoord = vec2(_coord2.x, 1.0 - _coord2.y);
  vec4 original = texture(texture0, flippedCoord);
  if(original.a < 0.001) {
    fig_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
    return;
  }
  fig_FragColor = vec4(colorFilter.rgb * colorFilter.a, colorFilter.a);
}`,h=new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]);class f{static getInstance(){return f.instance||(f.instance=new f),f.instance}initializeWebGL(){if(!this.gl){if(this.canvas=document.createElement("canvas"),this.gl=this.canvas.getContext("webgl2",{preserveDrawingBuffer:!1,antialias:!1,premultipliedAlpha:!0,alpha:!0}),!this.gl)throw Error("WebGL2不支持");this.setupPrograms(),this.setupVertexBuffer()}}setupPrograms(){if(!this.gl)return;let e=o(this.gl,this.gl.VERTEX_SHADER,d),t=o(this.gl,this.gl.FRAGMENT_SHADER,c);this.blurProgram=a(this.gl,e,t),this.resourceManager.addProgram(this.blurProgram);let i=o(this.gl,this.gl.VERTEX_SHADER,d),n=o(this.gl,this.gl.FRAGMENT_SHADER,u);this.filterProgram=a(this.gl,i,n),this.resourceManager.addProgram(this.filterProgram),this.gl.deleteShader(e),this.gl.deleteShader(t),this.gl.deleteShader(i),this.gl.deleteShader(n),this.blurPositionAttribute=this.gl.getAttribLocation(this.blurProgram,"position2"),this.blurUniforms={quad:this.gl.getUniformLocation(this.blurProgram,"quad"),count:this.gl.getUniformLocation(this.blurProgram,"count"),blurDelta:this.gl.getUniformLocation(this.blurProgram,"blurDelta"),increaseMax:this.gl.getUniformLocation(this.blurProgram,"increaseMaxRadiusForBlurs"),texture:this.gl.getUniformLocation(this.blurProgram,"texture0")},this.filterPositionAttribute=this.gl.getAttribLocation(this.filterProgram,"position2"),this.filterUniforms={texture:this.gl.getUniformLocation(this.filterProgram,"texture0"),colorFilter:this.gl.getUniformLocation(this.filterProgram,"colorFilter")}}setupVertexBuffer(){if(this.gl){if(this.vertexBuffer=this.gl.createBuffer(),!this.vertexBuffer)throw Error("无法创建顶点缓冲区");this.resourceManager.addBuffer(this.vertexBuffer),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,h,this.gl.STATIC_DRAW)}}setupVertexAttributes(e){this.gl&&this.vertexBuffer&&(this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexBuffer),this.gl.enableVertexAttribArray(e),this.gl.vertexAttribPointer(e,2,this.gl.FLOAT,!1,0,0))}setupCanvas(e,t){this.canvas&&this.gl&&(this.canvas.width=e,this.canvas.height=t,this.gl.viewport(0,0,e,t))}generateShadow(e,t,i){if(e<0)throw Error("模糊半径必须大于等于0");this.initializeWebGL();let n=this.gl,r=this.canvas,o=t.width,a=t.height;this.setupCanvas(o,a);try{this.initialTexture=l(n,o,a,this.initialTexture),this.resourceManager.textures.has(this.initialTexture)||this.resourceManager.addTexture(this.initialTexture),n.bindTexture(n.TEXTURE_2D,this.initialTexture),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,t),this.filteredTexture=l(n,o,a,this.filteredTexture),this.filteredFramebuffer=s(n,this.filteredTexture,this.filteredFramebuffer),this.resourceManager.textures.has(this.filteredTexture)||this.resourceManager.addTexture(this.filteredTexture),this.resourceManager.framebuffers.has(this.filteredFramebuffer)||this.resourceManager.addFramebuffer(this.filteredFramebuffer),n.bindFramebuffer(n.FRAMEBUFFER,this.filteredFramebuffer),n.useProgram(this.filterProgram),this.setupVertexAttributes(this.filterPositionAttribute);let d=n.getUniformLocation(this.filterProgram,"quad");if(d&&n.uniform4f(d,0,0,1,1),n.activeTexture(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,this.initialTexture),n.uniform1i(this.filterUniforms.texture,0),n.uniform4fv(this.filterUniforms.colorFilter,i||[1,0,0,1]),n.drawArrays(n.TRIANGLES,0,6),0===e)return n.bindFramebuffer(n.FRAMEBUFFER,null),n.drawArrays(n.TRIANGLES,0,6),createImageBitmap(r);return this.performBlur(e,this.filteredTexture,o,a)}catch(e){throw Error(`WebGL\u{9634}\u{5F71}\u{751F}\u{6210}\u{5931}\u{8D25}: ${e instanceof Error?e.message:String(e)}`)}}generateBlur(e,t){if(e<0)throw Error("模糊半径必须大于等于0");this.initializeWebGL();let i=t.width,n=t.height;this.setupCanvas(i,n);try{if(this.initialTexture=l(this.gl,i,n,this.initialTexture),this.resourceManager.textures.has(this.initialTexture)||this.resourceManager.addTexture(this.initialTexture),this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.initialTexture),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,t),this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),0===e)return this.renderDirectly(this.initialTexture);return this.performBlur(e,this.initialTexture,i,n)}catch(e){throw Error(`WebGL\u{6A21}\u{7CCA}\u{751F}\u{6210}\u{5931}\u{8D25}: ${e instanceof Error?e.message:String(e)}`)}}renderDirectly(e){let t=this.gl;return t.useProgram(this.blurProgram),this.setupVertexAttributes(this.blurPositionAttribute),t.uniform4f(this.blurUniforms.quad,0,0,1,1),t.uniform1f(this.blurUniforms.count,0),t.uniform1i(this.blurUniforms.increaseMax,0),t.uniform1i(this.blurUniforms.texture,0),t.uniform2f(this.blurUniforms.blurDelta,0,0),t.bindFramebuffer(t.FRAMEBUFFER,null),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,e),t.drawArrays(t.TRIANGLES,0,6),createImageBitmap(this.canvas)}performBlur(e,t,i,n){let r=this.gl;return this.horizTexture=l(r,i,n,this.horizTexture),this.horizFramebuffer=s(r,this.horizTexture,this.horizFramebuffer),this.resourceManager.textures.has(this.horizTexture)||this.resourceManager.addTexture(this.horizTexture),this.resourceManager.framebuffers.has(this.horizFramebuffer)||this.resourceManager.addFramebuffer(this.horizFramebuffer),r.useProgram(this.blurProgram),this.setupVertexAttributes(this.blurPositionAttribute),r.uniform4f(this.blurUniforms.quad,0,0,1,1),r.uniform1f(this.blurUniforms.count,e),r.uniform1i(this.blurUniforms.increaseMax,+(e>32)),r.uniform1i(this.blurUniforms.texture,0),r.disable(r.BLEND),r.bindFramebuffer(r.FRAMEBUFFER,this.horizFramebuffer),r.clearColor(0,0,0,0),r.clear(r.COLOR_BUFFER_BIT),r.uniform2f(this.blurUniforms.blurDelta,1/i,0),r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,t),r.drawArrays(r.TRIANGLES,0,6),r.bindFramebuffer(r.FRAMEBUFFER,null),r.clearColor(0,0,0,0),r.clear(r.COLOR_BUFFER_BIT),r.uniform2f(this.blurUniforms.blurDelta,0,1/n),r.bindTexture(r.TEXTURE_2D,this.horizTexture),r.drawArrays(r.TRIANGLES,0,6),createImageBitmap(this.canvas)}destroy(){if(this.gl){this.resourceManager.cleanup(this.gl);let e=this.gl.getExtension("WEBGL_lose_context");e&&e.loseContext()}this.canvas=null,this.gl=null,this.blurProgram=null,this.filterProgram=null,this.vertexBuffer=null,this.blurUniforms=null,this.filterUniforms=null,this.blurPositionAttribute=-1,this.filterPositionAttribute=-1,this.initialTexture=null,this.horizTexture=null,this.horizFramebuffer=null,this.filteredTexture=null,this.filteredFramebuffer=null,f.instance=null}constructor(){(0,n._)(this,"canvas",null),(0,n._)(this,"gl",null),(0,n._)(this,"blurProgram",null),(0,n._)(this,"filterProgram",null),(0,n._)(this,"vertexBuffer",null),(0,n._)(this,"blurUniforms",null),(0,n._)(this,"filterUniforms",null),(0,n._)(this,"blurPositionAttribute",-1),(0,n._)(this,"filterPositionAttribute",-1),(0,n._)(this,"resourceManager",new r),(0,n._)(this,"initialTexture",null),(0,n._)(this,"horizTexture",null),(0,n._)(this,"horizFramebuffer",null),(0,n._)(this,"filteredTexture",null),(0,n._)(this,"filteredFramebuffer",null)}}async function g(e,t,i){return f.getInstance().generateShadow(e,t,i)}async function m(e,t){return f.getInstance().generateBlur(e,t)}(0,n._)(f,"instance",null)},60017:function(e,t,i){i.a(e,async function(e,n){try{i.d(t,{l:()=>a});var r=i(727),o=e([r]);async function a(e,t){await (0,r.y)({element:t,ctx:e})}r=(o.then?(await o)():o)[0],n()}catch(e){n(e)}})},94921:function(e,t,i){i.a(e,async function(e,n){try{i.d(t,{K:()=>w});var r=i(97458),o=i(52983),a=i(30967),l=i(35040),s=i(60542),d=i(81949),c=i(9867),u=i(98516),h=i(95421),f=i(74137),g=i(60017),m=i(48948),p=i(74288),y=i(10558),v=e([d,g,u]);[d,g,u]=v.then?(await v)():v;let w=o.memo(e=>{var t,i,n;let{element:v,children:w}=e,[x,b]=(0,o.useState)([]),E=(0,h.xl)("pathKitReady"),T=(0,m.Q0)("shadowDep"),k=(0,s.rq)("editor"),R=(null==v||null==(t=v.effects)?void 0:t.filter(e=>("DROP_SHADOW"===e.type||"INNER_SHADOW"===e.type)&&e.visible))||[],S=(0,d.eT)("sceneGraph").findById(v.id),I=(0,c.qQ)("dataRenderDep"),P=(0,s.px)(v),A="vector"===v.type?I:null;(0,p.md)("blurDep");let C=(null==(i=(0,u.rI)(v.id))?void 0:i.blurEffect)||0,D=R.filter(e=>"DROP_SHADOW"===e.type),M=async()=>{if(!D.length)return void b([]);let e=[],t=S.absoluteStrokeBounds,i=S.getAbsoluteBoundingBox(),n=i.x-t.x,r=i.y-t.y;for(let i of D)try{var o,a;let l=Math.max(i.radius,C),s=Math.ceil(2*l),d=t.width,c=t.height,h=Math.max(d,c),m=(0,y.V)(S,h,l),p=d+s,w=c+s,x=Math.min(m/p,m/w),b=m/(2*x)-d/2,E=m/(2*x)-c/2,T=i.offset.x-n,k=i.offset.y-r,R=T-b,I=k-E,P=document.createElement("canvas");P.width=m,P.height=m;let A=P.getContext("2d");A.translate(m/2,m/2),A.scale(x,x),A.translate(-d/2,-c/2),A.translate(n,r),await (0,g.l)(A,v),A.translate(-n,-r);let D=l*x,M=await (0,f.Ey)(D,P,[i.color.r,i.color.g,i.color.b,i.color.a*S.opacity]),F=(null==S||null==(o=S.fillPaint)?void 0:o.opacity)<1||(null==S||null==(a=S.strokePaint)?void 0:a.opacity)<1||(null==S?void 0:S.opacity)<1;!i.showShadowBehindNode&&F?(A.clearRect(-s,-s,m/x+s,m/x+s),A.fillStyle="black",A.translate(-T,-k),await (0,g.l)(A,(0,u.rI)(v.id)),A.globalCompositeOperation="source-out",A.translate(T,k),A.drawImage(M,-b,-E,m/x,m/x),e.push({image:P,offsetX:R,offsetY:I,width:m,height:m,scale:x})):e.push({image:M,offsetX:R,offsetY:I,width:m,height:m,scale:x})}catch(e){console.error("Error generating shadow:",e)}b(e)};return((0,o.useEffect)(()=>{if(S&&(null==D?void 0:D.length)&&(null==S?void 0:S.isVisible)!==!1&&(null==S?void 0:S.opacity)!==0&&E){if(v.type===l.nX.vector){var e,t,i,n,r,o;if((null==v||null==(n=v.data)||null==(i=n.stroke)||null==(t=i.strokePosition)||null==(e=t.toLowerCase)?void 0:e.call(t))!=="center"&&!(null==v||null==(o=v.data)||null==(r=o.strokeGeometry)?void 0:r.length))return}(v.type!==l.nX.text||k)&&M()}},[JSON.stringify(v.gradient),null==v||null==(n=v.data)?void 0:n.booleanOperation,C,JSON.stringify(null==S?void 0:S.fillPaint),JSON.stringify(null==S?void 0:S.effects),JSON.stringify(null==S?void 0:S.stroke),v.fillType,v.fillImageUrl,P,A,null==S?void 0:S.isVisible,null==S?void 0:S.width,null==S?void 0:S.height,null==S?void 0:S.opacity,E,k,T]),S)?D.length&&(null==S?void 0:S.isVisible)!==!1&&(null==S?void 0:S.opacity)!==0?(0,r.jsxs)(r.Fragment,{children:[x.map((e,t)=>(0,r.jsx)(a.Ee,{name:"element-shadow",image:e.image,x:e.offsetX,y:e.offsetY,width:e.width,height:e.height,listening:!1,scale:{x:1/e.scale,y:1/e.scale}},`shadow-${t}`)),w]}):(0,r.jsx)(r.Fragment,{children:w}):null});w.displayName="ShadowWrapper",n()}catch(e){n(e)}})},10558:function(e,t,i){i.d(t,{V:()=>n});let n=(e,t,i)=>e.rotation%90==0&&["shape_square","image"].includes(e.type)?512:i<4?t<=512?1024:t<=1024?2048:4096:i<10?t<=512?512:t<=1024?1024:t<=2048?2048:4096:512},99156:function(e,t,i){i.a(e,async function(e,n){try{i.d(t,{H:()=>c});var r=i(97458),o=i(52983),a=i(94921),l=i(50094),s=i(82955),d=e([a,l]);[a,l]=d.then?(await d)():d;let c=o.memo(e=>{let{element:t,children:i}=e;return s._l?(0,r.jsx)(a.K,{element:t,children:(0,r.jsx)(l.A,{element:t,children:i})}):i});c.displayName="EffectWrapper",n()}catch(e){n(e)}})},18332:function(e,t,i){i.d(t,{M8:()=>u});var n=i(97458),r=i(30967),o=i(98830);let a=(0,i(80413).F)()(()=>({draggingId:"",targetId:"",colorRefDisabled:!1})),{useStore:l,setState:s,getState:d}=(0,o.b)(a);var c=i(23006);function u(e){let{targetId:t,colorRefDisabled:i}=l(e=>e),{element:o}=e;if(t!==o.id)return null;let{width:a,height:s}=o;if(a<260||s<41)return null;let d=Math.min(a/260,s/41),u=(a-260*d)/2;return(0,n.jsxs)(r.ZA,{name:"imageDropComp",scale:{x:d,y:d},offset:{x:u,y:0},children:[(0,n.jsx)(r.UL,{width:100,height:27,x:8,y:14,fill:"#56A8FF",cornerRadius:4,name:"imageDropCompImg2Img"}),(0,n.jsx)(r.UL,{width:100,height:27,x:152,y:14,fill:i?"#999":"#56A8FF",cornerRadius:4,name:"imageDropCompColorRef"}),(0,n.jsx)(r.xv,{text:`+${(0,c.Iu)("image_ref")}`,fill:"white",fontSize:12,x:18,y:22}),(0,n.jsx)(r.xv,{text:`+${(0,c.Iu)("color_ref")}`,fill:"white",fontSize:12,x:162,y:22})]})}},1619:function(e,t,i){i.a(e,async function(e,n){try{i.d(t,{Kn:()=>p,Tj:()=>f});var r=i(97458),o=i(52983),a=i(30967),l=i(23006),s=i(66003),d=i(18332),c=i(91682),u=i(198),h=e([s,c]);[s,c]=h.then?(await h)():h;let f=o.memo(e=>{let{element:t,deferredViewport:i,superLeading:n}=e,l=(0,o.useRef)(null),d=(0,s.eP)(t,l,i,n),[h,f]=(0,o.useState)("#FFFFFF");(0,o.useEffect)(()=>{d?f(""):"image_set_item"===t.type&&f("#E7F6FD")},[t.type,d]);let g=(0,o.useMemo)(()=>(0,c.TE)(t),[t]);return t.scaleMode===u.gF.Crop?(0,r.jsx)(a.ZA,{id:t.id+"-image",name:t.id,role:"element",roleType:"image",width:t.width,height:t.height,opacity:t.opacity,visible:t.visible,listening:!t.locked,clipX:0,clipY:0,clipWidth:t.width,clipHeight:t.height,children:(0,r.jsx)(a.Ee,{image:d,ref:l,fill:h,imageUrl:t.url,x:g.x,y:g.y,width:g.width,height:g.height})}):(0,r.jsx)(a.Ee,{id:t.id+"-image",name:t.id,role:"element",roleType:"image",image:d,ref:l,fill:h,imageUrl:t.url,width:t.width,height:t.height,opacity:t.opacity,visible:t.visible,listening:!t.locked})}),g=o.memo(e=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(a.UL,{role:"element",roleType:"image",fill:"white",...e}),(0,r.jsx)(a.xv,{text:(0,l.Iu)("illigal_content_text"),fontSize:20,align:"center",fill:"black",verticalAlign:"middle",padding:50,...e})]})),m=o.memo(e=>{var t;let{element:i}=e;return(null==(t=i.data)?void 0:t.illegal)?(0,r.jsx)(g,{width:i.width,height:i.height}):(0,r.jsx)(f,{...e})}),p=o.memo(e=>(0,r.jsxs)(a.ZA,{name:"image-element",children:[(0,r.jsx)(m,{...e}),(0,r.jsx)(d.M8,{...e})]}));n()}catch(e){n(e)}})},97543:function(e,t,i){i.a(e,async function(e,n){try{i.d(t,{Z:()=>d});var r=i(97458),o=i(52983),a=i(30967),l=i(4800),s=e([l]);l=(s.then?(await s)():s)[0];let d=(0,o.memo)(e=>{let{element:t}=e;return(0,r.jsx)(a.ZA,{id:`${t.id}-${t.type}`,opacity:t.opacity,visible:t.visible,listening:!t.locked,ref:(0,l.V)(t)})});n()}catch(e){n(e)}})},15849:function(e,t,i){i.d(t,{b:()=>n});class n{render(e,t){if(this.canRender(t.element)){if("canvas"===e)return this.canvasRender(t.element,t.ctx);else if("konva"===e)return this.konvaRender(t.element,t.deferredViewport,t.config)}}}},2771:function(e,t,i){i.a(e,async function(e,n){try{i.d(t,{z:()=>u});var r=i(97458),o=i(91682),a=i(77619),l=i(15849),s=i(43755),d=i(1619),c=e([o,a,s,d]);[o,a,s,d]=c.then?(await c)():c;class u extends l.b{canRender(e){return"image"===e.type}async canvasRender(e,t){let i=async()=>{let i=e.url,n=(0,o.TE)(e);if(t.save(),t.rect(0,0,e.width,e.height),t.clip(),(0,a.Te)(e)){let r=await (0,a.R$)(i,e,{imageBitmap:!0});if(null==r?void 0:r.imageBitmap){t.drawImage(r.imageBitmap,n.x,n.y,n.width,n.height),t.restore();return}}await (0,s.f4)(t,i,n.x,n.y,n.width,n.height),t.restore()};await i()}konvaRender(e,t,i){return(0,r.jsx)(d.Kn,{element:e,config:i,deferredViewport:t})}constructor(){super()}}n()}catch(e){n(e)}})},39019:function(e,t,i){i.a(e,async function(e,n){try{i.d(t,{t:()=>g});var r=i(97458),o=i(15849),a=i(30967),l=i(32127),s=i(74288),d=i(48948),c=i(35962),u=i(43755),h=e([c,u,l]);[c,u,l]=h.then?(await h)():h;let f=new Map;class g extends o.b{canRender(e){var t,i,n;return"text"===e.type&&(null==e||null==(n=e.richData)||null==(i=n.derivedTextData)||null==(t=i.glyphs)?void 0:t.length)}canvasRender(e,t){(0,l.ru)(e,e=>{(e=>{if(!e||!e.derivedTextData)return;let{glyphs:i}=e.derivedTextData;if(!(null==i?void 0:i.length))return;let n=e.getFillPaintsForGlyphs(),r=null==i?void 0:i.length;((i,r)=>{for(let o=0;o<r;o++){let r=i[o];if(r.commandsBlob)for(let i=0;i<n[o].length;i++){let a=n[o][i];if(!a.visible)continue;let l=a.type;if("IMAGE"===l){t.save();let i=a.imageUrl,n=(0,c.um)(i);if(!n)return void(0,c.kE)(i).then(e=>{e&&((0,d.GX)(),(0,s.MC)())});let o=(0,u.R1)({width:null==n?void 0:n.width,height:null==n?void 0:n.height},{width:e.width,height:e.height});(0,u.i6)(t,n,{...o,x:-r.position.x,y:-r.position.y}),t.translate(r.position.x,r.position.y);let l=new Path2D(r.commandsBlob);t.fill(l),t.restore();continue}if(l.startsWith("GRADIENT")){t.save(),(0,u.BC)(t,l,{width:e.width,height:e.height},a.gradient.stops,a.gradient.start,a.gradient.end,{x:-r.position.x,y:-r.position.y}),t.translate(r.position.x,r.position.y);let i=new Path2D(r.commandsBlob);t.fill(i),t.restore();continue}if("SOLID"===l){t.save(),t.fillStyle=`rgba(${255*a.color.r},${255*a.color.g},${255*a.color.b},${a.opacity})`,t.translate(r.position.x,r.position.y);let e=new Path2D(r.commandsBlob);t.fill(e),t.restore();continue}}}})(i,r),((e,i)=>{for(let r=0;r<i;r++){var n;let i=e[r];if(!(null==(n=i.emojiCodePoints)?void 0:n.length))continue;let o=i.emojiCodePoints.map(e=>e.toString(16)).join("-"),a=e=>{var n;e&&(null==(n=i.emojiRect)?void 0:n.length)&&t.drawImage(e,i.emojiRect[0],i.emojiRect[1],i.emojiRect[2]-i.emojiRect[0],i.emojiRect[3]-i.emojiRect[1])};if(f.has(o)){let e=f.get(o);a(e)}else f.set(o,null),fetch(`https://static.figma.com/emoji/5/apple/medium/${o}.png`).then(async e=>{if(e.ok){let t=await e.arrayBuffer(),i=new Blob([t]),n=await createImageBitmap(i);f.set(o,n),(0,d.GX)(),(0,s.MC)()}else f.set(o,null)})}})(i,r),(i=>{let r=e.getTextDecorationRects();for(let e=0;e<i;e++){let i=r[e];if(i&&0!==i[2])for(let r=0;r<n[e].length;r++){let o=n[e][r];o.visible&&(t.save(),t.fillStyle=`rgba(${255*o.color.r},${255*o.color.g},${255*o.color.b},${o.opacity})`,t.fillRect(i[0],i[1],i[2],i[3]),t.restore())}}})(r)})(e)}),(()=>{var i,n,r;let o=e.strokeData;if(!o||!(null==o||null==(n=o.strokePaints)||null==(i=n[0])?void 0:i.visible)||!(null==(r=o.strokePaints[0])?void 0:r.opacity)||(null==o?void 0:o.strokeAlign)==="INSIDE")return;let a=o.strokePaints[0].color,s=o.strokeWeight,d=o.strokePaints[0].opacity;t.strokeStyle=`rgba(${255*a.r},${255*a.g},${255*a.b},${d})`,t.lineWidth=(null==o?void 0:o.strokeAlign)==="CENTER"?s:2*s,(0,l.ru)(e,e=>{(e=>{if(!e||!e.derivedTextData)return;let{glyphs:i}=e.derivedTextData;if(!(null==i?void 0:i.length))return;let n=e.getFillPaintsForGlyphs(),r=null==i?void 0:i.length;for(let e=0;e<r;e++){let n=i[e];if(!n.commandsBlob)continue;t.save(),t.translate(n.position.x,n.position.y);let r=new Path2D(n.commandsBlob);t.stroke(r),t.restore()}(i=>{let r=e.getTextDecorationRects();for(let e=0;e<i;e++){let i=r[e];if(i&&0!==i[2])for(let r=0;r<n[e].length;r++){let o=n[e][r];o.visible&&(t.save(),t.strokeStyle=`rgba(${255*o.color.r},${255*o.color.g},${255*o.color.b},${o.opacity})`,t.strokeRect(i[0],i[1],i[2],i[3]),t.restore())}}})(r)})(e)})})()}konvaRender(e){let t=(0,l.LN)(e);return(0,r.jsx)(a.ZA,{ref:t,id:`${e.id}-text`,opacity:e.opacity,visible:e.visible})}constructor(){super()}}n()}catch(e){n(e)}})},43755:function(e,t,i){i.a(e,async function(e,n){try{i.d(t,{BC:()=>c,R1:()=>s,WZ:()=>u,f4:()=>h,i6:()=>d}),i(52983);var r=i(60085),o=i(81091),a=i(35962),l=e([a]);a=(l.then?(await l)():l)[0];let h=async(e,t,i,n,r,l)=>{let s=(0,o.Vf)(t),d=(0,a.um)(t)||(0,a.um)(s);if(d)e.drawImage(d,i,n,r,l);else{let t=await (0,a.kE)(s);t&&e.drawImage(t,i,n,r,l)}};function s(e,t){let i;if(!e||!t||e.width<=0||e.height<=0||t.width<=0||t.height<=0)return{scale:1,offsetX:0,offsetY:0};let n=e.width/e.height,r=t.width/t.height,o=0,a=0;if(n>r){i=t.height/e.height;let n=e.width*i;o=(t.width-n)/2}else{i=t.width/e.width;let n=e.height*i;a=(t.height-n)/2}return{scale:i,offsetX:-o/i,offsetY:-a/i}}function d(e,t,i){let n=e.createPattern(t,"no-repeat"),o=new r.Transform;o.translate(i.x||0,i.y||0),o.scale(i.scale,i.scale),o.translate(-i.offsetX,-i.offsetY);let a=o.getMatrix(),l="undefined"==typeof DOMMatrix?{a:a[0],b:a[1],c:a[2],d:a[3],e:a[4],f:a[5]}:new DOMMatrix(a);n.setTransform(l),e.fillStyle=n}function c(e,t,i,n,r,o,a){if("GRADIENT_LINEAR"===t){let{fillLinearGradientColorStops:l,fillLinearGradientStartPoint:s,fillLinearGradientEndPoint:d}=u(i,n,r,o,t),c=e.createLinearGradient(s.x+((null==a?void 0:a.x)||0),s.y+((null==a?void 0:a.y)||0),d.x+((null==a?void 0:a.x)||0),d.y+((null==a?void 0:a.y)||0));for(let e=0;e<l.length;e+=2)c.addColorStop(l[e],l[e+1]);e.fillStyle=c}if("GRADIENT_RADIAL"===t){let{fillRadialGradientColorStops:l,fillRadialGradientStartPoint:s,fillRadialGradientEndPoint:d,fillRadialGradientStartRadius:c,fillRadialGradientEndRadius:h}=u(i,n,r,o,t),f=e.createRadialGradient(s.x+((null==a?void 0:a.x)||0),s.y+((null==a?void 0:a.y)||0),c,d.x+((null==a?void 0:a.x)||0),d.y+((null==a?void 0:a.y)||0),h);for(let e=0;e<l.length;e+=2)f.addColorStop(l[e],l[e+1]);e.fillStyle=f}}function u(e,t,i,n){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"GRADIENT_LINEAR",o=arguments.length>5?arguments[5]:void 0,{width:a,height:l}=e,s=[];for(let e of t)s.push(e.position,`rgba(${255*e.r}, ${255*e.g}, ${255*e.b}, ${e.a})`);let d=i[0]*a,c=i[1]*l,u=n[0]*a,h=n[1]*l,f=(null==o?void 0:o.x)||0,g=(null==o?void 0:o.y)||0;if("GRADIENT_RADIAL"===r){let e=Math.hypot(u-d,h-c);return{fillRadialGradientColorStops:s,fillRadialGradientStartPoint:{x:d-f,y:c-g},fillRadialGradientEndPoint:{x:d-f,y:c-g},fillRadialGradientStartRadius:0,fillRadialGradientEndRadius:e}}return{fillLinearGradientColorStops:s,fillLinearGradientStartPoint:{x:d-f,y:c-g},fillLinearGradientEndPoint:{x:u-f,y:h-g}}}n()}catch(e){n(e)}})},1433:function(e,t,i){i.a(e,async function(e,n){try{i.d(t,{P:()=>y});var r=i(97458),o=i(15849),a=i(57655),l=i(81949),s=i(11041),d=i(82465),c=i(42632),u=i(79988),h=i(35962),f=i(74288),g=i(48948),m=i(43755),p=e([h,m,u,l,d,a]);[h,m,u,l,d,a]=p.then?(await p)():p;class y extends o.b{canRender(e){return"vector_group"===e.type}canvasRender(e,t){(()=>{var i,n,r,o;let a=e.data.fillPaint??s.qF;if("IMAGE"===a.type&&a.visible){let i=a.imageUrl,o=(0,h.um)(i);if(!o)return(0,h.kE)(i).then(e=>{e&&((0,g.GX)(),(0,f.MC)())});let s=(0,l.eT)("sceneGraph").findById(e.id);if(!s)return;let c=s.getBooleanOperationPath(e.data.booleanOperation);if(!c)return;let u=c.map(e=>e.data).join(" "),{fTop:p,fLeft:y,fBottom:v,fRight:w}=d.Z.pathKit.FromSVGString(u).computeTightBounds(),x=(0,m.R1)({width:null==o?void 0:o.width,height:null==o?void 0:o.height},{width:w-y,height:v-p}),b=a.color??{r:0,g:0,b:0,a:1},E=a.visible?`rgba(${255*b.r},${255*b.g},${255*b.b},${null==(n=e.data.fillPaint)?void 0:n.opacity})`:"";if(null==E?void 0:E.length){t.save();let e=new Path2D(u);(0,m.i6)(t,o,x),t.fill(e,(null==(r=c[0])?void 0:r.windingRule)==="EVENODD"?"evenodd":"nonzero"),t.restore()}return}if(0===a.opacity||!a.visible)return;let c=(0,l.eT)("sceneGraph").findById(e.id);if(!c)return;let u=c.getBooleanOperationPath(e.data.booleanOperation);if(!u)return;let p=u.map(e=>e.data).join(" "),y=a.color??{r:0,g:0,b:0,a:1},v=a.visible?`rgba(${255*y.r},${255*y.g},${255*y.b},${null==(i=e.data.fillPaint)?void 0:i.opacity})`:"";if(null==v?void 0:v.length){t.save();let e=new Path2D(p);t.fillStyle=v,t.fill(e,(null==(o=u[0])?void 0:o.windingRule)==="EVENODD"?"evenodd":"nonzero"),t.restore()}})(),(()=>{let i=(0,u.Kl)("viewport").scale,n=(0,l.eT)("sceneGraph").findById(e.id);if(!n)return;let r=n.getBooleanOperationPath(e.data.booleanOperation);if(!r)return;let o=d.Z.pathKit,a=r.map(e=>e.data).join(" "),h=e.data.stroke??s.R$,f=h.color;if("CENTER"===h.strokePosition){t.save();let e=new Path2D(a);t.strokeStyle=h.visible?`rgba(${255*f.r},${255*f.g},${255*f.b},${h.opacity})`:"",t.lineWidth=h.strokeWidth,t.stroke(e),t.restore()}if("CENTER"!==h.strokePosition){let n="INSIDE"===h.strokePosition,r=o.FromSVGString(a).stroke({width:2*h.strokeWidth,miter_limit:10}),{fTop:l,fBottom:s,fLeft:d,fRight:u}=r.computeTightBounds(),f=(0,c.g)({x:n?0:d,y:n?0:l,width:n?e.width:u-d,height:n?e.height:s-l,data:r.toSVGString(),fillPath:a||""},e,h.strokePosition,i);t.save(),t.drawImage(f,n?0:d,n?0:l,n?e.width:u-d,n?e.height:s-l),t.restore()}})()}konvaRender(e){return(0,r.jsx)(a.Z,{element:e})}constructor(){super()}}n()}catch(e){n(e)}})},38978:function(e,t,i){i.a(e,async function(e,n){try{i.d(t,{Y:()=>g});var r=i(97458),o=i(15849),a=i(49604),l=i(97543),s=i(35962),d=i(74288),c=i(48948),u=i(43755),h=i(81949),f=e([h,s,u,a,l]);[h,s,u,a,l]=f.then?(await f)():f;class g extends o.b{canRender(e){return(0,h.eT)("sceneGraph").findById(e.id).isVector}canvasRender(e,t){(()=>{var i,n,r,o,a,l,h;let f=e.data.fillPaint;if((null==f||null==(i=f.type)?void 0:i.startsWith("GRADIENT"))&&f.gradient){null==(a=e.data.fillGeometry)||null==(o=a.forEach)||o.call(a,i=>{t.save(),(0,u.BC)(t,null==f?void 0:f.type,{width:e.width,height:e.height},f.gradient.stops,f.gradient.start,f.gradient.end);let n=new Path2D(i.data);t.fill(n),t.restore()});return}if("IMAGE"===f.type&&f.visible){let i=f.imageUrl,n=(0,s.um)(i);if(!n)return(0,s.kE)(i).then(e=>{e&&((0,c.GX)(),(0,d.MC)())});let r=(0,u.R1)({width:null==n?void 0:n.width,height:null==n?void 0:n.height},{width:e.width,height:e.height});return null==e||null==(h=e.data.fillGeometry)||null==(l=h.forEach)||l.call(h,e=>{t.save();let i=new Path2D(e.data);(0,u.i6)(t,n,r),t.fill(i),t.restore()})}if(0===f.opacity||!f.visible)return;let g=`rgba(${255*f.color.r},${255*f.color.g},${255*f.color.b},${f.opacity})`;null==(r=e.data.fillGeometry)||null==(n=r.forEach)||n.call(r,e=>{t.save();let i=new Path2D(e.data);t.fillStyle=g,t.fill(i),t.restore()})})(),(()=>{let i=e.data.stroke,n=i.color;if(i.visible&&i.strokeWidth>0&&i.opacity>0){let r=i.strokePosition.toUpperCase(),o=(0,a.Hz)(e,!0);if(o){t.save();let e=new Path2D(o);t.fillStyle=`rgba(${255*n.r},${255*n.g},${255*n.b},${i.opacity})`,t.fill(e,"CENTER"===r?"nonzero":"evenodd"),t.restore()}}})()}konvaRender(e){return(0,r.jsx)(l.Z,{element:e})}constructor(){super()}}n()}catch(e){n(e)}})},64384:function(e,t,i){i.a(e,async function(e,n){try{i.d(t,{e:()=>d});var r=i(97458),o=i(15849),a=i(43755),l=i(2529),s=e([a,l]);[a,l]=s.then?(await s)():s;class d extends o.b{canRender(e){return"video"===e.type}canvasRender(e,t){(async()=>{let i=e.coverUrl;await (0,a.f4)(t,i,0,0,e.width,e.height)})()}konvaRender(e){return(0,r.jsx)(l.Z,{element:e})}constructor(){super()}}n()}catch(e){n(e)}})},81042:function(e,t,i){i.a(e,async function(e,n){try{i.d(t,{eX:()=>P,wJ:()=>D});var r=i(52983),o=i(39378),a=i(80413),l=i(55887),s=i(35040),d=i(40340),c=i(33320),u=i(49605),h=i(21183),f=i(97389),g=i(33061),m=i(15394),p=i(81949),y=i(66969),v=i(92827),w=i(79988),x=i(98516),b=i(86043),E=i(31353),T=i(31179),k=i(98830),R=i(60147),S=e([y,v,c,m,w,T,p,h,b,x,f,E,R]);[y,v,c,m,w,T,p,h,b,x,f,E,R]=S.then?(await S)():S;let I=(0,a.F)()(()=>({isDragging:!1,isDragCopyStatus:!1,elementDataMap:null,dragElementInfo:[],effectedElementIds:[]})),{useStore:P,setState:A,getState:C}=(0,k.b)(I),D=()=>{let e=P("isDragCopyStatus"),t=(0,y.I9)("shift"),i=(0,y.I9)("alt"),n=(0,v.aV)("readyForSelectImage"),a=(0,w.eD)("currentCanvasTool"),k=(0,p.s0)(),S=P("dragElementInfo"),I=P("isDragging"),D=(0,r.useMemo)(()=>!!k,[k]);(0,r.useEffect)(()=>{document.addEventListener("keydown",e=>{"Alt"===e.key&&e.preventDefault()})},[]),(0,r.useEffect)(()=>{A({isDragCopyStatus:i&&(D||I)&&!n&&a===s.nX.select})},[t,i,D,n,a,I,S.length]),(0,r.useEffect)(()=>{let{dragElementInfo:t,elementDataMap:i,effectedElementIds:n}=C();if(!t.length||!I)return;let r=(0,w.Kl)("elements"),{elementMap:a}=(0,T._3)(r),l=t.map(e=>e.newElementId);if(!e)return void(0,c.removeElements)(l);let s=[];for(let e of t){let{parentId:t,index:n,newElementData:l,elementId:c}=e,f=(0,o.cloneDeep)(l);if(null===t){r.splice(n,0,f);continue}let g=null==i?void 0:i.get(t),m=a.get(t);if(m&&g){var u,h;if(g.type===d.Hd.ChatFrame){let e=g.data.sessions,i=m.data.sessions,r=e.find(e=>e.elementList.includes(c)),o=r?e.indexOf(r):-1,a=i.findIndex(e=>e.id===(null==r?void 0:r.id));if(-1!==o&&-1!==a){let e=r.elementList.indexOf(c);i[a].elementList.splice(e,0,f.id)}else i.splice(n,0,{...r,elementList:[f.id]});null==(h=m.elements)||h.splice(n,0,f),s.push(t);continue}null==(u=m.elements)||u.splice(n,0,f)}else r.splice(n,0,f)}n.forEach(e=>{g.U.add(e)}),(0,w.L$)({elements:[...r]}),(0,p.eT)("sceneGraph").syncFromProjectState(),s.length&&(0,m.Ht)(s)},[e,I]);let M=(0,r.useCallback)(()=>{let e=(0,w.Kl)("selection"),{dragElementInfo:t,effectedElementIds:i}=(0,T.Fy)(e),n=(0,w.Kl)("elements"),{elementMap:r}=(0,T._3)((0,o.cloneDeep)(n));A({isDragging:!0,dragElementInfo:t,effectedElementIds:i,elementDataMap:r})},[]),F=(0,r.useCallback)(async()=>{let e=C("isDragCopyStatus"),t=C("dragElementInfo"),i=C("effectedElementIds"),n=(0,p.eT)("sceneGraph");if(!e||!t.length)return void A({dragElementInfo:[],isDragging:!1});i.forEach(e=>{g.U.add(e)}),n.syncToProjectState(),n.syncFromProjectState(),t.forEach(e=>{let{elementId:t,newElementId:i}=e;(0,h.PB)(t,i)}),n.syncToProjectState(),n.syncFromProjectState();let r=t.map(e=>{let{newElementId:t}=e,i=(0,x.rI)(t);if(i)return{elementId:t,partialElement:{title:(e=>{if(!e)return e;let t=e.match(/^(.*?)(?:\s(拷贝)(?:\s(\d+))?)?$/),i=e.match(/^(.*?)(?:\s(copy)(?:\s(\d+))?)?$/);if(!t&&!i)return e;let[,n,r,o]=t.filter(Boolean).length>i.filter(Boolean).length?t:i,a=l.lJ?"copy":"拷贝";if(!o&&!e.endsWith(r))return`${n} ${a}`;{let e=o?parseInt(o,10)+1:2;return`${n} ${r} ${e}`}})(i.title)}}});(0,b.OV)(r);let o=t.map(e=>{let{newElementId:t}=e;return(0,x.rI)(t)});(0,f.iM)(o),A({dragElementInfo:[],isDragging:!1});let a=t.map(e=>{let{newElementId:t}=e;return t});(0,E.e3)(a),o.length>0&&u.z.emit("elements:created",o)},[]);(0,r.useEffect)(()=>(u.z.on("selection:dragStart",M),u.z.on("selection:dragEnd",F),()=>{(0,R.Zr)()&&(u.z.off("selection:dragStart",M),u.z.off("selection:dragEnd",F))}),[])};n()}catch(e){n(e)}})},82275:function(e,t,i){i.a(e,async function(e,n){try{i.d(t,{P:()=>p});var r=i(77211),o=i(33320),a=i(79988),l=i(17459),s=i(63618),d=i(72985),c=i(82730),u=i(51428),h=i(52983),f=i(21183),g=i(9867),m=e([o,a,s,f]);[o,a,s,f]=m.then?(await m)():m;let p=()=>{let e=(0,h.useCallback)(e=>{if((0,g.IG)("editorId"))return;e.preventDefault();let t=(0,a.Kl)("elements").map(e=>e.id).filter(Boolean);(0,o.updateSelection)(t,{__keepTracking:!0})},[]),t=(0,h.useCallback)(e=>{e.preventDefault();let t=(0,a.Kl)("selection"),i=(0,a.Kl)("elements").filter(e=>t.includes(e.id)&&"image"===e.type);if(0===i.length)return;let n={eid:(0,l.c)(),medium:u.NZ.HotKey_Export,action_type:u.bk.Export,batch_export:+(i.length>1),image_ids:i.map(e=>null==e?void 0:e.innerImageId).filter(Boolean),group_ids:i.map(e=>{var t;return null==e||null==(t=e.data)?void 0:t.groupId}).filter(Boolean),image_urls:i.map(e=>null==e?void 0:e.url).filter(Boolean),image_cnt:i.length,...(0,s.s5)(i)};c.c2.exportClickReport(n),(0,r.nH)({opened:!0,reportParams:n})},[]);(0,d.A)([["mod + a",e],["mod+alt+s",t],["[",()=>{(0,f.tt)()}],["]",()=>{(0,f.G$)()}],["mod+[",()=>{(0,f.gv)()}],["mod+]",()=>{(0,f.N1)()}]],["INPUT","TEXTAREA"])};n()}catch(e){n(e)}})},15220:function(e,t,i){i.d(t,{q:()=>a});var n=i(97458);i(52983);let r=e=>(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:160,height:128,className:"discord_svg__icon",viewBox:"0 0 1280 1024",...e,children:(0,n.jsx)("path",{fill:"#636ae1",d:"M1049.062 139.672a3 3 0 0 0-1.528-1.4A970.1 970.1 0 0 0 808.162 64.06a3.63 3.63 0 0 0-3.846 1.82 675 675 0 0 0-29.8 61.2 895.7 895.7 0 0 0-268.852 0 619 619 0 0 0-30.27-61.2 3.78 3.78 0 0 0-3.848-1.82 967.4 967.4 0 0 0-239.376 74.214 3.42 3.42 0 0 0-1.576 1.352C78.136 367.302 36.372 589.38 56.86 808.708a4.03 4.03 0 0 0 1.53 2.75 975.3 975.3 0 0 0 293.65 148.378 3.8 3.8 0 0 0 4.126-1.352A696.4 696.4 0 0 0 416.24 860.8a3.72 3.72 0 0 0-2.038-5.176 642.4 642.4 0 0 1-91.736-43.706 3.77 3.77 0 0 1-.37-6.252 502 502 0 0 0 18.218-14.274 3.64 3.64 0 0 1 3.8-.512c192.458 87.834 400.82 87.834 591 0a3.62 3.62 0 0 1 3.848.466 469 469 0 0 0 18.264 14.32 3.768 3.768 0 0 1-.324 6.252 603 603 0 0 1-91.78 43.66 3.75 3.75 0 0 0-2 5.222 782 782 0 0 0 60.028 97.63 3.73 3.73 0 0 0 4.126 1.4A972.1 972.1 0 0 0 1221.4 811.458a3.76 3.76 0 0 0 1.53-2.704c24.528-253.566-41.064-473.824-173.868-669.082M444.982 675.16c-57.944 0-105.688-53.174-105.688-118.478S386.112 438.2 444.982 438.2c59.33 0 106.612 53.64 105.686 118.478 0 65.308-46.82 118.482-105.686 118.482m390.76 0c-57.942 0-105.686-53.174-105.686-118.478S776.874 438.2 835.742 438.2c59.334 0 106.614 53.64 105.688 118.478 0 65.308-46.354 118.482-105.688 118.482"})});var o=i(70853);let a=()=>(0,n.jsx)("a",{href:o.V,target:"_blank",rel:"noreferrer",children:(0,n.jsxs)("div",{className:"flex items-center gap-1 rounded-lg px-3 py-[5px] font-semibold hover:bg-[#F2F3F5] active:bg-[#E5E6EC]",children:[(0,n.jsx)(r,{className:"h-[18px] w-[18px]"}),(0,n.jsx)("span",{className:"text-[12px]",children:"Discord"})]})})},44349:function(e,t,i){i.a(e,async function(e,n){try{i.d(t,{C:()=>d});var r=i(23006),o=i(18370),a=i(1232),l=i(621),s=e([l]);l=(s.then?(await s)():s)[0];let d=[{key:"zoomIn",label:(0,r.Iu)("common_zoom_in"),handleClick:()=>{localStorage.getItem("hotkeys_shown")||(o.YB.emit("event_request_open_hotkeys"),localStorage.setItem("hotkeys_shown","1")),l.viewportActions.zoomIn()},hotkeyName:a.t.ZoomIn},{key:"zoomOut",label:(0,r.Iu)("common_zoom_out"),handleClick:()=>l.viewportActions.zoomOut(),hotkeyName:a.t.ZoomOut},{key:"zoomReset",label:(0,r.Iu)("common_zoom_reset"),handleClick:()=>l.viewportActions.fitView(),hotkeyName:a.t.ZoomToFit},{key:"zoomTo50",value:50,label:(0,r.Iu)("common_zoom_to_50"),handleClick:()=>l.viewportActions.zoomTo(.5,l.ZoomToOrigin.ScreenCenter)},{key:"zoomTo100",value:100,label:(0,r.Iu)("common_zoom_to_100"),handleClick:()=>l.viewportActions.zoomReset("screen-center"),hotkeyName:a.t.ZoomTo100},{key:"zoomTo200",value:200,label:(0,r.Iu)("common_zoom_to_200"),handleClick:()=>l.viewportActions.zoomTo(2,l.ZoomToOrigin.ScreenCenter)}];n()}catch(e){n(e)}})},6453:function(e,t,i){i.a(e,async function(e,n){try{i.d(t,{p:()=>y});var r=i(97458),o=i(52983),a=i(60109),l=i(66338),s=i(94698),d=i(39378),c=i(23006),u=i(77455),h=i(58762),f=i(621),g=i(44349);i(35607);var m=e([f,g,h]);[f,g,h]=m.then?(await m)():m;let p=(0,d.debounce)(e=>{let t=Math.round(Number(e)||2);t=(t<2?2:t)/100,f.viewportActions.zoomTo(t,f.ZoomToOrigin.ScreenCenter)},500),y=()=>{let e=(0,f.useViewport)(),[t,i]=(0,o.useState)(!1),n=(100*e.scale).toFixed(0),d=(0,o.useCallback)((e,t)=>{let{handleClick:n,clickHide:r}=t||{};r?i(!1):null==e||e.stopPropagation(),"function"==typeof n&&n(t)},[]),m=(0,o.useMemo)(()=>{let e=[{key:"customInput",className:"no-hover custom-input-item",label:(0,r.jsx)("div",{onClick:e=>e.stopPropagation(),className:"menu-font rounded-md",children:(0,r.jsx)(a.Z,{min:"2",max:"200",value:n,defaultValue:n,className:"h-8 w-full",placeholder:(0,c.Iu)("请输入画布缩放数值"),suffix:"%",controls:!1,onChange:p})})}],t=g.C.map(e=>({key:e.key,label:(0,r.jsxs)("div",{className:"menu-font flex h-8 items-center justify-between rounded-md",onClick:t=>d(t,e),children:[(0,r.jsx)("span",{className:"text-[#2F3640]",children:e.label}),e.hotkeyName&&(0,r.jsx)(h.q,{hotkeyName:e.hotkeyName})]})}));return[...e,...t]},[n,d]);return(0,r.jsx)(l.ZP,{theme:{token:{controlPaddingHorizontal:0},components:{Dropdown:{paddingBlock:0}}},children:(0,r.jsx)(s.Z,{menu:{items:m,className:"menu-shadow"},trigger:["hover"],onOpenChange:e=>{i(e)},open:t,overlayClassName:"w-[180px] small-dropdown-root custom-dropdown-menu",children:(0,r.jsxs)("div",{className:"menu-font flex min-w-[72px] cursor-pointer items-center justify-between rounded-md bg-[#F2F3F5] px-3 py-[6px]",children:[(0,r.jsxs)("span",{children:[n,"%"]}),(0,r.jsx)(u.Z,{})]})})})};n()}catch(e){n(e)}})},54478:function(e,t,i){i.d(t,{e:()=>n});let n={MIN_HOVER_SIZE:35,HOVER_BORDER:10,HOVER_ANCHOR:16,HOVER_ROTATION:22,HOVER_ROTATION_DIFF:6}},13576:function(e,t,i){i.a(e,async function(e,n){try{i.d(t,{Q3:()=>f,St:()=>h,W5:()=>u,d3:()=>c});var r=i(40340),o=i(10124),a=i(48797),l=i(12634),s=i.n(l),d=e([o,a]);[o,a]=d.then?(await d)():d;let g=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=new Map,r=(e,t,i)=>{e.forEach(e=>{n.set(e.id,{self:e,parentId:t,level:i}),e.elements&&e.elements.length>0&&r(e.elements,e.id,i+1)})};return r(e,t,i),n};function c(e){if(0===e.length)return{x:0,y:0,width:0,height:0};let t=1/0,i=1/0,n=-1/0,r=-1/0;return e.forEach(e=>{let{x:o,y:a,width:l,height:s,scaleX:d,scaleY:c}=e;t=Math.min(t,o),i=Math.min(i,a),n=Math.max(n,o+l*d),r=Math.max(r,a+s*c)}),{x:t,y:i,width:n-t,height:r-i}}function u(e,t){return e.forEach(e=>{e.x=e.x-t.x,e.y=e.y-t.y}),e}function h(e){let{title:t,name:i}=(0,o.o)(r.Hd.Group),{x:n,y:l,width:d,height:h}=c(e);return(0,a.v)({id:`element-group-${s()()}`,key:`element-group-key-${s()()}`,type:r.Hd.Group,name:i,title:t,elements:u(e,{x:n,y:l}),x:n,y:l,width:d,height:h})}function f(e){let t=!0,i=0;for(;t&&i<100;){t=!1,i++;let n=g(e),o=[];for(let[e,t]of n){let{self:i,parentId:n,level:a}=t;i.type===r.Hd.Group&&i.elements&&0===i.elements.length&&o.push({id:e,parentId:n,level:a})}for(let{id:i,parentId:r}of(o.sort((e,t)=>t.level-e.level),o)){let o=r&&n.has(r)?n.get(r).self.elements:e,a=o.findIndex(e=>e.id===i);-1!==a&&(o.splice(a,1),t=!0)}}return e}n()}catch(e){n(e)}})},59815:function(e,t,i){i.a(e,async function(e,n){try{i.d(t,{Y:()=>e});var r=i(17459),o=i(40340);let e=e=>({id:`element-${(0,r.c)(o.Hd.Image)}`,width:e.width,height:e.height,url:e.url,scaleMode:e.scaleMode,imageTransform:e.imageTransform,scaleX:e.scaleX||1,scaleY:e.scaleY||1,type:o.Hd.Image,opacity:e.opacity,tint:e.tint,saturation:e.saturation,shadows:e.shadows,highlights:e.highlights,exposure:e.exposure,temperature:e.temperature,contrast:e.contrast});n()}catch(e){n(e)}})},7465:function(e,t,i){i.a(e,async function(e,n){try{i.d(t,{d:()=>v});var r=i(40340),o=i(23006),a=i(10124),l=i(13576),s=i(12634),d=i.n(s),c=i(79988),u=i(98516),h=i(81949),f=i(11041),g=i(67126),m=i(39378),p=i(20132),y=e([p,c,h,u,a,l]);[p,c,h,u,a,l]=y.then?(await y)():y;let w=e=>{for(let t of e.toReversed()){if(t.type===r.Hd.Group){let e=w(t.elements);if(e)return e}if(p.xJ[t.type])return t}};function v(e){let t=(0,c.Kl)("selection");1===t.length&&t[0].startsWith("element-group-")&&(t=(0,h.eT)("sceneGraph").findById(t[0]).children.map(e=>e.id));let i=(0,h.eT)("sceneGraph"),n=t.map(e=>(0,u.rI)(e)),{name:s}=(0,a.o)(r.Hd.VectorGroup),p=(0,o.Iu)(e),{x:y,y:v,width:x,height:b}=(0,l.d3)(n),E=(0,l.W5)(n,{x:y,y:v}),T=i.findById(w(n).id),k=T.type===r.Hd.Text?T.originElement.richData.style.fillPaints[0]:T.fillPaint,R=(0,m.cloneDeep)(f.qF);k&&"mix"!==k&&!1!==k.visible&&k.opacity>0?R=(0,m.cloneDeep)(k):(null==T?void 0:T.strokePaint)&&(R=(0,m.cloneDeep)(T.strokePaint)),void 0===R.visible&&(R.visible=!0);let S={id:`element-vector_group-${d()()}`,key:`element-vector_group-key-${d()()}`,type:r.Hd.VectorGroup,elements:E,name:s,title:p,x:y,y:v,width:x,height:b,data:{booleanOperation:e,fillPaint:R,stroke:{...(0,m.cloneDeep)(f.qF),strokeWidth:1,strokePosition:g.R.Center}}};return T.effects&&(S.effects=T.effects),S}n()}catch(e){n(e)}})},18539:function(e,t,i){i.a(e,async function(e,n){try{i.d(t,{J:()=>d,v:()=>s});var r=i(4925),o=i(64258),a=i(71873),l=e([a,o]);[a,o]=l.then?(await l)():l;let c={};function s(e,t){var i,n;let{run_mode:o="run",medium:l="click",original_thread_id:s=""}=t||{},d=(0,a.J)({runMode:o,medium:l});if(!d)return;let u=((null==(i=c[e])?void 0:i.eid)===void 0&&(c[e]={eid:`${e}-${+new Date}`}),null==(n=c[e])?void 0:n.eid);(0,r.mc)("agent.tab.chat.run.start",{run_mode:o,eid:u,messages:d,thread_id:e,original_thread_id:s}),function(e,t){let i=c[e];if(!(null==i?void 0:i.eid))return;let n={...i,param:t};c[e]=n,c[e]}(e,{run_mode:o,eid:u,messages:d,thread_id:e,original_thread_id:s})}function d(e){let t=c[e];if(!(null==t?void 0:t.eid)||!(null==t?void 0:t.param))return;delete c[e];let i=(0,o.g8)(e);if(!i)return;let n=(0,o.CJ)(null==i?void 0:i.session);(0,r.mc)("agent.tab.chat.run.end",{...t.param,thread_id:e,latest_action_id:i.action_id,cost_time:i.prompt_commit_past_time,da_output_objects:n}),(null==n?void 0:n.length)||(0,r.mc)("agent.tab.chat.run.failed",{...t.param,cost_time:i.prompt_commit_past_time})}n()}catch(e){n(e)}})},74858:function(e,t,i){i.a(e,async function(e,n){try{i.d(t,{Z:()=>d});var r=i(97458),o=i(52983),a=i(55887),l=i(84768),s=e([l]);l=(s.then?(await s)():s)[0];let d=(0,o.memo)(function(e){let{title:t,titleStyle:i={maxWidth:"calc(100% - 190px)"},rightButton:n}=e,o=(0,l.XJ)();return(0,r.jsx)("div",{id:"agent-chat-title",className:"absolute left-0 top-0 z-20 flex min-h-[60px] w-full items-center justify-between pl-4",style:{background:o?void 0:"rgba(255, 255, 255, 0.9)",backdropFilter:"blur(40px)"},children:!(a.lJ&&o)&&t&&(0,r.jsxs)("div",{className:"flex h-7 w-full flex-1 items-center gap-1 font-[Poppins] text-sm font-medium leading-[160%] text-[#0C0C13]",children:[(0,r.jsx)("div",{className:"inline-block min-w-3 whitespace-nowrap",style:i,children:(0,r.jsx)("p",{className:"overflow-hidden text-ellipsis font-[Poppins] text-sm font-medium",children:t})}),n]})})});n()}catch(e){n(e)}})},26358:function(e,t,i){i.a(e,async function(e,n){try{i.d(t,{AC:()=>E,Hv:()=>w,P:()=>T,SU:()=>p,UZ:()=>x,_W:()=>y,eP:()=>m,ot:()=>v,tk:()=>b});var r=i(35519),o=i(41845),a=i(28943),l=i(33320),s=i(4521),d=i(621),c=i(98516),u=i(75644),h=i(89691),f=e([h,c,l,d,a]);function g(){let{taskMap:e}=(0,h.lz)();return e||{}}function m(){let e=g();return Object.values(e).filter(Boolean)}function p(e){let t=g();return null==t?void 0:t[e]}function y(e,t){let i=g();(0,h.ou)({taskMap:{...i,[e]:{...null==i?void 0:i[e],...t}}})}function v(e){let t=g();if(!(null==t?void 0:t[e]))return;let i={...t};delete i[e],(0,h.ou)({taskMap:i})}function w(e,t,i){let{width:n=o.qx,height:r=o.vP,count:a=1,x:l=0,y:s=0,type:c,...f}=t??{};var m={...f,id:e,type:c,x:l,y:s,width:n,height:r,count:a,status:u.h.Pending,progress:0,results:[]};let p=g();(0,h.ou)({taskMap:{...p,[e]:m}}),i&&d.viewportActions.locateRect({x:l,y:s,width:n*a+(a-1)*o.bp,height:r,scaleX:1,scaleY:1},{animate:!0,fitView:!0})}function x(e){let t=p(e);if(t)switch(null==t?void 0:t.status){case u.h.Pending:y(e,{status:u.h.Queueing,progress:0});break;case u.h.Queueing:y(e,{status:u.h.Generating,progress:30});break;case u.h.Generating:y(e,{status:u.h.Generating,progress:80});break;case u.h.CanvasIdle:break;default:y(e,{status:u.h.Pending,progress:0})}}function b(e,t){if(p(e))return;let{elements:i,position:n="right",contours:r=null,threadId:u}=t,h=i.length>1,f=null==i?void 0:i[0],g={};if(u&&(g.threadId=u),f){let{x:e,y:t}=(0,c.to)(f),{width:i,height:n,scaleX:r=1,scaleY:o=1}=f;g.width=i*r,g.height=n*o,g.x=e,g.y=t,g.layoutElementId=f.id}switch(n){case"right":g.x=g.x+g.width+o.bp,g.animation=!0,g.startX=f.x,g.startY=f.y,g.layoutElementId=void 0,g.originalImageElementId=f.id,g.sourceElementId=f.id,g.type=s.RN.TabEditSingle;break;case"original":(0,l.moveElementWithAnimate)(f.id,{x:f.x+f.width+o.bp,y:f.y}),g.type=s.RN.TabEditFrame,g.layoutElementId=void 0,g.sourceElementId=f.id;break;case"auto":{let{x:e,y:t}=(0,a.st)();g.x=e,g.y=t,g.width=1080,g.height=1080,g.type=s.RN.TabEditSingle,d.viewportActions.locateRect({x:e,y:t,width:1080,height:1080,scaleX:1,scaleY:1},{animate:!0,fitView:!0});break}default:g.type=s.RN.TabEditSingle}if((null==r?void 0:r.length)>0&&(g.contours=r,g.type=s.RN.TabEditSelection),h){let{x:e=0,y:t=0}=(0,a.js)(i);g.x=e,g.y=t-o.vP,g.width=o.qx,g.height=o.vP,g.type=s.RN.TabEditMulti}w(e,g,h)}function E(e){if(!(null==e?void 0:e.threadId))return;let{groupId:t,message:i,name:n}=e,o=(0,r.fg)(n);switch(null==o?void 0:o.loading){case r.M7.IMAGE:case r.M7.VIDEO:case r.M7.AUDIO:i.id}}function T(e){if(!(null==e?void 0:e.threadId))return;let{groupId:t,message:i}=e;i.id}[h,c,l,d,a]=f.then?(await f)():f,n()}catch(e){n(e)}})},10057:function(e,t,i){i.a(e,async function(e,n){try{i.d(t,{F:()=>a});var r=i(89691),o=e([r]);function a(){let e=(0,r.EW)(e=>e.taskMap)||{};return Object.values(e).filter(Boolean)}r=(o.then?(await o)():o)[0],n()}catch(e){n(e)}})},86423:function(e,t,i){i.a(e,async function(e,n){try{i.d(t,{Y:()=>x});var r=i(52983),o=i(752),a=i.n(o),l=i(81949),s=i(9867),d=i(79988),c=i(59824),u=i(11041),h=i(60542),f=i(42632),g=i(82465),m=i(73661),p=i(76145),y=i(35962),v=i(43755),w=e([d,y,g,v,l]);[d,y,g,v,l]=w.then?(await w)():w;let x=e=>{let t=(0,r.useRef)(null),[,i]=(0,r.useReducer)(e=>e+1,0),n=(0,s.qQ)("isInitVectorEditor"),o=(0,d.eD)("selection"),w=(0,c.Q2)("groupRenderDep"),x=(0,s.qQ)("groupRenderDep"),b=(0,h.rq)("groupRenderDep"),E=(0,h.rq)("editorRenderDep"),T=(0,h.rq)("editor")&&n,k=(0,m.BZ)("strokeDep"),R=(0,c.Q2)("imageLoadDep"),S=()=>{var n,r,o,s,d,h;let m=t.current;m.destroyChildren();let w=(0,l.eT)("sceneGraph").findById(e.id);if(!w)return;let x=w.getBooleanOperationPath(e.data.booleanOperation);if(!x)return;let b=g.Z.pathKit,E=x.map(e=>e.data).join(" "),T=e.data.fillPaint??u.qF,k=T.color??{r:0,g:0,b:0,a:1},R=e.data.stroke??u.R$,S=R.color,I=b.FromSVGString(E),{fTop:P,fLeft:A,fBottom:C,fRight:D}=I.computeTightBounds();if(I.delete(),(null==T||null==(n=T.type)?void 0:n.startsWith("GRADIENT"))&&T.gradient){let e=(0,v.WZ)({width:D-A,height:C-P},T.gradient.stops,T.gradient.start,T.gradient.end,T.type,{x:-A,y:-P}),t=new(a()).Path({id:"vector-fillpath",data:E,...e,fillRule:(null==(r=x[0])?void 0:r.windingRule)==="EVENODD"?"evenodd":"nonzero",listening:!1});m.add(t)}else if("IMAGE"===T.type){let e=T.imageUrl;if(e){let t=(0,y.um)(e);if(!t)return void(0,y.kE)(e).then(e=>{e&&(0,c.ik)({imageLoadDep:!(0,c.I)("imageLoadDep")})});{let{fTop:e,fLeft:i,fBottom:n,fRight:r}=g.Z.pathKit.FromSVGString(E).computeTightBounds(),o=(0,v.R1)({width:null==t?void 0:t.width,height:null==t?void 0:t.height},{width:r-i,height:n-e}),l=new(a()).Path({id:"vectorgroup-fillpath",data:E,fillPatternX:i,fillPatternY:e,fillPatternImage:t,fillPatternRepeat:"no-repeat",fillPatternOffset:{x:o.offsetX,y:o.offsetY},fillPatternScale:{x:o.scale,y:o.scale},fillRule:(null==(s=x[0])?void 0:s.windingRule)==="EVENODD"?"evenodd":"nonzero",listening:!1,stroke:R.visible?`rgba(${255*S.r},${255*S.g},${255*S.b},${R.opacity})`:"",strokeWidth:"CENTER"===R.strokePosition?R.strokeWidth:0});m.add(l)}}else{let e=(0,p.z)(),t=new(a()).Path({id:"vectorgroup-fillpath",data:E,fillPatternImage:e,fillPatternRepeat:"repeat",fillRule:(null==(o=x[0])?void 0:o.windingRule)==="EVENODD"?"evenodd":"nonzero",listening:!1,stroke:R.visible?`rgba(${255*S.r},${255*S.g},${255*S.b},${R.opacity})`:"",strokeWidth:"CENTER"===R.strokePosition?R.strokeWidth:0});m.add(t)}}else{let t=T.visible?`rgba(${255*k.r},${255*k.g},${255*k.b},${null==(d=e.data.fillPaint)?void 0:d.opacity})`:"",i=new(a()).Path({id:"vector-path",data:E,fill:t,stroke:R.visible?`rgba(${255*S.r},${255*S.g},${255*S.b},${R.opacity})`:"",strokeWidth:"CENTER"===R.strokePosition?R.strokeWidth:0,fillRule:(null==(h=x[0])?void 0:h.windingRule)==="EVENODD"?"evenodd":"nonzero",listening:!1});m.add(i)}if("CENTER"!==R.strokePosition){let t="INSIDE"===R.strokePosition,i=b.FromSVGString(E).stroke({width:2*R.strokeWidth,miter_limit:10}),{fTop:n,fBottom:r,fLeft:o,fRight:l}=i.computeTightBounds(),s=(0,f.g)({x:t?0:o,y:t?0:n,width:t?e.width:l-o,height:t?e.height:r-n,data:i.toSVGString(),fillPath:E||""},e,R.strokePosition),d=new(a()).Image({x:t?0:o,y:t?0:n,width:t?e.width:l-o,height:t?e.height:r-n,image:s,listening:!1});m.add(d)}i()};return(0,r.useEffect)(()=>{T&&S()},[T,R]),(0,r.useEffect)(()=>{if(!T)return;let t=(0,l.eT)("sceneGraph"),i=o.map(e=>t.findById(e)),n=t.findById(e.id),r=(0,s.IG)("editorId");(r&&t.findById(r).getVectorGroupParents().includes(n)||i.some(t=>t.hasDescendantWithId(e.id,!0)||t.getVectorGroupParents().includes(n)))&&S()},[w,T,x,b,E,k]),t};n()}catch(e){n(e)}})},20132:function(e,t,i){i.a(e,async function(e,n){try{i.d(t,{Dx:()=>m,ly:()=>c,xJ:()=>g});var r=i(49604),o=i(81949),a=i(77596),l=i(82465),s=i(40340),d=e([r,a,l,o]);[r,a,l,o]=d.then?(await d)():d;let f=e=>{switch(e){case s.v0.Union:return l.Z.pathKit.PathOp.UNION;case s.v0.Subtract:return l.Z.pathKit.PathOp.DIFFERENCE;case s.v0.Intersection:return l.Z.pathKit.PathOp.INTERSECT;case s.v0.Exclude:return l.Z.pathKit.PathOp.XOR}},g={[s.Hd.Vector]:h,[s.Hd.ShapeCircle]:u,[s.Hd.ShapeSquare]:u,[s.Hd.ShapePolygon]:u,[s.Hd.ShapeStar]:u,[s.Hd.Text]:function(e){let t=e.originElement,i=t.richData.derivedTextData.glyphs,n=l.Z.pathKit,r=n.NewPath(),o=e.strokePaint,a=e.stroke,s=!1,d=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=n.NewPath(),{textData:o}=t.richData,{characterStyleIDs:a,styleOverrideTable:l}=o,d=t.richData.style.fillPaints;return i.forEach((t,i)=>{if(a&&e){var o,c;let e=(o=a[i],0===o?d[0]:(null==(c=l.find(e=>e.styleID===o))?void 0:c.fillPaints[0])||d[0]);if(!(e&&"mix"!==e&&!1!==e.visible&&e.opacity>0))return}s=!0;let{commandsBlob:u,position:h}=t,f=n.FromSVGString(u);f.transform(1,0,h.x,0,1,h.y,0,0,1),r.addPath(f),f.delete()}),r};if(0===i.length)return null;let c=o&&"mix"!==o&&!1!==o.visible&&o.opacity>0&&a.strokeWeight>0,u=d(!0);if(s||u.delete(),!s&&!c)return null;if(s&&(r.addPath(u),u.delete()),c&&!(s&&"INSIDE"===a.strokeAlign)){let e=d(),t=n.NewPath(e).stroke({width:"CENTER"===a.strokeAlign?a.strokeWeight:2*a.strokeWeight,miter_limit:10});if("CENTER"!==a.strokeAlign){let i="INSIDE"===a.strokeAlign?n.PathOp.INTERSECT:n.PathOp.DIFFERENCE;if(t=n.MakeFromOp(t,e,i),s){let e=n.MakeFromOp(t,r,n.PathOp.UNION);r.delete(),t.delete(),r=e}else r.delete(),r=t}else r.addPath(t),t.delete()}return r},[s.Hd.VectorGroup]:h};function c(e,t){let i=[],n=(0,o.eT)("sceneGraph"),r=(e,t)=>e.forEach(e=>{let o=n.findById(e.id),a=o.getLocalTransformMatrix(),l=t?a.multiply(t):a;if(e.type===s.Hd.Group)return void r(e.children,l);let d=g[e.type];if(!d)return;let c=d(o);if(c){let[e,t,n,r,o,a]=l.getMatrix();c.transform(e,n,o,t,r,a,0,0,1),i.push(c)}});return r(e),0!==i.length&&(1===i.length?i[0]:function(e,t){let i=e,n=l.Z.pathKit;for(;i.length>1;){i=[];for(let r=0;r<e.length;r++){let o=e[r],a=e[r+1];if(o&&a){let e=f(t);i.push(n.MakeFromOp(o,a,e)),o.delete(),a.delete()}o&&!a&&i.push(o),r++}e=i}return i[0]}(i,t))}function u(e){let t=[],i=e.fillPaint,n=e.stroke,o=e.strokePaint,a=l.Z.pathKit;if(i&&"mix"!==i&&!1!==i.visible&&i.opacity>0){let i=e.fillGeometry.map(e=>e.data).join(""),n=a.FromSVGString(i);t.push(n)}if(o&&"mix"!==o&&!1!==o.visible&&o.opacity>0&&n.strokeWeight>0){let i=(0,r.z$)(e.originElement);t.push(i)}if(0===t.length)return null;if(1===t.length)return t[0];if(2===t.length){let e=t[0],i=t[1];return e.addPath(i),i.delete(),e}}function h(e){let t=[],i=e.fillPaint,n=e.strokePaint,r=e.stroke,o=l.Z.pathKit;if(i&&"mix"!==i&&i.visible&&i.opacity>0){var d;e.type===s.Hd.VectorGroup?e.getBooleanOperationPath():e.type===s.Hd.Vector&&(0,a._8)(e.originElement),(null==(d=e.originElement)?void 0:d.data.fillGeometry).forEach(e=>{let i=o.FromSVGString(e.data),n="EVENODD"===e.windingRule?o.FillType.EVENODD:o.FillType.WINDING;i.setFillType(n),t.push(i)})}if(n&&"mix"!==n&&n.visible&&n.opacity>0&&r.strokeWeight>0&&"INSIDE"!==r.strokeAlign){e.type===s.Hd.VectorGroup&&0===t.length&&e.getBooleanOperationPath();let i=e.type===s.Hd.VectorGroup?(0,a.r5)(e.originElement):(0,a.Hz)(e.originElement);t.push(i)}if(0===t.length)return null;if(1===t.length)return t[0];if(t.every(e=>e.getFillType().value===t[0].getFillType().value))return t.forEach((e,i)=>{0!==i&&(t[0].addPath(e),e.delete())}),t[0];{let e=o.NewPath(),i=o.NewPath();return e.setFillType(o.FillType.EVENODD),i.setFillType(o.FillType.WINDING),t.forEach(t=>{t.getFillType().value===o.FillType.EVENODD.value?e.addPath(t):i.addPath(t),t.delete()}),o.MakeFromOp(e,i,o.PathOp.UNION)}}let m=e=>{if(1===e.length&&e[0].startsWith("element-vector_group-"))return!0;let t=(0,o.eT)("sceneGraph"),i=0,n=0,r=e=>e.forEach(e=>{let o=t.findById(e);g[o.type]?i++:o.type!==s.Hd.Group&&n++,o.type===s.Hd.Group&&r(o.children.map(e=>e.id))});return r(e),i>1&&0===n};n()}catch(e){n(e)}})},59824:function(e,t,i){i.d(t,{I:()=>l,Q2:()=>o,ik:()=>a});var n=i(98830);let r=(0,i(80413).F)()(()=>({groupRenderDep:!1,imageLoadDep:!1})),{useStore:o,setState:a,getState:l}=(0,n.b)(r)},11701:function(e,t,i){i.d(t,{AP:()=>s,FL:()=>n,Rf:()=>r,mo:()=>l,wk:()=>o,zE:()=>a});let n=1024,r=1024,o=200,a=200,l=1024,s=1024},50016:function(e,t,i){i.a(e,async function(e,n){try{i.d(t,{b:()=>f});var r=i(52983),o=i(40340),a=i(79988),l=i(86043),s=i(31179),d=i(11701),c=i(81949),u=i(19367),h=e([a,u,c,s,l]);function f(){let e=(0,a.eD)("elements"),t=(0,u.X)(),i=(0,c.Uq)("stage"),n=(0,r.useMemo)(()=>{let{elementList:t}=(0,s._3)(e);return t.filter(e=>e.type===o.Hd.ChatTaskPlaceholder)},[e]);(0,r.useEffect)(()=>{if(!i)return;let e=[];n.forEach(i=>{let n,{threadId:r,processing:o}=i.data,a=t.find(e=>e.threadId===r);a&&(i.width!==d.mo||i.height!==d.AP)?n={elementId:i.id,partialElement:{width:d.mo,height:d.AP}}:a||i.width===d.wk&&i.height===d.zE||(n={elementId:i.id,partialElement:{width:d.wk,height:d.zE}}),(!!o!=!!a||!!a!==i.visible)&&(n={elementId:i.id,partialElement:{...null==n?void 0:n.partialElement,visible:!!a,data:{...i.data,processing:!!a}}}),n&&e.push(n)}),e.length&&(0,l.OV)(e)},[i,n,t])}[a,u,c,s,l]=h.then?(await h)():h,n()}catch(e){n(e)}})},15624:function(e,t,i){i.a(e,async function(e,n){try{i.d(t,{h:()=>w});var r=i(52983),o=i(39378),a=i(91278),l=i(49605),s=i(79988),d=i(31179),c=i(55147),u=i(23720),h=i(15394),f=i(40340),g=i(11701),m=i(50016),p=i(81949),y=i(72931),v=e([u,m,s,y,d,p,h,c]);function w(){(0,u.Z)(),(0,m.b)();let e=(0,r.useRef)(null),t=(0,r.useRef)([]),i=(0,r.useCallback)(()=>{let e=(0,c.R5)("dragNodeIds"),t=(0,p.eT)("sceneGraph"),i=e.map(e=>t.findById(e)),n=i.map(e=>null==e?void 0:e.parent),r=new Set(n);if(1!==r.size)return null;let o=i[0].parent;return"chat_frame"!==o.type?null:o},[]),n=(0,r.useCallback)((e,i,n,r,o)=>{let a=(0,p.eT)("sceneGraph").findById(e);if(!a)return;let l=o??{minSize:(0,c.R5)("minSize")};(0,h.PW)(a,i,n,r,l),t.current=(0,h.OD)(a.id)},[]),v=(e,i,n)=>{let r=(0,p.eT)("sceneGraph").findById(e);if(!r||!i)return;let l=r.originElement.data,s=(0,o.cloneDeep)(l.sessions).map(e=>({...e,elementList:e.elementList.filter(e=>!i.includes(e))})),d={id:(0,a.Z)(),sessionId:(0,a.Z)(),type:f.FF.UserInput,elementList:i};void 0!==n&&n>-1?s.splice(n,0,d):s.push(d),r.originElement.data.sessions=s,(0,h.UD)(r,i,void 0,{minSize:(0,c.R5)("minSize")}),t.current=(0,h.OD)(r.id)},w=(0,r.useCallback)(()=>{let n=(0,p.eT)("sceneGraph");if(!n)return;let r=(0,s.Kl)("selection").filter(e=>{var t;return!y.B.includes(null==(t=n.findById(e))?void 0:t.type)});(0,c.pF)({dragNodeIds:r});let o=i();o&&((0,c.pF)({minSize:{width:Math.max(o.width,g.FL),height:Math.max(o.height,g.Rf)}}),e.current=o,t.current=(0,h.OD)(o.id),(0,c.pF)({chatFrame:o,insertTarget:null}))},[i]),x=(0,r.useCallback)(()=>{var i,r;let a=null==(i=(0,c.R5)("chatFrame"))?void 0:i.id,l=(0,c.R5)("dragNodeIds"),s=(0,p.eT)("sceneGraph"),u=s.findById(a);if(!l.length)return;if(!u&&e.current){n(null==e||null==(r=e.current)?void 0:r.id,null,null,l),e.current=null;return}u&&(e.current=u,t.current=(0,h.OD)(u.id));let f=l.map(e=>s.findById(e));if(!f.length||!u)return;let g=(0,d.Gw)(),m=u.absoluteToLocal(g);if(!u.hitTest(g)){null!==(0,c.R5)("insertTarget")&&(0,c.pF)({insertTarget:null});return}let y=(e=>{let i=t.current.findIndex((i,n)=>{let r=t.current[n-1],o=(null==r?void 0:r.bottom)?r.bottom-h.gn:0,a=i.top+h.gn;return!r&&!!(e.y<a)||!!(e.y<a)&&!!(e.y>o)});if(i>-1){let e=t.current[i-1],n=(null==e?void 0:e.bottom)??h.gn,r=t.current[i],o=(null==r?void 0:r.top)??0;return e?{index:i,y:(n+o)/2}:{index:0,y:h.gn/2}}if(-1===i&&t.current.length){let i=t.current[t.current.length-1].bottom;if(e.y>i&&e.y<i+h.gn)return{index:t.current.length+1,y:i+h.gn/2}}return null})(m),v=(0,c.R5)("insertTarget");if((0,o.isEqual)(v,y)||(0,c.pF)({insertTarget:y}),(null==y?void 0:y.index)>-1)return;let w=u.originElement.data,x=t.current.findIndex(e=>m.y>e.top&&m.y<e.bottom),b=w.sessions[x];if(!b)return void n(u.id,null,null,l);if(!b.elementList.includes(l[0]))return void n(u.id,b.sessionId,b.id,l);let E=b.elementList.map(e=>s.findById(e)).filter(e=>!!e).sort((e,t)=>e.x-t.x);if(!E.length)return void n(u.id,b.sessionId,b.id,l);let T=((e,t,i)=>{let n=-1;for(let r=0;r<t.length;r++){let o=t[r];if(r<=t.length-1&&!i.includes(o.id)&&e.x<o.x+o.width/2){n=r;break}if(r===t.length-1){n=r+1;break}}return n})(m,E,l);if(-1===T)return;let k=E.slice(0,T).filter(e=>!l.includes(e.id)),R=E.slice(T).filter(e=>!l.includes(e.id)),S=[...k,...f,...R],I=t.current[x];(0,h.aW)(S,I,u.id,l),b.elementList=S.map(e=>e.id)},[n]),b=(0,r.useCallback)(()=>{var i;let n=(0,c.R5)("insertTarget"),r=(0,c.R5)("dragNodeIds"),o=null==(i=(0,c.R5)("chatFrame"))?void 0:i.id,a=(0,p.eT)("sceneGraph").findById(o);a&&(null==n?void 0:n.index)>-1&&v(o,r,n.index);let l=null==a?void 0:a.originElement.data;a&&!l.sessions.some(e=>r.every(t=>e.elementList.includes(t)))&&v(o,r),(0,h.UD)(a,[],!0),(0,c.pF)({...c.Xu}),e.current=null,t.current=[]},[]);(0,r.useEffect)(()=>(l.z.on("selection:dragStart",w),l.z.on("selection:dragMove",x),l.z.on("selection:dragEnd",b),()=>{l.z.off("selection:dragStart",w),l.z.off("selection:dragMove",x),l.z.off("selection:dragEnd",b)}),[w,x,b])}[u,m,s,y,d,p,h,c]=v.then?(await v)():v,n()}catch(e){n(e)}})},55147:function(e,t,i){i.a(e,async function(e,n){try{i.d(t,{Qe:()=>s,R5:()=>c,Xu:()=>e,pF:()=>d});var r=i(80413),o=i(98830),a=i(11701);let e={dragNodeIds:[],chatFrame:null,insertTarget:null,moveInChatFrame:!1,minSize:{width:a.FL,height:a.Rf}},l=(0,r.F)()(()=>e),{useStore:s,setState:d,getState:c}=(0,o.b)(l);n()}catch(e){n(e)}})},23720:function(e,t,i){i.a(e,async function(e,n){try{i.d(t,{Z:()=>f,_:()=>g});var r=i(52983),o=i(40340),a=i(35040),l=i(79988),s=i(98516),d=i(75438),c=i(15394),u=i(81949),h=e([s,l,u,d,c]);[s,l,u,d,c]=h.then?(await h)():h;let g=e=>{let t=(0,s.rI)(e),i=(0,d.Ak)(),n=i.map,r=(null==i?void 0:i.fe_queue)??[],o=[...Object.values(n),...r],l=t.elements,c=new Map;return o.map(e=>{let t=l.find(t=>t.id===(null==e?void 0:e.layoutElementId));if(t&&(t.width!==e.width||t.height!==e.height)){let t=0,n=0;if(e.type===a.PQ.Outpaint){var i;let r=null==e||null==(i=e.params)?void 0:i.outPaintOffset;t=(null==r?void 0:r.leftOffset)??0,n=(null==r?void 0:r.topOffset)??0}c.set(e.layoutElementId,{width:e.width,height:e.height,offsetX:t,offsetY:n})}}),c};function f(){let e=(0,u.Uq)("stage"),t=(()=>{let e=(0,l.eD)("elements");return(0,r.useMemo)(()=>e.filter(e=>{var t;return e.type===o.Hd.ChatFrame&&(null==e||null==(t=e.data)?void 0:t.taskLayout)}),[e])})(),i=(0,l.eD)("tasks"),n=(0,r.useMemo)(()=>{let e=(null==i?void 0:i.fe_queue)??[];return[...Object.values(i.map),...e]},[i,i.map,i.fe_queue]);(0,r.useEffect)(()=>{if(!e)return;let t=(0,u.eT)("sceneGraph"),i=n.map(e=>{let i=null==e?void 0:e.layoutElementId;return t.findById(i)?e:null}).filter(Boolean);(0,c.$T)(i.map(e=>null==e?void 0:e.layoutElementId)).forEach(e=>{(0,c.UD)(e,void 0,!1)})},[e,n]),(0,r.useEffect)(()=>{if(!e)return;let i=(0,u.eT)("sceneGraph"),n=(0,d.Ak)(),r=n.map,o=Object.values(r).map(e=>null==e?void 0:e.layoutElementId),a=n.fe_queue,l=(null==a?void 0:a.map(e=>null==e?void 0:e.layoutElementId))??[],s=(0,c.$T)([...o,...l]);t.forEach(e=>{if(!s.find(t=>t.id===e.id)){let t=i.findById(e.id);(0,c.UD)(t,void 0,!1)}})},[e,t])}n()}catch(e){n(e)}})},7412:function(e,t,i){i.a(e,async function(e,n){try{i.d(t,{au:()=>h});var r=i(97458),o=i(52983),a=i(30967),l=i(79988),s=i(1842),d=i(25203),c=i(81949),u=e([d,l,c,s]);[d,l,c,s]=u.then?(await u)():u;let h=()=>{let e=(0,d.qt)("alignLines"),t=(0,l.eD)("viewport").scale,{lines:i,crossPoints:n}=(0,o.useMemo)(()=>{let t=(0,s.FW)();if(!t)return{lines:[],crossPoints:[]};let i=(0,l.Kl)("selection"),n=(0,c.eT)("sceneGraph"),{left:r,right:o,top:a,bottom:d}=t,u=(r+o)/2,h=(a+d)/2,f=(0,s.XQ)(i),g=1===f.length?n.findById(i[0]):null,m=g?g.getAbsoluteCorners():(0,s.PB)({x:r,y:a,width:o-r,height:d-a}),p=[],y=[];return e.forEach(e=>{let{type:t,points:i}=e;if(t===s.MR.LEFT){let e=m.filter(e=>e.x===r),t=Math.min(...i.map(e=>e.y),...e.map(e=>e.y)),n=Math.max(...i.map(e=>e.y),...e.map(e=>e.y));p.push(...e,...i),y.push([r,t,r,n])}if(t===s.MR.RIGHT){let e=m.filter(e=>e.x===o),t=Math.min(...i.map(e=>e.y),...e.map(e=>e.y)),n=Math.max(...i.map(e=>e.y),...e.map(e=>e.y));p.push(...e,...i),y.push([o,t,o,n])}if(t===s.MR.TOP){let e=m.filter(e=>e.y===a),t=Math.min(...i.map(e=>e.x),...e.map(e=>e.x)),n=Math.max(...i.map(e=>e.x),...e.map(e=>e.x));p.push(...e,...i),y.push([t,a,n,a])}if(t===s.MR.BOTTOM){let e=m.filter(e=>e.y===d),t=Math.min(...i.map(e=>e.x),...e.map(e=>e.x)),n=Math.max(...i.map(e=>e.x),...e.map(e=>e.x));p.push(...e,...i),y.push([t,d,n,d])}if(t===s.MR.CENTER_X){let e=Math.min(...i.map(e=>e.y),h),t=Math.max(...i.map(e=>e.y),h);p.push({x:u,y:h},...i),y.push([u,e,u,t])}if(t===s.MR.CENTER_Y){let e=Math.min(...i.map(e=>e.x),u),t=Math.max(...i.map(e=>e.x),u);p.push({x:u,y:h},...i),y.push([e,h,t,h])}}),{lines:y,crossPoints:p}},[e]);return(0,r.jsxs)(a.ZA,{children:[null==i?void 0:i.map((e,i)=>(0,r.jsx)(a.x1,{points:e,stroke:"#FF7B3A",strokeWidth:1/t},`snap-line-${i}`)),n.map((e,i)=>{let n=e.x-2.5/t,o=e.y-2.5/t,l=e.x+2.5/t,s=e.y+2.5/t,d=e.x+2.5/t,c=e.y-2.5/t,u=e.x-2.5/t,h=e.y+2.5/t;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(a.x1,{points:[n,o,l,s],stroke:"#FF7B3A",strokeWidth:1/t},`cross-point-line1-${i}`),(0,r.jsx)(a.x1,{points:[d,c,u,h],stroke:"#FF7B3A",strokeWidth:1/t},`cross-point-line2-${i}`)]})})]})};n()}catch(e){n(e)}})},1842:function(e,t,i){i.a(e,async function(e,n){try{i.d(t,{A9:()=>h,FW:()=>f,MR:()=>c,PB:()=>u,XQ:()=>g,Xt:()=>v,jV:()=>m,yR:()=>p});var r,o=i(72513),a=i(79988),l=i(99608),s=i(81949),d=e([l,a,s]);[l,a,s]=d.then?(await d)():d;var c=((r={}).LEFT="left",r.RIGHT="right",r.TOP="top",r.BOTTOM="bottom",r.CENTER_X="center-x",r.CENTER_X_CORNER="center-x-corner",r.CENTER_Y="center-y",r);let m=["left","right","center-x"],p=["top","bottom","center-y"];class y{get tolerance(){let e=(0,a.Kl)("viewport").scale;return this.screenTolerance/e}constructor(e=3){var t=this;(0,o._)(this,"screenTolerance",void 0),(0,o._)(this,"xIndex",void 0),(0,o._)(this,"yIndex",void 0),(0,o._)(this,"tempAlignNodesMap",void 0),(0,o._)(this,"addElement",void 0),(0,o._)(this,"addTempElementPoints",void 0),(0,o._)(this,"clearTempAlignNodesMap",void 0),(0,o._)(this,"addPointToIndex",void 0),(0,o._)(this,"findAlignmentLines",void 0),(0,o._)(this,"clear",void 0),this.screenTolerance=e,this.xIndex=new Map,this.yIndex=new Map,this.tempAlignNodesMap=null,this.addElement=e=>{h(e,"frame"===e.type).forEach(e=>{this.addPointToIndex(e)})},this.addTempElementPoints=e=>{this.tempAlignNodesMap=new y(this.screenTolerance),e.forEach(e=>{this.tempAlignNodesMap.addPointToIndex(e)})},this.clearTempAlignNodesMap=()=>{this.tempAlignNodesMap=null},this.addPointToIndex=e=>{let t=e.x;this.xIndex.has(t)||this.xIndex.set(t,[]),this.xIndex.get(t).push(e);let i=e.y;this.yIndex.has(i)||this.yIndex.set(i,[]),this.yIndex.get(i).push(e)},this.findAlignmentLines=function(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.tolerance,n=arguments.length>2?arguments[2]:void 0,r=e.left,o=e.right,a=e.top,l=e.bottom,s=(e.left+e.right)/2,d=(e.top+e.bottom)/2,c=[];for(let[e,n]of t.xIndex.entries())Math.abs(e-r)<=i&&c.push({type:"left",points:n}),Math.abs(e-o)<=i&&c.push({type:"right",points:n}),Math.abs(e-s)<=i&&c.push({type:"center-x",points:n});for(let[e,n]of t.yIndex.entries())Math.abs(e-a)<=i&&c.push({type:"top",points:n}),Math.abs(e-l)<=i&&c.push({type:"bottom",points:n}),Math.abs(e-d)<=i&&c.push({type:"center-y",points:n});if(t.tempAlignNodesMap){let n=t.tempAlignNodesMap.findAlignmentLines(e,i);c.push(...n)}return(null==n?void 0:n.length)&&(c=c.filter(e=>n.includes(e.type))),c},this.clear=()=>{this.xIndex.clear(),this.yIndex.clear()}}}let v=new y(4);function u(e){return[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}]}function h(e){var t;let i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=i?e.getAbsoluteBoundingBox():e.getDescendantsNonGroupBounds(),{x:r,y:o,width:a,height:l}=n;return[...((null==e||null==(t=e.children)?void 0:t.length)>1?u(n):e.getAbsoluteCorners()).map(t=>({...t,elementId:e.id})),{x:r+a/2,y:o+l/2,elementId:e.id}]}function f(e){let t=(0,l.M4)("dragNodeId"),i=(0,l.M4)("nodes").find(e=>e.selection.includes(t)),n=(e||(null==i?void 0:i.selection))??(0,a.Kl)("selection");if(0===n.length)return null;let r=1/0,o=-1/0,d=1/0,c=-1/0,u=(0,s.eT)("sceneGraph");return n.forEach(e=>{let t=u.findById(e);if(!t)return null;h(t).forEach(e=>{r=Math.min(r,e.x),o=Math.max(o,e.x),d=Math.min(d,e.y),c=Math.max(c,e.y)})}),{left:r,right:o,top:d,bottom:c}}function g(e){let t=(0,s.eT)("sceneGraph"),i=e.map(e=>{var i;return null==(i=t.findById(e))?void 0:i.getDescendants()}).filter(Boolean),n=new Set;return i.forEach(e=>{e.forEach(e=>{n.add(e.id)})}),e.forEach(e=>{n.add(e)}),Array.from(n)}n()}catch(e){n(e)}})},16703:function(e,t,i){i.a(e,async function(e,n){try{i.d(t,{U:()=>y});var r=i(52983),o=i(81042),a=i(49605),l=i(79988),s=i(31179),d=i(1842),c=i(25203),u=i(55147),h=i(81949),f=i(36509),g=i(99608),m=i(48024),p=e([o,s,u,l,h,g,m,d,c]);[o,s,u,l,h,g,m,d,c]=p.then?(await p)():p;let y=()=>{let e=(0,r.useRef)([]),t=(0,r.useRef)(null),i=(0,o.eX)("isDragCopyStatus"),n=(0,l.eD)("selection"),p=(0,h.Uq)("draggingLevelDirty"),y=(0,f.fk)("isGhostSelect"),v=(0,r.useCallback)(e=>{let t=(0,h.eT)("sceneGraph");if(!e.parent)return;d.Xt.clear();let i=(0,l.Kl)("selection"),n=(0,d.XQ)(i),r=(0,s.t_)(),o=e=>{for(let t=0;t<e.length;t++){let i=e[t];!n.includes(i.id)&&i.isInViewport(r)&&d.Xt.addElement(i)}};if("chat_frame"===e.parent.type)return;if(e.parent.isRoot()||"group"===e.parent.type){let e=t.getDescendants(e=>"frame"!==e.type),i=t.children.filter(e=>"frame"===e.type);e.push(...i),o(e);return}if("frame"===e.parent.type){d.Xt.addElement(e.parent);let t=e.getSiblings();o(t);return}let a=t.getDescendants(e=>"frame"!==e.type),c=t.children.filter(e=>"frame"===e.type);a.push(...c),o(a)},[]);(0,r.useEffect)(()=>{if(n.length&&!y){let e=(0,h.eT)("sceneGraph").findById(n[0]);e&&v(e)}else d.Xt.clear()},[n,y,v]);let w=(0,u.Qe)("chatFrame");(0,r.useEffect)(()=>{if(i&&e.current&&!w?d.Xt.addTempElementPoints(e.current):d.Xt.clearTempAlignNodesMap(),t.current){let e=d.Xt.findAlignmentLines(t.current,.001);(0,c.RC)({alignLines:e})}},[w,i]);let x=(0,r.useCallback)(()=>{let t=(0,h.eT)("sceneGraph");d.Xt.clear();let n=(0,g.TG)()[0],r=t.findById(n);if(!r)return;v(r);let o=(0,l.Kl)("selection").reduce((e,i)=>{let n=t.findById(i);return[...e,...(0,d.A9)(n)]},[]);e.current=o,i?d.Xt.addTempElementPoints(o):d.Xt.clearTempAlignNodesMap()},[i,v]);(0,r.useEffect)(()=>{d.Xt.clear();let e=(0,h.eT)("sceneGraph"),t=(0,g.TG)();if(!t.length)return;let i=t[0],n=e.findById(i);v(n)},[p,v]);let b=(0,r.useCallback)(()=>{let e=(0,d.FW)();if(!e)return;t.current=e;let i=d.Xt.findAlignmentLines(e,.001);(0,c.RC)({alignLines:i})},[]),E=(0,r.useCallback)(()=>{e.current=null,t.current=null,(0,c.RC)({alignLines:[],dragStartSelectionBox:{left:0,right:0,top:0,bottom:0}})},[]),T=(0,r.useCallback)(()=>{let e=(0,m.Eh)("hotId");if(!e)return;let i=[];switch(e){case"border-right":i=[d.MR.RIGHT];break;case"border-bottom":i=[d.MR.BOTTOM];break;case"border-left":i=[d.MR.LEFT];break;case"border-top":i=[d.MR.TOP];break;case"anchor-top-left":i=[d.MR.LEFT,d.MR.TOP];break;case"anchor-top-right":i=[d.MR.RIGHT,d.MR.TOP];break;case"anchor-bottom-left":i=[d.MR.LEFT,d.MR.BOTTOM];break;case"anchor-bottom-right":i=[d.MR.RIGHT,d.MR.BOTTOM]}if(!i.length)return;let n=(0,d.FW)();if(!n)return;t.current=n;let r=d.Xt.findAlignmentLines(n,.001,i);(0,c.RC)({alignLines:r})},[]);(0,r.useEffect)(()=>(a.z.on("selection:transformChange",T),()=>{a.z.off("selection:transformChange",T)}),[T]),(0,r.useEffect)(()=>(a.z.on("selection:transformMultiChange",T),()=>{a.z.off("selection:transformMultiChange",T)}),[T]),(0,r.useEffect)(()=>(a.z.on("selection:transformEnd",E),()=>{a.z.off("selection:transformEnd",E)}),[E]),(0,r.useEffect)(()=>(a.z.on("selection:dragStart",x),()=>{a.z.off("selection:dragStart",x)}),[x]),(0,r.useEffect)(()=>(a.z.on("selection:dragMove",b),()=>{a.z.off("selection:dragMove",b)}),[b]),(0,r.useEffect)(()=>(a.z.on("selection:dragEnd",E),()=>{a.z.off("selection:dragEnd",E)}),[E])};n()}catch(e){n(e)}})},25203:function(e,t,i){i.a(e,async function(e,n){try{i.d(t,{MA:()=>d,RC:()=>s,qt:()=>l});var r=i(80413),o=i(98830);let e={alignLines:[],dragStartSelectionBox:{left:0,right:0,top:0,bottom:0}},a=(0,r.F)()(()=>e),{useStore:l,setState:s,getState:d}=(0,o.b)(a);n()}catch(e){n(e)}})},69538:function(e,t,i){i.d(t,{V:()=>o});var n=i(72513),r=i(82955);let o=new class{resizeCanvas(e){(this.canvas.width!==e.width||this.canvas.height!==e.height)&&(this.canvas.width=e.width,this.canvas.height=e.height,this.gl.viewport(0,0,e.width,e.height))}initGL(e){if(!this.canvas){this.canvas=new OffscreenCanvas(e.width,e.height);let t=this.canvas.getContext("webgl",{premultipliedAlpha:!0,preserveDrawingBuffer:!0});if(!t)throw Error("WebGL2 not supported");this.gl=t,t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),t.enable(t.BLEND),t.blendFuncSeparate(t.ONE,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA),t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),this.program=(0,r.E1)(t,"attribute vec4 aPosition;\nattribute vec2 aTexCoord;\nvarying vec2 _coord2;\n\nvoid main() {\n    gl_Position = aPosition;\n    _coord2 = vec2(aTexCoord.x, 1.0 - aTexCoord.y);\n}","precision highp float;\nuniform sampler2D texture0;\nvarying vec2 _coord2;\nuniform int colorConversionType;\n\nvec3 lin_sRGB(vec3 color) {\n    vec3 result;\n    for(int i = 0; i < 3; i++) {\n        float val = color[i];\n        float sign = val < 0.0 ? -1.0 : 1.0;\n        float abs_val = abs(val);\n        if(abs_val < 0.04045) {\n            result[i] = val / 12.92;\n        } else {\n            result[i] = sign * pow((abs_val + 0.055) / 1.055, 2.4);\n        }\n    }\n    return result;\n}\n\nvec3 gam_sRGB(vec3 color) {\n    vec3 result;\n    for(int i = 0; i < 3; i++) {\n        float val = color[i];\n        float sign = val < 0.0 ? -1.0 : 1.0;\n        float abs_val = abs(val);\n        if(abs_val > 0.0031308) {\n            result[i] = sign * (1.055 * pow(abs_val, 1.0 / 2.4) - 0.055);\n        } else {\n            result[i] = 12.92 * val;\n        }\n    }\n    return result;\n}\n\nvec3 colorSpaceConvert(vec3 src) {\n    const int NO_CONVERSION = 0;\n    const int SRGB_TO_DISPLAY_P3 = 1;\n    const int DISPLAY_P3_TO_SRGB = 2;\n\n    if(colorConversionType == NO_CONVERSION) {\n        return src;\n    } else if(colorConversionType == SRGB_TO_DISPLAY_P3) {\n        vec3 lin_srgb = lin_sRGB(src);\n        mat3 lin_sRGB_to_XYZ = mat3(0.4123908, 0.2126390, 0.0193308, 0.3575843, 0.7151687, 0.1191948, 0.1804808, 0.0721923, 0.9505322);\n        mat3 XYZ_to_lin_P3 = mat3(2.4934969, -0.8294890, 0.0358458, -0.9313836, 1.7626641, -0.0761724, -0.4027108, 0.0236247, 0.9568845);\n        vec3 lin_p3 = XYZ_to_lin_P3 * lin_sRGB_to_XYZ * lin_srgb;\n        return gam_sRGB(lin_p3);\n    } else if(colorConversionType == DISPLAY_P3_TO_SRGB) {\n        vec3 lin_p3 = lin_sRGB(src);\n        mat3 lin_P3_to_XYZ = mat3(0.4865709, 0.2289746, 0.0, 0.2656677, 0.6917385, 0.0451134, 0.1982173, 0.0792869, 1.0439444);\n        mat3 XYZ_to_lin_sRGB = mat3(3.2409699, -0.9692436, 0.0556301, -1.5373832, 1.8759675, -0.2039769, -0.4986108, 0.0415551, 1.0569715);\n        vec3 lin_srgb = XYZ_to_lin_sRGB * lin_P3_to_XYZ * lin_p3;\n        return clamp(gam_sRGB(lin_srgb), 0.0, 1.0);\n    }\n    return src;\n}\n\nuniform float globalTint;\nuniform float globalColor;\nuniform float globalShadows;\nuniform float globalHighlights;\nuniform float globalExposure;\nuniform float globalTemperature;\nuniform float globalContrast;\nuniform float highlightShadowThreshold;\nuniform float alpha;\n\nconst vec3 RGB2Y = vec3(0.2126, 0.7152, 0.0722);\n\nvec3 colorToLinear(vec3 color) {\n    return pow(color, vec3(2.2));\n}\n\nvec3 colorFromLinear(vec3 color) {\n    return pow(color, vec3(1.0 / 2.2));\n}\n\nfloat rangeFactor(vec3 color, float shadows, float highlights) {\n    float lThreshold = dot(color, RGB2Y) - pow(highlightShadowThreshold, 2.2);\n    return 0.75 * lThreshold / sqrt(1.0 + 4.0 * lThreshold * lThreshold) *\n        (lThreshold > 0.0 ? highlights : -shadows * 0.999);\n}\n\nvec3 adjustExposure(vec3 color, float exposureAdjust) {\n    float lFactor = pow(10.0, 2.0 * exposureAdjust) - 1.0;\n    const float lSqueeze = 0.75;\n    float lUnsqueeze = 1.0 / (1.0 - lSqueeze) - 1.0;\n    float gray = dot(color, RGB2Y);\n    lUnsqueeze *= 1.0 + gray * gray * min(0.0, exposureAdjust) / (0.2 - min(0.0, exposureAdjust));\n\n    color += (gray - color) * lSqueeze;\n    if(exposureAdjust < 0.0) {\n        color *= 1.0 + exposureAdjust / 16.0;\n        gray *= 1.0 + exposureAdjust / 16.0;\n    }\n    color *= (lFactor + 1.0) / (color * lFactor + 1.0);\n    gray *= (lFactor + 1.0) / (gray * lFactor + 1.0);\n    color += (color - gray) * lUnsqueeze;\n    return clamp(color, 0.0, 1.0);\n}\n\nvec3 adjustColor(vec3 color, float colorAdjust) {\n    float gray = dot(color, RGB2Y);\n    if(colorAdjust <= 0.0) {\n        color -= (gray - color) * colorAdjust;\n    } else {\n        float lNeg = gray / (gray - min(min(color.r, color.g), color.b) + 1e-6);\n        float lPos = (1.0 - gray) / (max(max(color.r, color.g), color.b) - gray + 1e-6);\n        float lFactor = mix(1.0, min(lNeg, lPos), colorAdjust);\n        lFactor = min(lFactor, 2.0);\n        color += (gray - color) * (1.0 - lFactor);\n    }\n    return color;\n}\n\nfloat smootherstep(float edge0, float edge1, float x) {\n    x = clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);\n    return x * x * x * (x * (x * 6.0 - 15.0) + 10.0);\n}\n\nvec3 adjustTempTintContrast(vec3 color, float temp, float tint, float contrast) {\n    mat3 RGBtoXYZ = mat3(0.4124564, 0.2126729, 0.0193339, 0.3575761, 0.7151522, 0.1191920, 0.1804375, 0.0721750, 0.9503041);\n    mat3 XYZtoRGB = mat3(3.2404542, -0.9692660, 0.0556434, -1.5371385, 1.8760108, -0.2040259, -0.4985314, 0.0415560, 1.0572252);\n\n    vec3 lXYZ = RGBtoXYZ * color;\n    lXYZ.x /= 0.95047;\n    lXYZ.z /= 1.08883;\n    lXYZ = pow(lXYZ, vec3(1.0 / 3.0));\n    vec3 lLAB = vec3(116.0 * lXYZ.y - 16.0, 500.0 * (lXYZ.x - lXYZ.y), 200.0 * (lXYZ.y - lXYZ.z));\n    lLAB.y += 30.0 * tint;\n    lLAB.z += 30.0 * temp;\n\n    float scaledThreshold = highlightShadowThreshold * 100.0;\n    float thresholdDelta = 30.0;\n    float contrastLeftCurve = contrast < 0.0 ? (lLAB.x - scaledThreshold) * 0.2 + 50.0 : lLAB.x;\n    float contrastRightCurve = contrast < 0.0 ? lLAB.x : smootherstep(scaledThreshold - thresholdDelta, scaledThreshold + thresholdDelta, lLAB.x) * 100.0;\n    float interp = contrast < 0.0 ? contrast + 1.0 : contrast;\n    lLAB.x = mix(contrastLeftCurve, contrastRightCurve, interp);\n\n    lXYZ.y = (lLAB.x + 16.0) / 116.0;\n    lXYZ.x = lLAB.y / 500.0 + lXYZ.y;\n    lXYZ.z = lXYZ.y - lLAB.z / 200.0;\n    lXYZ = lXYZ * lXYZ * lXYZ;\n    lXYZ.x *= 0.95047;\n    lXYZ.z *= 1.08883;\n    color = XYZtoRGB * lXYZ;\n    return clamp(color, 0.0, 1.0);\n}\n\nvec3 pipeline(vec3 color) {\n    color = colorToLinear(color);\n    float originalRangeFactor = rangeFactor(color, globalShadows, globalHighlights);\n    color = adjustTempTintContrast(color, globalTemperature, globalTint, globalContrast);\n    color = adjustExposure(color, globalExposure + originalRangeFactor);\n    color = adjustColor(color, clamp(globalColor, -1.0, 1.0));\n    return colorFromLinear(color);\n}\n\nvoid main() {\n    vec4 color;\n    if(_coord2.x >= 0.0 && _coord2.x <= 1.0 && _coord2.y >= 0.0 && _coord2.y <= 1.0) {\n        color = texture2D(texture0, _coord2);\n    } else {\n        color = vec4(0.0);\n    }\n\n    color.rgb = colorSpaceConvert(pipeline(color.rgb)) * color.a;\n    gl_FragColor = color * alpha;\n}"),this.buffer=t.createBuffer();let i=new Float32Array([-1,-1,0,0,1,-1,1,0,-1,1,0,1,1,1,1,1]);t.bindBuffer(t.ARRAY_BUFFER,this.buffer),t.bufferData(t.ARRAY_BUFFER,i,t.STATIC_DRAW);let n=t.getAttribLocation(this.program,"aPosition"),o=t.getAttribLocation(this.program,"aTexCoord");t.enableVertexAttribArray(n),t.enableVertexAttribArray(o),t.vertexAttribPointer(n,2,t.FLOAT,!1,16,0),t.vertexAttribPointer(o,2,t.FLOAT,!1,16,8),["globalTint","globalColor","globalShadows","globalHighlights","globalExposure","globalTemperature","globalContrast","highlightShadowThreshold","colorConversionType","alpha"].forEach(e=>{this.uniformLocations[e]=t.getUniformLocation(this.program,e)})}}createTexture(e){this.gl||this.initGL(e);let t=this.gl,i=(0,r.cU)(t,e,0);return{texture:i,disposeTexture:()=>{t.deleteTexture(i)}}}async process(e,t,i){this.initGL(e),this.resizeCanvas(e);let n=this.gl;if(i.texture)this.currentTexture=i.texture;else{let t=(0,r.cU)(n,e,0);this.currentTexture&&n.deleteTexture(this.currentTexture),this.currentTexture=t}n.activeTexture(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,this.currentTexture),n.useProgram(this.program),n.uniform1f(this.uniformLocations.globalTint,t.globalTint??0),n.uniform1f(this.uniformLocations.globalColor,t.globalColor??0),n.uniform1f(this.uniformLocations.globalShadows,t.globalShadows??0),n.uniform1f(this.uniformLocations.globalHighlights,t.globalHighlights??0),n.uniform1f(this.uniformLocations.globalExposure,t.globalExposure??0),n.uniform1f(this.uniformLocations.globalTemperature,t.globalTemperature??0),n.uniform1f(this.uniformLocations.globalContrast,t.globalContrast??0),n.uniform1f(this.uniformLocations.highlightShadowThreshold,t.highlightShadowThreshold??.5),n.uniform1i(this.uniformLocations.colorConversionType,t.colorConversionType??0),n.uniform1f(this.uniformLocations.alpha,t.alpha??1),n.clearColor(0,0,0,0),n.clear(n.COLOR_BUFFER_BIT),n.drawArrays(n.TRIANGLE_STRIP,0,4);let o={imageBitmap:null,blob:null,blobURL:null};return i.imageBitmap&&(o.imageBitmap=await createImageBitmap(this.canvas)),(i.blob||i.blobURL)&&(o.blob=await this.toBlob()),i.blobURL&&(o.blobURL=await this.toBlobURL(o.blob)),o}async toBlob(){return await this.canvas.convertToBlob()}async toBlobURL(e){return URL.createObjectURL(e)}dispose(){var e,t,i,n,r;this.currentTexture&&(null==(e=this.gl)||e.deleteTexture(this.currentTexture)),this.buffer&&(null==(t=this.gl)||t.deleteBuffer(this.buffer)),this.program&&(null==(i=this.gl)||i.deleteProgram(this.program)),null==(r=this.gl)||null==(n=r.getExtension("WEBGL_lose_context"))||n.loseContext(),this.gl=null,this.canvas=null}constructor(){(0,n._)(this,"gl",null),(0,n._)(this,"program",null),(0,n._)(this,"buffer",null),(0,n._)(this,"canvas",null),(0,n._)(this,"currentTexture",null),(0,n._)(this,"uniformLocations",{})}}},82955:function(e,t,i){function n(e,t,i){let n=e.createShader(t);return(e.shaderSource(n,i),e.compileShader(n),e.getShaderParameter(n,e.COMPILE_STATUS))?n:(console.error(e.getShaderInfoLog(n)),e.deleteShader(n),null)}function r(e,t,i){let r=n(e,e.VERTEX_SHADER,t),o=n(e,e.FRAGMENT_SHADER,i),a=e.createProgram();return(e.attachShader(a,r),e.attachShader(a,o),e.linkProgram(a),e.getProgramParameter(a,e.LINK_STATUS))?a:(console.error(e.getProgramInfoLog(a)),e.deleteProgram(a),null)}function o(e,t,i){let n=e.createTexture();return e.activeTexture(e.TEXTURE0+i),e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),n}function a(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return .01*e}function l(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return .003*e}i.d(t,{E1:()=>r,_l:()=>d,aR:()=>l,cU:()=>o,qq:()=>a,rW:()=>s});let s=function(){try{let e=document.createElement("canvas");return!!(window.WebGLRenderingContext&&(e.getContext("webgl")||e.getContext("experimental-webgl")))}catch(e){return!1}}(),d=function(){try{let e=document.createElement("canvas");return!!(window.WebGL2RenderingContext&&e.getContext("webgl2"))}catch(e){return!1}}()},10730:function(e,t,i){i.a(e,async function(e,n){try{i.d(t,{u:()=>u});var r=i(72513),o=i(66969),a=i(83637),l=i(37092),s=i(16479),d=i(54499),c=e([a,l,o]);[a,l,o]=c.then?(await c)():c;let u=new class{logError(e){console.error(`[HotKeyManager]: ${e}`)}registerBuiltinContexts(){s.h.forEach(e=>{this.registerContext(e)})}registerContext(e){if(this.contexts.has(e.name))return void this.logError(`Context ${e.name} already registered`);this.contexts.set(e.name,e)}activateContext(e){if(!this.contexts.get(e))return void this.logError(`Context "${e}" not found`);this.activeContexts.add(e)}deactivateContext(e){this.activeContexts.delete(e)}registerAllHotkeys(){Object.entries(a.F).forEach(e=>{let[t,i]=e;this.registerHotkey(t,i)}),Object.entries(l.s).forEach(e=>{let[t,i]=e;this.registerHotkey(t,i)})}getUniqueKey(e,t){return`${e}-${(0,d.NP)(t).join("+")}`}registerHotkey(e,t){let i=t.context;if(void 0===i)i=s.Q.Global;else if(!this.contexts.has(i))return void this.logError(`Context ${i} not found`);for(let e of Array.isArray(t.key)?t.key:[t.key]){let n=this.getUniqueKey(i,e);if(this.hotkeys.has(n)){this.logError(`Hotkey "${e}" already registered in context "${i}"`);continue}this.hotkeys.set(n,{...this.defaultHotkeyConfig,...t,context:i,parsedHotkey:(0,d.LP)(e)})}this.hotKeyNameMap.has(e)&&this.logError(`Hotkey name "${e}" already registered, will be override`),this.hotKeyNameMap.set(e,t)}getHotkeyByName(e){return this.hotKeyNameMap.get(e)}getAllActiveHotkeys(){return Array.from(this.hotkeys.values()).filter(e=>this.activeContexts.has(e.context))}checkIsHotkeyMatch(e,t){let{alt:i,meta:n,shift:r,ctrl:a,keys:l}=e,{ctrlKey:s,metaKey:d,shiftKey:c,altKey:u,code:h}=t;return i===u&&r===c&&a===s&&n===d&&(1===l.length&&l[0]===h||(0,o.rB)(l.join("+")))}getMatchedHotkey(e){let t=this.getAllActiveHotkeys(),i=[];for(let n of t)this.checkIsHotkeyMatch(n.parsedHotkey,e)&&i.push(n);return 0===i.length?null:1===i.length?i[0]:i.sort((e,t)=>(t.priority||0)-(e.priority||0))[0]}handleKeyDown(e){let t=this.getMatchedHotkey(e);if(!t)return;let{handler:i,preventDefault:n,tagsToIgnore:r,triggerOnContentEditable:o}=t;if(!this.shouldIgnoreEvent(e,r,o)){n&&e.preventDefault();try{null==i||i(e)}catch(e){this.logError(`Error when hotkey: ${t.key} executed: ${e}`)}}}shouldIgnoreEvent(e,t,i){let n=e.target;if(!n)return!1;let r=n.tagName.toLowerCase();return!!new Set(t.map(e=>e.toLowerCase())).has(r)||("true"===n.contentEditable?!i:!!e.isComposing||229===e.keyCode)}constructor(){(0,r._)(this,"hotkeys",new Map),(0,r._)(this,"contexts",new Map),(0,r._)(this,"hotKeyNameMap",new Map),(0,r._)(this,"activeContexts",new Set),(0,r._)(this,"defaultHotkeyConfig",{preventDefault:!0,tagsToIgnore:["INPUT","TEXTAREA","SELECT"],triggerOnContentEditable:!1}),this.registerBuiltinContexts(),this.activateContext(s.Q.Global),this.activateContext(s.Q.Canvas),this.registerAllHotkeys()}};n()}catch(e){n(e)}})},58762:function(e,t,i){i.a(e,async function(e,n){try{i.d(t,{q:()=>c});var r=i(97458),o=i(52983),a=i(10976),l=i(8310),s=i(54499),d=e([l]);l=(d.then?(await d)():d)[0];let c=(0,o.memo)(function(e){let{hotkeyName:t,customHotkey:i,className:n}=e,o=i??(0,l.O)(t);if(!o)return null;let d=(0,s.o5)(o);return(0,r.jsx)("span",{className:(0,a.Z)("flex items-center gap-0.5 text-body-sm text-[#C1C5CC]",n),children:d.map(e=>(0,r.jsx)("span",{className:(0,a.Z)("inline-block min-w-[13px] text-center","⏎"===e&&"font-sans"),children:e},e))})});n()}catch(e){n(e)}})},37092:function(e,t,i){i.a(e,async function(e,n){try{i.d(t,{s:()=>b});var r=i(40340),o=i(35040),a=i(77605),l=i(97389),s=i(44527),d=i(11120),c=i(84537),u=i(94671),h=i(18370),f=i(66371),g=i(65196),m=i(49604),p=i(30980),y=i(621),v=i(79988),w=i(1232),x=e([g,m,l,p,y,s,d,c,a,u,v,f]);[g,m,l,p,y,s,d,c,a,u,v,f]=x.then?(await x)():x;let b={[w.t.Copy]:{key:"mod+c",description:"复制",handler:()=>{(()=>{let e=window.getSelection();return(null==e?void 0:e.toString().trim())!==""})()||(0,l.NA)({copyToClipboard:!1,trigger_type:2})},preventDefault:!1},[w.t.Paste]:{key:"mod+v",description:"粘贴",preventDefault:!1},[w.t.Flatten]:{key:"shift+alt+f",description:"拼合",handler:()=>{(0,g.U)()},preventDefault:!1},[w.t.Outline]:{key:"mod+alt+o",description:"轮廓化",handler:()=>{(0,m.ZH)()}},[w.t.Cut]:{key:"mod+x",description:"剪切",handler:()=>{(0,l.Ej)()},preventDefault:!1},[w.t.FastCopy]:{key:"mod+d",description:"快速复制",handler(){(0,l.tx)()}},[w.t.SelectAll]:{key:"mod+a",description:"全选",handler:()=>{}},[w.t.Delete]:{key:"delete",description:"删除"},[w.t.Select]:{key:"v",description:"选择",handler(){}},[w.t.Move]:{key:"h",description:"移动"},[w.t.Text]:{key:"t",description:"文本"},[w.t.Rectangle]:{key:"r",description:"矩形"},[w.t.Circle]:{key:"o",description:"圆形"},[w.t.Pen]:{key:"p",description:"钢笔"},[w.t.Brush]:{key:"b",description:"画笔"},[w.t.Frame]:{key:"f",description:"画板"},[w.t.ImageGenerator]:{key:"a",description:"图像生成"},[w.t.VideoGenerator]:{key:"",description:"视频生成"},[w.t.ZoomIn]:{key:["mod+plus","mod+="],description:"放大",handler:()=>{(0,p.on)()?h.YB.emit(h.tw.FLOW_ZOOM_IN):y.viewportActions.zoomIn()}},[w.t.ZoomOut]:{key:"mod+-",description:"缩小",handler:()=>{(0,p.on)()?h.YB.emit(h.tw.FLOW_ZOOM_OUT):y.viewportActions.zoomOut()}},[w.t.ZoomTo100]:{key:"mod+0",description:"100%缩放",handler:()=>{y.viewportActions.zoomTo(1,y.ZoomToOrigin.ScreenCenter)}},[w.t.ZoomToFit]:{key:"shift+1",description:"适合屏幕",handler:()=>{(0,p.on)()?h.YB.emit(h.tw.FLOW_FIT_VIEW):y.viewportActions.fitView()}},[w.t.ZoomToElement]:{key:"shift+2",description:"选区聚焦",handler:()=>{let{selection:e}=(0,v.Kl)();1===e.length&&y.viewportActions.locateElement(e[0],{fitView:!0,animate:!0})}},[w.t.BringToFront]:{key:"]",description:"置顶",handler(){}},[w.t.SendToBack]:{key:"[",description:"置底",handler(){}},[w.t.MoveUp]:{key:"mod+]",description:"上移一层",handler(){}},[w.t.MoveDown]:{key:"mod+[",description:"下移一层",handler(){}},[w.t.ToggleHide]:{key:"shift+mod+h",description:"显示/隐藏",handler(){(0,s.c)()}},[w.t.ToggleLock]:{key:"shift+mod+l",description:"锁定/解锁",handler(){(0,s.T)()}},[w.t.MergeLayers]:{key:"mod+e",description:"合并图层",handler(){(0,v.KW)(),(0,d.l)()}},[w.t.PixelNudgingLeft]:{key:"arrowleft",description:"左移一像素",handler:()=>{(0,c.K)("left",1)}},[w.t.PixelNudgingRight]:{key:"arrowright",description:"右移一像素",handler:()=>{(0,c.K)("right",1)}},[w.t.PixelNudgingUp]:{key:"arrowup",description:"上移一像素",handler:()=>{(0,c.K)("up",1)}},[w.t.PixelNudgingDown]:{key:"arrowdown",description:"下移一像素",handler:()=>{(0,c.K)("down",1)}},[w.t.PixelNudgingLeft10]:{key:"shift+arrowleft",description:"左移十像素",handler:()=>{(0,c.K)("left",10)}},[w.t.PixelNudgingRight10]:{key:"shift+arrowright",description:"右移十像素",handler:()=>{(0,c.K)("right",10)}},[w.t.PixelNudgingUp10]:{key:"shift+arrowup",description:"上移十像素",handler:()=>{(0,c.K)("up",10)}},[w.t.PixelNudgingDown10]:{key:"shift+arrowdown",description:"下移十像素",handler:()=>{(0,c.K)("down",10)}},[w.t.BooleanUnion]:{key:"alt+shift+u",description:"合并",handler:()=>{(0,a.JK)(r.v0.Union)}},[w.t.BooleanSubtract]:{key:"alt+shift+s",description:"差集",handler:()=>{(0,a.JK)(r.v0.Subtract)}},[w.t.BooleanIntersect]:{key:"alt+shift+i",description:"交集",handler:()=>{(0,a.JK)(r.v0.Intersection)}},[w.t.BooleanExclude]:{key:"alt+shift+e",description:"排除",handler:()=>{(0,a.JK)(r.v0.Exclude)}},[w.t.Group]:{key:"mod+g",description:"编组",handler:()=>{(0,a.ru)()}},[w.t.Ungroup]:{key:"shift+mod+g",description:"解组",handler:()=>{(0,a.Z8)()}},[w.t.AlignLeft]:{key:"alt+a",description:"左对齐",handler:()=>{(0,u.H_)()}},[w.t.AlignHorizontalCenter]:{key:"alt+h",description:"水平居中",handler:()=>{(0,u.v1)()}},[w.t.AlignRight]:{key:"alt+d",description:"右对齐",handler:()=>{(0,u.cP)()}},[w.t.AlignTop]:{key:"alt+w",description:"顶部对齐",handler:()=>{(0,u.Lb)()}},[w.t.AlignVerticalCenter]:{key:"alt+v",description:"垂直居中",handler:()=>{(0,u.h4)()}},[w.t.AlignBottom]:{key:"alt+s",description:"底部对齐",handler:()=>{(0,u.Ew)()}},[w.t.AlignHorizontalSpace]:{key:"shift+h",description:"水平等距分布",handler:()=>{(0,u.x3)()}},[w.t.AlignVerticalSpace]:{key:"shift+v",description:"垂直等距分布",handler:()=>{(0,u.Oo)()}},[w.t.AlignAuto]:{key:"shift+a",description:"自动排列",handler:()=>{(0,u.iO)()}},[w.t.Tab]:{key:"tab",description:"tab"},[w.t.SendToChat]:{key:"mod+enter",description:"发送到对话框",handler:async()=>{}},[w.t.MarkQuickRun]:{key:"shift+q",description:"Mark快速运行",handler:()=>{(0,v.Kl)("currentCanvasTool")===o.nX.mark&&(0,f.JZ)({shortcut:!0})}}};n()}catch(e){n(e)}})},83637:function(e,t,i){i.a(e,async function(e,n){try{i.d(t,{F:()=>l});var r=i(36013),o=i(1232),a=e([r]);r=(a.then?(await a)():a)[0];let l={[o.t.Undo]:{key:"mod+z",description:"撤销"},[o.t.Redo]:{key:"mod+shift+z",description:"重做"},[o.t.Escape]:{key:"esc",description:"取消/退出",handler:r.k},[o.t.Enter]:{key:"enter",description:"确认",preventDefault:!1}};n()}catch(e){n(e)}})},36013:function(e,t,i){i.a(e,async function(e,n){try{i.d(t,{k:()=>d});var r=i(35040),o=i(33320),a=i(92827),l=i(79988),s=e([a,l,o]);function d(){return(0,a.hC)("contextMenuTarget")||(0,a.hC)("contextMenuPosition")?void(0,a.qb)({contextMenuTarget:null,contextMenuElementId:null,contextMenuUnitId:null,contextMenuPosition:null}):(0,l.Kl)("editingElementId")?void(0,l.L$)({currentCanvasTool:r.nX.select,currentElementTool:null,editingElementId:null}):(0,a.hC)("showContrastElementId")?void(0,a.qb)({showContrastElementId:null}):(0,l.Kl)("currentCanvasTool")!==r.nX.select?void(0,l.L$)({currentCanvasTool:r.nX.select}):(0,l.Kl)("currentCanvasTool")===r.nX.select?void(0,o.clearSelection)():void 0}[a,l,o]=s.then?(await s)():s,n()}catch(e){n(e)}})},16479:function(e,t,i){i.d(t,{Q:()=>r,h:()=>o});var n,r=((n={}).Global="global",n.Canvas="canvas",n.Text="text",n.Vector="vector",n);let o=[{name:"global",priority:0,description:"全局上下文"},{name:"canvas",priority:10,description:"画布上下文"},{name:"text",priority:50,description:"文本上下文"},{name:"vector",priority:100,description:"矢量上下文"}]},1232:function(e,t,i){i.d(t,{t:()=>r});var n,r=((n={}).Copy="copy",n.Paste="paste",n.Cut="cut",n.FastCopy="fastCopy",n.Undo="undo",n.Redo="redo",n.SelectAll="selectAll",n.Delete="delete",n.Select="select",n.Move="move",n.Text="text",n.Rectangle="rectangle",n.Circle="circle",n.Pen="pen",n.Brush="brush",n.Frame="frame",n.ImageSet="imageSet",n.ImageGenerator="imageGenerator",n.VideoGenerator="videoGenerator",n.ZoomIn="zoomIn",n.ZoomOut="zoomOut",n.ZoomToFit="zoomToFit",n.ZoomTo100="zoomTo100",n.ZoomToElement="zoomToElement",n.BringToFront="bringToFront",n.SendToBack="sendToBack",n.MoveUp="moveUp",n.MoveDown="moveDown",n.ToggleHide="toggleHide",n.ToggleLock="toggleLock",n.MergeLayers="mergeLayers",n.PixelNudgingLeft="pixelNudgingLeft",n.PixelNudgingRight="pixelNudgingRight",n.PixelNudgingUp="pixelNudgingUp",n.PixelNudgingDown="pixelNudgingDown",n.PixelNudgingLeft10="pixelNudgingLeft10",n.PixelNudgingRight10="pixelNudgingRight10",n.PixelNudgingUp10="pixelNudgingUp10",n.PixelNudgingDown10="pixelNudgingDown10",n.BooleanUnion="booleanUnion",n.BooleanSubtract="booleanSubtract",n.BooleanIntersect="booleanIntersect",n.BooleanExclude="booleanExclude",n.Group="group",n.Ungroup="ungroup",n.AlignLeft="alignLeft",n.AlignRight="alignRight",n.AlignHorizontalCenter="alignHorizontalCenter",n.AlignTop="alignTop",n.AlignBottom="alignBottom",n.AlignVerticalCenter="alignVerticalCenter",n.AlignHorizontalSpace="alignHorizontalSpace",n.AlignVerticalSpace="alignVerticalSpace",n.AlignAuto="alignAuto",n.Escape="esc",n.Enter="enter",n.Tab="tab",n.SendToChat="sendToChat",n.NewProject="newProject",n.Flatten="flatten",n.Outline="Outline",n.TextBold="textBold",n.MarkQuickRun="markQuickRun",n.MarkChatRun="markChatRun",n)},8310:function(e,t,i){i.a(e,async function(e,n){try{i.d(t,{O:()=>a});var r=i(10730),o=e([r]);function a(e){let t=r.u.getHotkeyByName(e),i=null==t?void 0:t.key;return Array.isArray(i)?i[0]:i}r=(o.then?(await o)():o)[0],n()}catch(e){n(e)}})},12863:function(e,t,i){i.a(e,async function(e,n){try{i.d(t,{FN:()=>h,Og:()=>m});var r=i(60147),o=i(9279),a=i(35962),l=i(81949),s=i(29330),d=i(98516),c=i(45453),u=e([l,o,c,r,a,d,s]);[l,o,c,r,a,d,s]=u.then?(await u)():u;let f={selection:[],type:"image/png",quality:1,pixelRatio:1,backgroundColor:"#ffffff"},g=async e=>{try{let t=(0,l.eT)("sceneGraph"),i=null==t?void 0:t.findById(e);if(!i||"image"===i.type)return null;let n=(0,r.Zr)();if(!n)throw Error("无法获取画布实例");let s=await (0,o.R2)(n,e,f);if(!s)return null;let d=await new Promise((e,t)=>{s.toBlob(i=>{i?e(i):t(Error("无法将canvas转换为blob"))},"image/png")}),c=new File([d],`element-${e}.png`,{type:"image/png"}),u=await (0,a.Ix)(c,!1,"mark");if(!u||!u.url)throw Error("图片上传失败");return u.url,u.url}catch(t){return console.error(`\u{8F6C}\u{6362}\u{5143}\u{7D20} ${e} \u{4E3A}\u{56FE}\u{7247}\u{5931}\u{8D25}:`,t),null}};async function h(e){try{var t;if(!e||0===e.length)return null;let i=(0,c.P_)(e);if(!i)return null;let n=(0,r.Zr)();if(!n)throw Error("无法获取画布实例");let o=n.findOne(".elements-container");if(!o)throw Error("找不到元素容器");let l=o.clone();null==(t=l.getChildren)||t.call(l).forEach(e=>{e.visible(!1)}),e.forEach(e=>{let t=l.findOne(`#${e}-wrapper`);if(t){var i,n;t.visible(!0),null==(i=t.find("#rich-text-base-line"))||i.forEach(e=>{e.destroy()}),null==(n=t.find("#vector-state"))||n.forEach(e=>{e.destroy()})}});let s=l.toCanvas({...i,pixelRatio:f.pixelRatio}),d=s.getContext("2d");if(d&&(d.globalCompositeOperation="destination-over",d.fillStyle=f.backgroundColor,d.fillRect(0,0,s.width,s.height)),l.destroy(),!s)return null;let u=await new Promise((e,t)=>{s.toBlob(i=>{i?e(i):t(Error("无法将canvas转换为blob"))},"image/png")}),h=new File([u],`elements-${e.join("-")}.png`,{type:"image/png"}),g=await (0,a.Ix)(h,!1,"mark");if(!g||!g.url)throw Error("图片上传失败");return e.join(", "),g.url,g.url}catch(t){return console.error(`\u{8F6C}\u{6362}\u{591A}\u{4E2A}\u{5143}\u{7D20} [${e.join(", ")}] \u{4E3A}\u{56FE}\u{7247}\u{5931}\u{8D25}:`,t),null}}let m=async e=>{let t=(0,s.oE)().elemBitmapURLMap[e];if(t)return t;let i=(0,d.rI)(e);if(null==i?void 0:i.url)return null==i?void 0:i.url;try{let t=await g(e);if(!t)return null;{let i=(0,s.oE)();return(0,s.l2)({elemBitmapURLMap:{...i.elemBitmapURLMap,[e]:t}}),t}}catch(t){return console.error(`\u{274C} \u{5143}\u{7D20} ${e} \u{4E0A}\u{4F20}\u{51FA}\u{9519}:`,t),null}};n()}catch(e){n(e)}})},60542:function(e,t,i){i.d(t,{JL:()=>d,Mg:()=>l,Qw:()=>s,px:()=>c,rq:()=>a});var n=i(80413),r=i(98830);let o=(0,n.F)()(()=>({editor:null,editorId:"",inputDom:null,konvaGroup:null,editorRenderDep:!1,layoutDep:!1,setStyleDep:!1,selectionDep:!1,groupRenderDep:!1,transformerDep:!1,history:null,globalRedoUndoDep:!1,leaveTextId:"",clearSelectionDep:!1,isFirstLoad:!1})),{useStore:a,setState:l,getState:s}=(0,r.b)(o),d=()=>{var e;return null==(e=s("editor"))?void 0:e.isEditor},c=e=>{let t=a("layoutDep");return(null==e?void 0:e.type)&&(null==e?void 0:e.id)&&"text"===e.type&&s("editorId")===e.id?t:null}},75217:function(e,t,i){i.a(e,async function(e,n){try{i.d(t,{e:()=>s});var r=i(67478),o=i(60542),a=i(9867),l=e([r]);r=(l.then?(await l)():l)[0];let s=()=>!!((0,o.JL)()||(0,a.IG)("editorId")||(0,r.r_)("hoverTitle"));n()}catch(e){n(e)}})},20030:function(e,t,i){i.a(e,async function(e,n){try{i.d(t,{f:()=>d});var r=i(60542),o=i(9867),a=i(79988),l=i(40488),s=e([a,l]);[a,l]=s.then?(await s)():s;let d=()=>{if((0,r.JL)()||(0,o.IG)("editorId"))return!0;let e=(0,a.Kl)("currentElementTool");return!!l.Ci.includes(e)};n()}catch(e){n(e)}})},40488:function(e,t,i){i.a(e,async function(e,n){try{i.d(t,{B$:()=>x,Ci:()=>w,g4:()=>T,j3:()=>E,n3:()=>v,vq:()=>b,xZ:()=>y});var r=i(40340),o=i(41845),a=i(55887),l=i(13124),s=i(44975),d=i(8374),c=i(60542),u=i(79988),h=i(92827),f=i(98516),g=i(55638),m=i(81949),p=e([d,h,f,u,s,m]);[d,h,f,u,s,m]=p.then?(await p)():p;let y=[{type:r.Hd.Image,minWH:[1,1],maxWH:[8192,8192],rotationListening:!1,keepRatio:!0,func:e=>{let t=(0,d.E)(e.id),i=(0,u.Kl)("editingElementId")===e.id,n=(0,g.uE)("isQuickEditMode"),r=(0,h.hC)("showContrastElementId")===e.id,o=!t&&!i&&!n&&!r;return{anchorListening:o,edgeListening:o,rotationListening:!1}}},{type:r.Hd.Frame,minWH:[1,1],rotationListening:!1,anchorListening:!0,edgeListening:!0},{type:r.Hd.ChatFrame,minWH:[1,1],rotationListening:!1,anchorListening:!1,edgeListening:!1},{type:r.Hd.Generator,minWH:[o.q8,o.q8],maxWH:[o.Pc,o.Pc],func:e=>{if(a.lJ||(0,l.nI)(e.data.presetBaseModelId))return{rotationListening:!1,anchorListening:!1,edgeListening:!1}}},{type:r.Hd.Group,minWH:[1,1],rotationListening:!1,keepRatio:!0},{type:r.Hd.VectorGroup,minWH:[1,1],rotationListening:!1,keepRatio:!0},{type:r.Hd.ShapeSquare,minWH:[1,1]},{type:r.Hd.ShapeCircle,minWH:[1,1]},{type:r.Hd.Text,minWH:[1,1],keepRatio:!0},{type:r.Hd.Vector,minWH:[1,1]},{type:r.Hd.VideoGenerator,anchorListening:!1,edgeListening:!1,rotationListening:!1},{type:r.Hd.Video,minWH:[1,1],rotationListening:!1,keepRatio:!0},{type:r.Hd.ChatTaskPlaceholder,minWH:[1,1],anchorListening:!1,edgeListening:!1,rotationListening:!1}],v=()=>{let e=(0,u.Kl)("selection"),t={disableAnchor:!1,disableRotation:!0,disableEdge:!1};if(1!==e.length)return t;let i=(0,f.rI)(e[0]);if(!i)return t;let n=T(i);return n?{disableAnchor:!((null==n?void 0:n.anchorListening)??!0),disableRotation:!((null==n?void 0:n.rotationListening)??!0),disableEdge:!((null==n?void 0:n.edgeListening)??!0)}:t},w=["outpaint","removeBackground","smartRemove","smudge","inpaint","agentSelection","crop","selectAreaTool"],x=e=>{if(!(null==e?void 0:e.type)||"text"===e.type||"vector"===e.type)return!0;let t=(0,u.Kl)("currentElementTool");return!!w.includes(t)},b=e=>{if((0,c.JL)()||e)return!0;let t=(0,u.Kl)("currentElementTool");return!!w.includes(t)},E=["text",...s.L],T=e=>{let t=null==e?void 0:e.type,i=(0,m.eT)("config").find(e=>e.type===t),n={};(null==i?void 0:i.func)&&(n=i.func(e)||{});let r=(0,m.eT)("sceneGraph").findById(e.id),o=null==r?void 0:r.parent;return(null==o?void 0:o.type)==="chat_frame"?{type:t,edgeListening:!1,anchorListening:!1,rotationListening:!1}:{type:t,edgeListening:!0,anchorListening:!0,rotationListening:!0,keepRatio:!1,minWH:[-1/0,-1/0],maxWH:[1/0,1/0],...i,...n}};n()}catch(e){n(e)}})},22329:function(e,t,i){i.a(e,async function(e,n){try{i.d(t,{t:()=>h});var r=i(97458),o=i(7412),a=i(8171),l=i(31495),s=i(27065),d=i(52983),c=i(17296),u=e([a,l,c,s,o]);[a,l,c,s,o]=u.then?(await u)():u;let h=(0,d.memo)(()=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(a.M,{}),(0,r.jsx)(l.k,{}),(0,r.jsx)(c.Z,{}),(0,r.jsx)(s.f,{}),(0,r.jsx)(o.au,{})]}));h.displayName="SelectionRender",n()}catch(e){n(e)}})},16593:function(e,t,i){i.a(e,async function(e,n){try{i.d(t,{d:()=>l,o:()=>a});var r=i(97323),o=e([r]);r=(o.then?(await o)():o)[0];let a=(e,t,i,n)=>{r.l.batchUpdatePositions(i,e,t,n)},l=(e,t)=>{let i=[];for(let n of e){let e=t.findById(n);if(e){let t=e.getAbsolutePosition();i.push({id:e.id,type:e.type,x:t.x,y:t.y})}}return i};n()}catch(e){n(e)}})},53362:function(e,t,i){i.a(e,async function(e,n){try{i.d(t,{C:()=>h});var r=i(81042),o=i(15624),a=i(16703),l=i(50032),s=i(99160),d=i(75209),c=i(17918),u=e([l,s,d,c,a,o,r]);[l,s,d,c,a,o,r]=u.then?(await u)():u;let h=()=>{(0,l.PQ)(),(0,s.w)(),(0,d.F)(),(0,c.l)(),(0,a.U)(),(0,o.h)(),(0,r.wJ)()};n()}catch(e){n(e)}})},89701:function(e,t,i){i.d(t,{L:()=>s});let n='<g><path d="M10.3496 16.8571V22M10.3496 22H15.4925M10.3496 22L22.3496 10M22.3496 15.1429V10M22.3496 10H17.2068" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/><path d="M10.3496 16.8571V22M10.3496 22H15.4925M10.3496 22L22.3496 10M22.3496 15.1429V10M22.3496 10H17.2068" stroke="black" stroke-linecap="round" stroke-linejoin="round"/></g>',r='<g><path d="M21.1983 19.6376L24.8349 16.001M24.8349 16.001L21.1983 12.3645M24.8349 16.001L7.86433 16.001M11.5009 12.3645L7.86433 16.001M7.86433 16.001L11.5009 19.6376" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/><path d="M21.1983 19.6376L24.8349 16.001M24.8349 16.001L21.1983 12.3645M24.8349 16.001L7.86433 16.001M11.5009 12.3645L7.86433 16.001M7.86433 16.001L11.5009 19.6376" stroke="black" stroke-linecap="round" stroke-linejoin="round"/></g>',o='<g><path d="M20.8514 9.7725L23.5 12.4212M23.5 12.4212L20.8514 15.0698M23.5 12.4212C23.5 12.4212 21.6089 12.0427 19.7162 12.4212C17.8235 12.7997 15.9443 13.7046 14.4189 15.4482C12.8936 17.1919 12.3739 19.1127 12.1486 20.7455C11.9234 22.3783 12.1486 24.5293 12.1486 24.5293M12.1486 24.5293L14.7973 21.8806M12.1486 24.5293L9.5 21.8806" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/></g><path d="M20.8514 9.7725L23.5 12.4212M23.5 12.4212L20.8514 15.0698M23.5 12.4212C23.5 12.4212 21.6089 12.0427 19.7162 12.4212C17.8235 12.7997 15.9443 13.7046 14.4189 15.4482C12.8936 17.1919 12.3739 19.1127 12.1486 20.7455C11.9234 22.3783 12.1486 24.5293 12.1486 24.5293M12.1486 24.5293L14.7973 21.8806M12.1486 24.5293L9.5 21.8806" stroke="black" stroke-linecap="round" stroke-linejoin="round"/>';function a(e,t,i,n,r){let o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:16,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:16,l=Math.PI/180*(-i-t),s=Math.sin(l),d=Math.cos(l);return`url("data:image/svg+xml,<svg height='32' width='32' viewBox='0 0 32 32' xmlns='http://www.w3.org/2000/svg' style='color: ${r};'><defs><filter id='shadow' y='-40%' x='-40%' width='180px' height='180%' color-interpolation-filters='sRGB'><feDropShadow dx='${d-s}' dy='${+s+ +d}' stdDeviation='1.2' flood-opacity='.3'/></filter></defs><g fill='none' transform='rotate(${t+i} 16 16)${n?" scale(-1,-1) translate(0, -32)":""}' filter='url(%23shadow)'>`+e.replace(/"/g,"'")+`</g></svg>") ${o} ${a}, pointer`}let l={none:()=>"none","ew-resize":(e,t,i)=>a(r,e,0,t,i),"ns-resize":(e,t,i)=>a(r,e,90,t,i),"nesw-resize":(e,t,i)=>a(n,e,0,t,i),"nwse-resize":(e,t,i)=>a(n,e,90,t,i),"nwse-rotate":(e,t,i)=>a(o,e,0,t,i),"nesw-rotate":(e,t,i)=>a(o,e,90,t,i),"senw-rotate":(e,t,i)=>a(o,e,180,t,i),"swne-rotate":(e,t,i)=>a(o,e,270,t,i)};function s(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"black";return l[e](t,!1,i)}},75209:function(e,t,i){i.a(e,async function(e,n){try{i.d(t,{F:()=>m});var r=i(52983),o=i(79988),a=i(92827),l=i(81949),s=i(48024),d=i(75217),c=i(5969),u=i(96846),h=i(36509),f=i(30621),g=e([s,a,d,c,o,l,f]);[s,a,d,c,o,l,f]=g.then?(await g)():g;let m=()=>{let e=(0,l.Uq)("stage"),t=(0,r.useRef)({isDown:!1,stageX:0,stageY:0,isEnoughMove:!1,oldSelection:[]});(0,r.useEffect)(()=>{if(!e)return;let i=()=>{t.current.isDown=!0,t.current.isEnoughMove=!1;let i=e.getRelativePointerPosition(),n=(0,s.Eh)("hotId"),r=(0,s.Eh)("node"),u=(0,o.Kl)("currentCanvasTool"),h=(0,l.eT)("isOverLayerHover"),f=(0,a.hC)("readyForSelectImage");if(!i||n||r||(0,d.e)()||"select"!==u||h||f||(0,c.C)()){t.current.isDown=!1;return}t.current.stageX=i.x,t.current.stageY=i.y},n=i=>{if(!t.current.isDown)return;let n=(0,o.Kl)("viewport").scale,[r,a]=g(i),s=(0,u.W)(e,i);if(!s||!t.current.isDown)return;let[d,c]=[s.x-t.current.stageX,s.y-t.current.stageY],f=2/n;if(!t.current.isEnoughMove&&(Math.abs(d)>f||Math.abs(c)>f)&&(t.current.isEnoughMove=!0,t.current.oldSelection=(0,o.Kl)("selection"),(0,l.eT)("sceneGraph").syncFromProjectState(),(0,h.O0)({isGhostSelect:!0})),!t.current.isEnoughMove)return;if(0===r&&0===a){(0,h.O0)({node:{x:t.current.stageX,y:t.current.stageY,width:d,height:c}}),m();return}let[p,y]=[r,a].map(e=>0===e?0:e>0?100:-100),v=(0,o.Kl)("viewport");(0,o.L$)({viewport:{...v,x:v.x-p*n,y:v.y-y*n}}),(0,h.O0)({node:{x:t.current.stageX,y:t.current.stageY,width:d,height:c}}),m()},r=()=>{t.current.isDown&&t.current.isEnoughMove&&m(),t.current.isDown=!1,t.current.isEnoughMove=!1,(0,h.O0)({node:null,isGhostSelect:!1})},g=t=>{let[i,n]=[t.clientX,t.clientY],r=e.content,[o,a,l,s]=[r.offsetLeft,r.offsetTop,r.offsetWidth,r.offsetHeight],d=0,c=0;return i-=o,n-=a,i<=1&&(d=-1),n<=1&&(c=-1),i>l-2&&(d=2),n>s-2&&(c=2),[d,c]},m=()=>{let e=(0,h.Bi)("node");if(!e)return void(0,o.L$)({selection:[]});y(e)},y=e=>{let i=p(e),n=(0,l.eT)("sceneGraph").getIntersectingChildren(i).filter(e=>e.interactive);(0,f.u)({oldSelection:t.current.oldSelection,hitElements:n,ghostNode:i})};return e.on("mousedown",i),window.addEventListener("mousemove",n),window.addEventListener("mouseup",r),()=>{e.off("mousedown",i),window.removeEventListener("mousemove",n),window.removeEventListener("mouseup",r)}},[e])},p=e=>{let{x:t,y:i,width:n,height:r}=e;return n<0&&(t+=n,n=-n),r<0&&(i+=r,r=-r),{x:t,y:i,width:n,height:r,rotation:0}};n()}catch(e){n(e)}})},27065:function(e,t,i){i.a(e,async function(e,n){try{i.d(t,{f:()=>e});var r=i(97458),o=i(52983),a=i(30967),l=i(36509);let e=(0,o.memo)(()=>{let e=(0,l.fk)("node");return e?(0,r.jsx)(a.UL,{listening:!1,x:null==e?void 0:e.x,y:null==e?void 0:e.y,width:null==e?void 0:e.width,height:null==e?void 0:e.height,stroke:"#11B0FF",fill:"rgba(17, 176, 255, 0.1)",strokeWidth:1,strokeScaleEnabled:!1}):null});e.displayName="GhostSelectionRect",n()}catch(e){n(e)}})},36509:function(e,t,i){i.d(t,{Bi:()=>s,O0:()=>l,fk:()=>a});var n=i(80413),r=i(98830);let o=(0,n.F)()(()=>({isGhostSelect:!1,node:null})),{useStore:a,setState:l,getState:s}=(0,r.b)(o)},8171:function(e,t,i){i.a(e,async function(e,n){try{i.d(t,{M:()=>g});var r=i(97458),o=i(52983),a=i(30967),l=i(79988),s=i(48024),d=i(81949),c=i(99608),u=i(20030),h=i(9867),f=e([s,c,l,d,u]);[s,c,l,d,u]=f.then?(await f)():f;let g=(0,o.memo)(()=>{let e=(0,s.L8)("node"),t=(0,d.eT)("sceneGraph").findById(null==e?void 0:e.id),i=(0,c.BT)("isTransforming"),n=(0,l.eD)("currentCanvasTool"),o=(0,d.Uq)("moveInFrameNode"),f=(0,d.Uq)("isDragging");return(0,h.qQ)("editorId")?null:o?(0,r.jsx)(a.UL,{listening:!1,x:null==o?void 0:o.x,y:null==o?void 0:o.y,width:null==o?void 0:o.width,height:null==o?void 0:o.height,stroke:"#11B0FF",rotation:null==o?void 0:o.rotation,strokeWidth:2,strokeScaleEnabled:!1}):!(null==e?void 0:e.type)||"text"===e.type||(null==t?void 0:t.isVector)||(0,u.f)()||i||"select"!==n||f?null:"vector_group"===e.type&&e.data.fillGeometry.length?(0,r.jsx)(a.y$,{data:e.data.fillGeometry.map(e=>e.data).join(" "),stroke:"#11B0FF",strokeWidth:2,strokeScaleEnabled:!1,listening:!1,rotation:null==e?void 0:e.rotation,x:null==e?void 0:e.x,y:null==e?void 0:e.y,width:null==e?void 0:e.width,height:null==e?void 0:e.height}):"shape_circle"===e.type?(0,r.jsx)(a.Pj,{listening:!1,x:null==e?void 0:e.x,y:null==e?void 0:e.y,radiusX:(null==e?void 0:e.width)/2,radiusY:(null==e?void 0:e.height)/2,offsetX:-(null==e?void 0:e.width)/2,offsetY:-(null==e?void 0:e.height)/2,stroke:"#11B0FF",rotation:null==e?void 0:e.rotation,strokeWidth:2,strokeScaleEnabled:!1}):(0,r.jsx)(a.UL,{id:"selection-hover-box",listening:!1,x:null==e?void 0:e.x,y:null==e?void 0:e.y,width:null==e?void 0:e.width,height:null==e?void 0:e.height,stroke:"#11B0FF",rotation:null==e?void 0:e.rotation,strokeWidth:2,strokeScaleEnabled:!1})});g.displayName="HoverSelectionRect",n()}catch(e){n(e)}})},48024:function(e,t,i){i.a(e,async function(e,n){try{i.d(t,{BN:()=>c,Eh:()=>u,L8:()=>d,wl:()=>f});var r=i(80413),o=i(92827),a=i(98830),l=e([o]);o=(l.then?(await l)():l)[0];let s=(0,r.F)()(()=>({node:null,hotId:"",level:0})),{useStore:d,setState:c,getState:u}=(0,a.b)(s),h=e=>{(0,o.hC)("hoveringElementId")!==e&&(0,o.qb)({hoveringElementId:e})},f=e=>{if(!e){c({node:null}),h(null);return}if("group"===e.type){c({node:{...null==e?void 0:e.originElement,...null==e?void 0:e.getDescendantsNonGroupBounds()}}),h(e.id);return}c({node:{...null==e?void 0:e.originElement,...null==e?void 0:e.getAbsoluteTransform()}}),h(e.id)};n()}catch(e){n(e)}})},99160:function(e,t,i){i.a(e,async function(e,n){try{i.d(t,{w:()=>b});var r=i(52983),o=i(60085),a=i(49605),l=i(37801),s=i(1842),d=i(21417),c=i(79988),u=i(81949),h=i(48024),f=i(96846),g=i(99608),m=i(17373),p=i(40488),y=i(36105),v=i(97323),w=i(89701),x=e([h,g,m,l,u,v,d,s,p,c]);[h,g,m,l,u,v,d,s,p,c]=x.then?(await x)():x;let b=()=>{let e=(0,u.Uq)("stage"),t=(0,c.eD)("selection"),i=(0,r.useRef)({isDown:!1,stageX:0,stageY:0,currentStageX:0,currentStageY:0,isEnoughMove:!1,hotId:"",oldBoxNode:{},oldBoxNodes:[],elements:[],oldElements:[],isShiftPressed:!1,needKeepRatio:!1,isCommandPressed:!1,fastCropImageInfo:null});(0,r.useEffect)(()=>{if(!e)return;let t=t=>{i.current.isDown=!0,i.current.isEnoughMove=!1;let n=e.getRelativePointerPosition(),r=(0,h.Eh)("hotId"),o=(0,c.Kl)("selection"),a=(0,c.Kl)("currentCanvasTool"),s=(0,u.eT)("isOverLayerHover");if(!n||!r||!o.length||"select"!==a||s){i.current.isDown=!1;return}i.current.stageX=n.x,i.current.stageY=n.y,i.current.hotId=r,i.current.fastCropImageInfo=(0,l.RL)(),(0,u.ff)({isTransforming:!0})},n=t=>{if(!i.current.isDown)return;let n=(0,f.W)(e,t);if(!n||!i.current.isDown)return;let r=(0,c.Kl)("viewport").scale;i.current.currentStageX=n.x,i.current.currentStageY=n.y,i.current.isShiftPressed=t.shiftKey,i.current.isCommandPressed=t.metaKey||t.ctrlKey;let[o,l]=[n.x-i.current.stageX,n.y-i.current.stageY],s=2/r;if(!i.current.isEnoughMove&&(Math.abs(o)>s||Math.abs(l)>s)){let e=(0,g.M4)("dragNodeId"),t=(0,g.M4)("nodes"),n=t.find(t=>t.id===e),r=(0,u.eT)("sceneGraph");r.syncFromProjectState(),r.startDragging(),n&&(i.current.oldBoxNode=k(r,[n])[0],i.current.oldBoxNodes=k(r,t),i.current.elements=R(r),i.current.oldElements=R(r,!0),i.current.needKeepRatio=(0,c.Kl)("selection").some(e=>e.startsWith("element-group"))),i.current.isEnoughMove=!0,a.z.emit("selection:transformStart",{})}i.current.isEnoughMove&&T(t)},r=e=>{i.current.isDown&&i.current.isEnoughMove&&(a.z.emit("selection:transformEnd",{}),(0,u.eT)("sceneGraph").endDragging()),i.current.isDown=!1,i.current.isEnoughMove=!1,i.current.hotId="",i.current.isShiftPressed=!1,i.current.isCommandPressed=!1,i.current.fastCropImageInfo=null,(0,u.ff)({isTransforming:!1})},o=e=>{i.current.isDown&&i.current.isEnoughMove&&"Shift"===e.key&&!i.current.isShiftPressed&&(i.current.isShiftPressed=!0,T(e))},s=e=>{i.current.isDown&&i.current.isEnoughMove&&"Shift"===e.key&&i.current.isShiftPressed&&(i.current.isShiftPressed=!1,T(e))},d=e=>{i.current.isDown&&i.current.isEnoughMove&&("Control"===e.key||"Meta"===e.key)&&!i.current.isCommandPressed&&(i.current.isCommandPressed=!0,T(e))},m=e=>{i.current.isDown&&i.current.isEnoughMove&&("Control"===e.key||"Meta"===e.key)&&i.current.isCommandPressed&&(i.current.isCommandPressed=!1,T(e))};return e.on("mousedown",t),window.addEventListener("mousemove",n),window.addEventListener("mouseup",r),window.addEventListener("keydown",o),window.addEventListener("keyup",s),window.addEventListener("keydown",d),window.addEventListener("keyup",m),()=>{e.off("mousedown",t),window.removeEventListener("mousemove",n),window.removeEventListener("mouseup",r),window.removeEventListener("keydown",o),window.removeEventListener("keyup",s),window.removeEventListener("keydown",d),window.removeEventListener("keyup",m)}},[e]),(0,r.useEffect)(()=>{(0,m.y)()},[t]);let n=function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=i*Math.PI/180,r=Math.cos(n),o=Math.sin(n);return[e*r+t*o,-e*o+t*r]},x=(e,t,i,n,r)=>{if(r.includes("anchor")){let o=Math.sqrt(i.width*i.width+i.height*i.height),a=Math.sqrt(e*e+t*t);if(!i.rotation){let n=e/i.width,l=t/i.height,c=Math.max(n,l);a=o*c,e=i.width*c,t=i.height*c;let u={left:i.x,right:i.x+i.width,top:i.y,bottom:i.y+i.height},[h,f]=[0,0];switch(r){case"anchor-top-left":u.left=u.right-e,u.top=u.bottom-t,[h,f]=(0,d.Z)(u,[s.MR.LEFT,s.MR.TOP]),u.left=u.left+h,u.top=u.top+f;break;case"anchor-top-right":u.right=u.left+e,u.top=u.bottom-t,[h,f]=(0,d.Z)(u,[s.MR.RIGHT,s.MR.TOP]),u.right=u.right+h,u.top=u.top+f;break;case"anchor-bottom-left":u.left=u.right-e,u.bottom=u.top+t,[h,f]=(0,d.Z)(u,[s.MR.LEFT,s.MR.BOTTOM]),u.left=u.left+h,u.bottom=u.bottom+f;break;case"anchor-bottom-right":u.right=u.left+e,u.bottom=u.top+t,[h,f]=(0,d.Z)(u,[s.MR.RIGHT,s.MR.BOTTOM]),u.right=u.right+h,u.bottom=u.bottom+f}let g=u.right-u.left,m=u.bottom-u.top;if(0!==h){let e=g/i.width,t=i.height*e;a=Math.sqrt(g*g+t*t)}else if(0!==f){let e=m/i.height,t=i.width*e;a=Math.sqrt(t*t+m*m)}}let l=a/o;return b(l,i,n)}else{let o=r.includes("right")||r.includes("left")?e/i.width:t/i.height;if(!i.rotation){let n={left:i.x,right:i.x+i.width,top:i.y,bottom:i.y+i.height},[a,l]=[0,0];switch(r){case"border-right":n.right=n.left+e,[a,l]=(0,d.Z)(n,[s.MR.RIGHT]),n.right=n.right+a;break;case"border-bottom":n.bottom=n.top+t,[a,l]=(0,d.Z)(n,[s.MR.BOTTOM]),n.bottom=n.bottom+l;break;case"border-left":n.left=n.right-e,[a,l]=(0,d.Z)(n,[s.MR.LEFT]),n.left=n.left+a;break;case"border-top":n.top=n.bottom-t,[a,l]=(0,d.Z)(n,[s.MR.TOP]),n.top=n.top+l}0!==a?o=(n.right-n.left)/i.width:0!==l&&(o=(n.bottom-n.top)/i.height)}return b(o,i,n)}},b=(e,t,i)=>{let n=t.width*e,r=t.height*e,o=i.maxWH[0]/t.width,a=i.maxWH[1]/t.height,l=i.minWH[0]/t.width,s=i.minWH[1]/t.height,d=e;return(n>i.maxWH[0]||r>i.maxWH[1])&&(d=Math.min(o,a,e)),(n<i.minWH[0]||r<i.minWH[1])&&(d=Math.max(l,s,e)),{width:t.width*d,height:t.height*d}},E=(e,t)=>{let i=(0,u.eT)("stage"),n={"rotation-top-left":"nwse-rotate","rotation-top-right":"nesw-rotate","rotation-bottom-right":"senw-rotate","rotation-bottom-left":"swne-rotate"}[e];n&&(i.content.style.cursor=(0,w.L)(n,t))},T=e=>{let{elements:t,isShiftPressed:r}=i.current;if(!(null==t?void 0:t.length))return;if(1===t.length)return void(e=>{var t;let r,a,c,u,h,f,g,m=i.current.elements[0],w=(0,p.g4)(m),b=i.current.oldElements[0],{hotId:T,currentStageX:k,currentStageY:R,stageX:S,stageY:I,isShiftPressed:P,isCommandPressed:A,fastCropImageInfo:C}=i.current,D=(0,l.be)(m,A,C),M=D!==l.CD.Init;if(r=T,a=w,r.includes("border")&&!a.edgeListening||r.includes("anchor")&&!a.anchorListening||r.includes("rotation")&&!a.rotationListening)return;let F=new o.Transform;F.reset();let L=null==b||null==(t=b.tr)?void 0:t.copy(),N=(0,y.C)(b),[_,B]=[k-S,R-I],[O,G]=n(_,B,(null==b?void 0:b.rotation)||0),j=D!==l.CD.CropImage&&(P||w.keepRatio),{width:U,height:H}=((e,t,i,n,r)=>{let o={left:t.x,right:t.x+t.width,top:t.y,bottom:t.y+t.height};switch(e){case"border-right":o.right=o.right+i;break;case"border-bottom":o.bottom=o.bottom+n;break;case"border-left":o.left=o.left+i;break;case"border-top":o.top=o.top+n;break;case"anchor-top-left":o.left=o.left+i,o.top=o.top+n;break;case"anchor-top-right":o.right=o.right+i,o.top=o.top+n;break;case"anchor-bottom-left":o.left=o.left+i,o.bottom=o.bottom+n;break;case"anchor-bottom-right":o.right=o.right+i,o.bottom=o.bottom+n}let[a,l]=[0,0];if(!r&&!e.includes("rotation")&&!t.rotation)switch(e){case"border-right":[a,l]=(0,d.Z)(o,[s.MR.RIGHT]),o.right=o.right+a;break;case"border-bottom":[a,l]=(0,d.Z)(o,[s.MR.BOTTOM]),o.bottom=o.bottom+l;break;case"border-left":[a,l]=(0,d.Z)(o,[s.MR.LEFT]),o.left=o.left+a;break;case"border-top":[a,l]=(0,d.Z)(o,[s.MR.TOP]),o.top=o.top+l;break;case"anchor-top-left":[a,l]=(0,d.Z)(o,[s.MR.LEFT,s.MR.TOP]),o.left=o.left+a,o.top=o.top+l;break;case"anchor-top-right":[a,l]=(0,d.Z)(o,[s.MR.RIGHT,s.MR.TOP]),o.right=o.right+a,o.top=o.top+l;break;case"anchor-bottom-left":[a,l]=(0,d.Z)(o,[s.MR.LEFT,s.MR.BOTTOM]),o.left=o.left+a,o.bottom=o.bottom+l;break;case"anchor-bottom-right":[a,l]=(0,d.Z)(o,[s.MR.RIGHT,s.MR.BOTTOM]),o.right=o.right+a,o.bottom=o.bottom+l}return{width:o.right-o.left,height:o.bottom-o.top}})(T,b,O,G,j);({width:U,height:H}=(c=U,u=H,h=b,f={...w,keepRatio:j},g=T,(c=Math.max(f.minWH[0],Math.min(f.maxWH[0],c)),u=Math.max(f.minWH[1],Math.min(f.maxWH[1],u)),f.keepRatio&&!g.includes("rotation"))?x(c,u,h,f,g):{width:c,height:u})),((e,t,i,n,r)=>{let o=i.width-n,a=i.height-r;switch(t){case"border-left":e.translate(o,(i.height-r)/2);break;case"border-right":e.translate(0,(i.height-r)/2);break;case"border-top":e.translate((i.width-n)/2,a);break;case"border-bottom":e.translate((i.width-n)/2,0);break;case"anchor-top-left":e.translate(o,a);break;case"anchor-top-right":e.translate(0,a);break;case"anchor-bottom-left":e.translate(o,0)}})(F,T,b,U,H),T.includes("rotation")&&(((e,t,n,r,o,a)=>{let l=n.width/2,s=n.height/2,{x:d,y:c}=a.copy().invert().point({x:r,y:o}),u=180*Math.atan2(c-s,d-l)/Math.PI,h={"rotation-top-left":180*Math.atan2(-s,-l)/Math.PI,"rotation-top-right":180*Math.atan2(-s,l)/Math.PI,"rotation-bottom-left":180*Math.atan2(s,-l)/Math.PI,"rotation-bottom-right":180*Math.atan2(s,l)/Math.PI}[t]||0,f=u-h;f=(f+360)%360,i.current.isShiftPressed&&(f=15*Math.round(f/15)),e.translate(l,s),e.rotate(Math.PI/180*f),e.translate(-l,-s),E(t,n.rotation+f)})(F,T,b,k,R,L),U=b.width,H=b.height),v.l.updateSingleElement({element:m,relativeTransform:N,changeTransform:F,width:U,height:H},M?C:null)})(0);let a=t.some(e=>0!==e.rotation),c=t.some(e=>(0,p.g4)(e).keepRatio);if(a||c||r)return void(()=>{let e=i.current.oldBoxNode,{hotId:t,currentStageX:n,currentStageY:r,stageX:o,stageY:a}=i.current,[l,c]=[n-o,r-a],u=((e,t,i,n)=>{let r=1,o={left:t.x,right:t.x+t.width,top:t.y,bottom:t.y+t.height},[a,l]=[0,0];if("border-right"===e)o.right=o.right+i,[a,l]=(0,d.Z)(o,[s.MR.RIGHT]),o.right=o.right+a,r=(o.right-o.left)/t.width;else if("border-bottom"===e)o.bottom=o.bottom+n,[a,l]=(0,d.Z)(o,[s.MR.BOTTOM]),o.bottom=o.bottom+l,r=(o.bottom-o.top)/t.height;else if("border-left"===e)o.left=o.left+i,[a,l]=(0,d.Z)(o,[s.MR.LEFT]),o.left=o.left+a,r=(o.right-o.left)/t.width;else if("border-top"===e)o.top=o.top+n,[a,l]=(0,d.Z)(o,[s.MR.TOP]),o.top=o.top+l,r=(o.bottom-o.top)/t.height;else if(e.includes("anchor")){let c=i;e.includes("left")&&(c=-i);let u=n;e.includes("top")&&(u=-n);let h=t.width+c,f=t.height+u,g=h/t.width,m=f/t.height;switch(r=Math.max(g,m),h=t.width*r,f=t.height*r,e){case"anchor-top-left":o.left=o.right-h,o.top=o.bottom-f,[a,l]=(0,d.Z)(o,[s.MR.LEFT,s.MR.TOP]),o.left=o.left+a,o.top=o.top+l;break;case"anchor-top-right":o.right=o.left+h,o.top=o.bottom-f,[a,l]=(0,d.Z)(o,[s.MR.RIGHT,s.MR.TOP]),o.right=o.right+a,o.top=o.top+l;break;case"anchor-bottom-left":o.left=o.right-h,o.bottom=o.top+f,[a,l]=(0,d.Z)(o,[s.MR.LEFT,s.MR.BOTTOM]),o.left=o.left+a,o.bottom=o.bottom+l;break;case"anchor-bottom-right":o.right=o.left+h,o.bottom=o.top+f,[a,l]=(0,d.Z)(o,[s.MR.RIGHT,s.MR.BOTTOM]),o.right=o.right+a,o.bottom=o.bottom+l}let p=o.right-o.left,y=o.bottom-o.top;0!==a?r=p/t.width:0!==l&&(r=y/t.height)}return r})(t,e,l,c),h=(e=>{let t=e;for(let n of i.current.elements){let r=i.current.oldElements.find(e=>e.id===n.id);if(!r)continue;let o=(0,p.g4)(n),a=r.width*e,l=r.height*e;if(o.minWH&&void 0!==o.minWH[0]&&a<o.minWH[0]){let e=o.minWH[0]/r.width;t=Math.max(t,e)}if(o.maxWH&&void 0!==o.maxWH[0]&&a>o.maxWH[0]){let e=o.maxWH[0]/r.width;t=Math.min(t,e)}if(o.minWH&&void 0!==o.minWH[1]&&l<o.minWH[1]){let e=o.minWH[1]/r.height;t=Math.max(t,e)}if(o.maxWH&&void 0!==o.maxWH[1]&&l>o.maxWH[1]){let e=o.maxWH[1]/r.height;t=Math.min(t,e)}}return t})(u);v.l.batchUpdateKeepRatio(i.current.elements,i.current.oldElements,i.current.oldBoxNodes,h,t,u)})();(()=>{let e=i.current.oldBoxNode,{hotId:t,currentStageX:n,currentStageY:r,stageX:o,stageY:a}=i.current,[l,s]=[n-o,r-a],{deltaX:d,deltaY:c}=((e,t,i,n)=>{let r=1,o=1;switch(e){case"border-right":r=(t.width+i)/t.width;break;case"border-bottom":o=(t.height+n)/t.height;break;case"border-left":r=(t.width-i)/t.width;break;case"border-top":o=(t.height-n)/t.height;break;case"anchor-top-left":r=(t.width-i)/t.width,o=(t.height-n)/t.height;break;case"anchor-top-right":r=(t.width+i)/t.width,o=(t.height-n)/t.height;break;case"anchor-bottom-left":r=(t.width-i)/t.width,o=(t.height+n)/t.height;break;case"anchor-bottom-right":r=(t.width+i)/t.width,o=(t.height+n)/t.height}return{deltaX:r,deltaY:o}})(t,e,l,s),u=((e,t)=>{let n=e,r=t;for(let o of i.current.elements){let a=i.current.oldElements.find(e=>e.id===o.id);if(!a)continue;let l=(0,p.g4)(o),s=a.width*e,d=a.height*t;if(l.minWH&&void 0!==l.minWH[0]&&s<l.minWH[0]){let e=l.minWH[0]/a.width;n=Math.max(n,e)}if(l.maxWH&&void 0!==l.maxWH[0]&&s>l.maxWH[0]){let e=l.maxWH[0]/a.width;n=Math.min(n,e)}if(l.minWH&&void 0!==l.minWH[1]&&d<l.minWH[1]){let e=l.minWH[1]/a.height;r=Math.max(r,e)}if(l.maxWH&&void 0!==l.maxWH[1]&&d>l.maxWH[1]){let e=l.maxWH[1]/a.height;r=Math.min(r,e)}}return{deltaX:n,deltaY:r}})(d,c),h=u.deltaX,f=u.deltaY;v.l.batchUpdateMultipleTransform(i.current.elements,i.current.oldElements,i.current.oldBoxNodes,h,f,t,d,c)})()},k=(e,t)=>t.map(t=>{let i=t.selection,n=new Set;for(let t of i){let i=e.findById(t);if(i.isGroup()){for(let e of i.getDescendants())e.isGroup()||n.add(e.id);continue}n.add(i.id)}return{...t,selection:Array.from(n)}}),R=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=new Set;for(let t of(0,c.Kl)("selection")){let n=e.findById(t);if(n.isGroup()){for(let e of n.getDescendants())e.isGroup()||i.add(e);continue}i.add(n)}let n=Array.from(i);return t?n.map(e=>({...e.originElement,tr:e.getAbsoluteTransformMatrix().copy(),hasParent:"sceneGraph"!==e.parent.type})):n.map(e=>e.originElement)}};n()}catch(e){n(e)}})},31495:function(e,t,i){i.a(e,async function(e,n){try{i.d(t,{k:()=>y});var r=i(97458),o=i(52983),a=i(30967),l=i(35040),s=i(55887),d=i(9867),c=i(79988),u=i(98516),h=i(99608),f=i(81949),g=i(40488),m=e([f,h,c,u,g]);[f,h,c,u,g]=m.then?(await m)():m;let p=new Set([l.PQ.Crop,l.PQ.SplitLayer,l.PQ.Outpaint]),y=(0,o.memo)(()=>{let e=(0,f.Uq)("isDragging"),t=(0,h.BT)("nodes"),i=(0,h.BT)("innerNodes"),n=(0,c.eD)("viewport").scale,o=(0,c.eD)("selection"),l=(0,d.qQ)("editorId"),m=(0,c.eD)("currentElementTool"),y=p.has(m);if(e||y)return null;let w=(()=>{if(1!==o.length)return!1;let e=(0,u.rI)(o[0]);if(!e)return!1;if(null==e?void 0:e.locked)return!0;let t=(0,g.g4)(e);return!t.edgeListening&&!t.anchorListening&&!t.rotationListening})();return(0,r.jsxs)(a.ZA,{listening:!1,children:[i.map((e,t)=>(0,g.B$)(e)?(0,r.jsx)(r.Fragment,{}):(0,r.jsx)(a.UL,{x:e.x,y:e.y,width:e.width,height:e.height,rotation:e.rotation,stroke:"#11B0FF",strokeWidth:1/n,listening:!1},`selection-inner-${e.id}-${t}`)),(0,g.vq)(l)?(0,r.jsx)(r.Fragment,{}):t.map(e=>{var t;let i="bottom";e.rotation<-45&&e.rotation>-135?i="left":e.rotation>45&&e.rotation<135?i="right":(e.rotation>135||e.rotation<-135)&&(i="top");let o=null==(t=e.selection)?void 0:t.every(e=>e.startsWith("element-text-")),l=5/n,d=18/n;return(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)(a.ZA,{x:e.x,y:e.y,rotation:e.rotation,children:[(0,r.jsx)(a.UL,{x:0,y:0,width:e.width,height:e.height,stroke:"#11B0FF",strokeWidth:1/n}),(w?[]:[{x:0,y:0},{x:e.width,y:0},{x:0,y:e.height},{x:e.width,y:e.height}]).map((t,i)=>(0,r.jsx)(a.Cd,{x:t.x,y:t.y,radius:4/n,fill:"#FFFFFF",stroke:"#11B0FF",strokeWidth:1/n,listening:!1},`selection-nodeAnchor-${e.id}-${i}`)),o&&e.height*n>24&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(a.UL,{x:-l/2,y:e.height/2-d/2,cornerRadius:l,width:l,height:d,stroke:"#11B0FF",fill:"#FFFFFF",strokeWidth:1/n}),(0,r.jsx)(a.UL,{x:e.width-l/2,cornerRadius:l,y:e.height/2-d/2,width:l,height:d,stroke:"#11B0FF",fill:"#FFFFFF",strokeWidth:1/n})]}),!s.lJ&&(0,r.jsx)(v,{node:e,direction:i})]},`selection-outer-${e.id}`)})})]})});y.displayName="SelectionBoxRects";let v=(0,o.memo)(e=>{let{node:t,direction:i,scale:n}=e,l=(0,o.useRef)(null),s=`${Math.round(t.width)} \xd7 ${Math.round(t.height)}`,d=10/n,c=10*s.length/n,u=5/n,h=3/n,[f,g]=(0,o.useState)(0),m=0,p=0,y=1,v=1,w=0,x=0,b=0;return(0,o.useEffect)(()=>{l.current&&g(l.current.textWidth)},[s,n]),"bottom"===i?(p=t.height+8/n,w=-(t.width-c)/2,x=-(t.width-f)/2):"top"===i?(p=-8/n,w=(t.width+c)/2,x=(t.width+f)/2,v=-1,y=-1):"left"===i?(m=-8/n,w=-(t.height-c)/2,x=-(t.height-f)/2,b=90):"right"===i&&(m=t.width+8/n,p=t.height,w=-(t.height-c)/2,x=-(t.height-f)/2,b=-90),(0,r.jsxs)(a.ZA,{x:m,y:p,scaleX:y,scaleY:v,rotation:b,children:[(0,r.jsx)(a.UL,{offsetX:x,offsetY:0,x:-u,y:-h,width:f+2*u,height:d+2*h,fill:"#0CA0EB",listening:!1,cornerRadius:4/n}),(0,r.jsx)(a.xv,{offsetX:w,offsetY:-.5/n,ref:l,text:s,fontSize:d,fill:"#fff",align:"center",width:c,listening:!1,fontFamily:"PingFang SC"})]})});v.displayName="RenderOuterLabel",n()}catch(e){n(e)}})},99608:function(e,t,i){i.a(e,async function(e,n){try{i.d(t,{A_:()=>d,BT:()=>c,M4:()=>h,TG:()=>f,wV:()=>u});var r=i(80413),o=i(79988),a=i(98830),l=e([o]);o=(l.then?(await l)():l)[0];let s=(0,r.F)()(()=>({renderDep:!1,nodes:[],innerNodes:[],dragNodeId:""})),d=()=>{u({nodes:[],innerNodes:[]})},{useStore:c,setState:u,getState:h}=(0,a.b)(s),f=()=>{let e=h("nodes").find(e=>e.selection.includes(h("dragNodeId")));return(null==e?void 0:e.selection)??(0,o.Kl)("selection")};n()}catch(e){n(e)}})},72931:function(e,t,i){i.a(e,async function(e,n){try{i.d(t,{B:()=>l,M:()=>s});var r=i(79988),o=i(81949),a=e([r,o]);[r,o]=a.then?(await a)():a;let l=["frame","chat_frame"],s=()=>{let e=(0,r.Kl)("elements"),t=(0,r.Kl)("selection");if(!(null==e?void 0:e.length))return null;let i=(0,o.eT)("stage"),n=null==i?void 0:i.getRelativePointerPosition();if(!n)return null;let{x:a,y:s}=n,d=e.length;for(let i=d-1;i>=0;i--){let n=e[i];if(t.includes(n.id)){if(l.includes(n.type))return null;continue}if(l.includes(n.type)){let{x:e,y:t,width:i,height:r}=n;if(a>=e&&a<=e+i&&s>=t&&s<=t+r)return null==n?void 0:n.id}}return null};n()}catch(e){n(e)}})},5969:function(e,t,i){i.a(e,async function(e,n){try{i.d(t,{C:()=>u});var r=i(81949),o=i(99608),a=i(17373),l=i(36105),s=i(19034),d=i(50032),c=e([a,o,r,d,s]);[a,o,r,d,s]=c.then?(await c)():c;let u=()=>{(0,a.y)();let e=(0,o.M4)("nodes"),t=(0,r.eT)("stage").getRelativePointerPosition();if(!t)return null;let i=(0,d._B)();for(let n of e){if((null==i?void 0:i.id)&&n.selection.includes(null==i?void 0:i.id))return n;let e=(0,l.C)(n).invert().point(t);if((0,s.fG)(e,{x:0,y:0,width:n.width,height:n.height}))return n}return null};n()}catch(e){n(e)}})},30621:function(e,t,i){i.a(e,async function(e,n){try{i.d(t,{u:()=>h});var r=i(39378),o=i.n(r),a=i(66969),l=i(79988),s=i(31353),d=i(81949),c=i(72931),u=e([d,a,c,l,s]);[d,a,c,l,s]=u.then?(await u)():u;let h=e=>{let{oldSelection:t,hitElements:i,ghostNode:n}=e,r=(0,d.eT)("sceneGraph"),u=t.map(e=>null==r?void 0:r.findById(e)),h=u.map(e=>null==e?void 0:e.getDepthOfGroup()),f=Math.max(...h,0),g=(0,a.rB)("shift");if(!(null==i?void 0:i.length)&&!g)return void(0,s.e3)([]);let m=i.filter(e=>c.B.includes(e.type));if(m)for(let e of m){var p;if(n&&e.isContainedInRect(n)){i=i.filter(t=>!t.isDescendantOf(e));let n=e.getDescendants();t=t.filter(e=>!n.some(t=>t.id===e));continue}if(n&&(null==(p=e.children)?void 0:p.length)){i=i.filter(t=>t!==e),t=t.filter(t=>t!==e.id);continue}}let y=i.filter(e=>"group"===e.type);if(y)for(let e of y){let t=e.getDepthOfGroup();if(t>f){i=i.filter(t=>t.id!==e.id&&!t.isDescendantOf(e));continue}t===f&&(i=i.filter(t=>!t.isDescendantOf(e))),n&&(e.getDescendants().filter(e=>"group"!==e.type&&e.interactive).some(e=>e.intersectsRect(n))||(i=i.filter(t=>t.id!==e.id)))}g&&(i=i.filter(e=>!u.some(t=>e.isDescendantOf(t)&&e.interactive)));let v=i.map(e=>e.id);if((0,l.KW)(),g){let e=o().xor(t,v),i=r.findByIds(e).filter(e=>e.interactive);(0,s.e3)(i.map(e=>e.id))}else(0,s.e3)(v)};n()}catch(e){n(e)}})},19034:function(e,t,i){i.a(e,async function(e,n){try{function r(e,t){return e.x>=t.x&&e.x<=t.x+t.width&&e.y>=t.y&&e.y<=t.y+t.height}i.d(t,{fG:()=>r}),n()}catch(e){n(e)}})},36105:function(e,t,i){i.d(t,{C:()=>r});var n=i(60085);let r=e=>{let{x:t,y:i,rotation:r=0,scaleX:o=1,scaleY:a=1,skewX:l=0,skewY:s=0,offsetX:d=0,offsetY:c=0}=e,u=new n.Transform;return u.reset(),(0!==t||0!==i)&&u.translate(t,i),0!==r&&u.rotate(r*Math.PI/180),(0!==l||0!==s)&&u.skew(l,s),(1!==o||1!==a)&&u.scale(o,a),(0!==d||0!==c)&&u.translate(-1*d,-1*c),u}},96846:function(e,t,i){i.d(t,{W:()=>n});let n=(e,t)=>{var i;let n=null==e||null==(i=e.container())?void 0:i.getBoundingClientRect();if(!n)return null==e?void 0:e.getRelativePointerPosition();let r=t.clientX-n.left,o=t.clientY-n.top;return e.getAbsoluteTransform().copy().invert().point({x:r,y:o})}},17296:function(e,t,i){i.a(e,async function(e,n){try{i.d(t,{Z:()=>u});var r=i(97458),o=i(9867),a=i(621),l=i(98516),s=i(30967),d=e([a,l]);[a,l]=d.then?(await d)():d;let c=()=>{let e=(0,o.qQ)("editorId"),t=(0,o.qQ)("selectBox"),{scale:i}=(0,a.useViewport)();return e&&(0,l.rI)(e)&&t.length?(0,r.jsx)(s.UL,{x:t[0],y:t[1],width:t[2]-t[0],height:t[3]-t[1],stroke:"rgba(48, 148, 248, 1)",fill:"rgba(48, 148, 248, 0.1)",listening:!1,strokeWidth:1/i}):null};c.displayName="VectorEditorSelection";let u=c;n()}catch(e){n(e)}})},4521:function(e,t,i){i.d(t,{KR:()=>s,RN:()=>l,UA:()=>a});var n,r,o,a=((n={}).Generating="task-generating",n.Waiting="task-waiting",n),l=((r={}).TabEditSelection="tab-edit-selection",r.TabEditSingle="tab-edit-single",r.TabEditMulti="tab-edit-multi",r.TabEditFrame="tab-edit-frame",r),s=((o={}).Generator="generator",o.Agent="agent",o.Custom="custom",o)},19367:function(e,t,i){i.a(e,async function(e,n){try{i.d(t,{X:()=>d});var r=i(47774),o=i(85682),a=i(141),l=i(34714),s=e([l,o,a]);function d(){let e=(0,l.Z)(),t=(0,o.J)(),i=(0,a.J)();return[...e,...t,...i].filter(e=>!!e.taskId&&(0,r.hj)(e.x)&&(0,r.hj)(e.y)&&(0,r.hj)(e.width)&&(0,r.hj)(e.height))}[l,o,a]=s.then?(await s)():s,n()}catch(e){n(e)}})},85682:function(e,t,i){i.a(e,async function(e,n){try{i.d(t,{J:()=>s});var r=i(10057),o=i(4521),a=i(8725),l=e([r]);function s(){return(0,r.F)().map((e,t)=>{let{x:i,y:n,width:r,height:l,count:s=1,sourceElementId:d,threadId:c}=e,u=Array.from({length:s}).map(()=>({...e,index:t}));return(0,a.H)({taskType:o.UA.Generating,taskSource:o.KR.Agent,x:i,y:n,width:r,height:l,count:s,taskData:e,subTasks:u,sourceElementId:d,threadId:c})})}r=(l.then?(await l)():l)[0],n()}catch(e){n(e)}})},141:function(e,t,i){i.a(e,async function(e,n){try{i.d(t,{J:()=>s});var r=i(38801),o=i(4521),a=i(8725),l=e([r]);function s(){let e=(0,r.yi)("customTaskMap");return Object.values(e).filter(Boolean).map((e,t)=>{let{x:i,y:n,width:r,height:l,count:s=1,sourceElementId:d}=e,c=Array.from({length:s}).map(()=>({...e,index:t}));return(0,a.H)({taskType:o.UA.Generating,taskSource:o.KR.Custom,x:i,y:n,width:r,height:l,count:s,taskData:e,subTasks:c,sourceElementId:d})})}r=(l.then?(await l)():l)[0],n()}catch(e){n(e)}})},34714:function(e,t,i){i.a(e,async function(e,n){try{i.d(t,{Z:()=>s});var r=i(38311),o=i(4521),a=i(8725),l=e([r]);function s(){let e=function(){var e,t;let i=(0,r.uT)(),{x:n,y:l,width:s,height:d,params:c}=i||{},u=(null==i?void 0:i.count)||(null==c?void 0:c.count)||1;return(0,a.H)({taskType:o.UA.Generating,taskSource:o.KR.Generator,x:n,y:l,width:s,height:d,count:u,taskData:i,subTasks:i?(null==i?void 0:i.hasSubTasks)&&(null==i||null==(e=i.results)?void 0:e.length)>0?null==i||null==(t=i.results)?void 0:t.map(e=>({...i,...e})):Array.from({length:u}).map(e=>({...i,index:e})):[]})}(),t=(0,r.Pr)().filter(e=>!e.isFlowManualGenerator).map((e,t)=>{let{x:i,y:n,width:r,height:l,params:s}=e,d=(null==s?void 0:s.count)||1,c=Array.from({length:d}).map(()=>({...e,index:t}));return(0,a.H)({taskType:o.UA.Waiting,taskSource:o.KR.Generator,x:i,y:n,width:r,height:l,count:d,taskData:e,subTasks:c})});return[e,...t]}r=(l.then?(await l)():l)[0],n()}catch(e){n(e)}})},8725:function(e,t,i){i.d(t,{H:()=>r});var n=i(41845);function r(e){let{taskType:t,taskSource:i,x:r,y:o,width:a,height:l,count:s,taskData:d,subTasks:c=[],sourceElementId:u,threadId:h}=e,f=null==d?void 0:d.id,g=null==d?void 0:d.type,m=a*s+(s-1)*n.bp,p=c.map((e,t)=>({x:t*(a+n.bp),y:0,width:a,height:l,cellIndex:t,isLastCell:t===(null==c?void 0:c.length)-1,taskData:e}));return{taskId:f,taskType:t,taskSource:i,x:r,y:o,width:m,height:l,cells:p,type:g,taskData:d,sourceElementId:u,threadId:h}}},20201:function(e,t,i){i.d(t,{g:()=>r});var n=i(39378);let r=function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"OUTSIDE",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{w:0,h:0},a=o.w,l=o.h,s="vector"===t.type?t.data.stroke:t.strokeData.strokePaints[0],d="vector"===t.type?t.data.stroke.strokeWidth:t.strokeData.strokeWeight,c=2*(window.devicePixelRatio||1),u=Math.max(a,l);u*c>4096&&(c=Math.min(2,4096/u));let h=new OffscreenCanvas(a*c,l*c),f=h.getContext("2d");f.scale(c,c);let g=`rgba(${255*s.color.r},${255*s.color.g},${255*s.color.b},${s.opacity})`,m=2*d/r;if("OUTSIDE"===i){var p,y,v,w;let i=!!("vector"!==t.type&&1===s.opacity&&(null==t||null==(y=t.richData)||null==(p=y.style)?void 0:p.fillPaints)&&(0,n.isEqual)(null==t||null==(w=t.richData)||null==(v=w.style)?void 0:v.fillPaints[0],s))||!1;f.save();let r=new Path2D;for(let t of e){let e=new Path2D,i=new Path2D(t.data),n=new DOMMatrix().translate(t.x,t.y);e.addPath(i,n),r.addPath(e)}f.lineWidth=m,f.strokeStyle=g,f.stroke(r),f.globalCompositeOperation="destination-out",f.fill(r),i&&(f.globalCompositeOperation="source-over",f.lineWidth=.1*m,f.strokeStyle=g,f.stroke(r)),f.restore()}if("INSIDE"===i)for(let t of e){f.save();let e=new Path2D(t.data);f.translate(t.x,t.y),f.clip(e),f.lineWidth=m,f.strokeStyle=g,f.stroke(e),f.restore()}return h}},65196:function(e,t,i){i.a(e,async function(e,n){try{i.d(t,{U:()=>p});var r=i(79988),o=i(1141),a=i(75232),l=i(33320),s=i(34727),d=i(40340),c=i(11041),u=i(88119),h=i(16627),f=i(81949),g=i(39378),m=e([s,r,l,f,h]);[s,r,l,f,h]=m.then?(await m)():m;let p=function(){let{disableStroke:e=!1,elementArray:t=[],isCreate:i=!0,isDelete:n=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=(0,r.Kl)("selection"),a=(0,f.eT)("sceneGraph"),g=t.length?t:o.map(e=>a.findById(e)),m=(0,h.$3)(g);if(0===m.length)return;let p=[];m.map(e=>e.x),m.map(e=>e.y),m.forEach(e=>v(e,p));let x=w(p),b=u.J.calcBounds(x);x.vertices.forEach(e=>{e.x-=b[0],e.y-=b[1]});let E=e=>"group"!==e[0].type?e[0]:E(e[0].elements),T=y(E(m.toReversed())),k={type:d.Hd.Vector,x:b[0],y:b[1],width:b[2]-b[0],height:b[3]-b[1],data:{fillPaint:T.fillPaint,stroke:e?{...c.R$,visible:!1}:T.stroke,vectorData:{vectorNetwork:x}}};if(1===m.length&&(k.name=m[0].name,k.title=m[0].title),i){let e=s.ZP.canvas.insertElement(k,{name:"insertVectorElement"});(0,r.L$)({selection:[e]})}return n&&(0,l.removeElements)(m.map(e=>e.id)),k},y=e=>{if("vector"===e.type||"vector_group"===e.type){let{fillPaint:t,stroke:i}=e.data;return{fillPaint:(0,g.cloneDeep)(t||c.qF),stroke:i||c.R$}}let t=(0,f.eT)("sceneGraph").findById(e.id);if(t.isVector)return{fillPaint:(0,g.cloneDeep)(t.fillPaint),stroke:(0,g.cloneDeep)(e.data.stroke)};if("text"===e.type){let{richData:t,strokeData:i}=e,{fillPaints:n}=t.style;return{fillPaint:n[0]||c.qF,stroke:{...i.strokePaints[0],strokePosition:i.strokeAlign,strokeWidth:i.strokeWeight}}}return{fillPaint:c.qF,stroke:c.R$}},v=(e,t,i)=>{if(i&&(e={...e},e.x+=i.x,e.y+=i.y),"vector"===e.type){let i={vertices:[],segments:[],regions:[]};if(e.data.fillGeometry.length&&e.data.fillGeometry.forEach(e=>{var t,n;let r=(t=e.data,n=e.windingRule,new a.a(t,void 0,!0,n).vectorNetwork);r.regions.forEach(e=>{e.loops.forEach(e=>{e.forEach((t,n)=>{e[n]+=i.segments.length})})}),r.segments.forEach(e=>{e.start+=i.vertices.length,e.end+=i.vertices.length}),i.vertices=i.vertices.concat(r.vertices),i.segments=i.segments.concat(r.segments),i.regions=i.regions.concat(r.regions)}),e.data.linePath){let t=new a.a(e.data.linePath[0].data).vectorNetwork;t.segments.forEach(e=>{e.start+=i.vertices.length,e.end+=i.vertices.length}),i.vertices=i.vertices.concat(t.vertices),i.segments=i.segments.concat(t.segments),i.regions=i.regions.concat(t.regions)}t.push((0,h.xn)(i,e));return}if("vector_group"===e.type){let i=e.data.fillGeometry[0];if(i){let n=new a.a(i.data,void 0,!0,i.windingRule).vectorNetwork;t.push((0,h.xn)(n,e));return}}if("shape_square"===e.type){let i=new o.pJ,{cornerRadius:n,rectangleCornerRadiiIndependent:r,rectangleTopLeftCornerRadius:a,rectangleTopRightCornerRadius:l,rectangleBottomLeftCornerRadius:s,rectangleBottomRightCornerRadius:d}=e.data,c=n;r&&(c=[a,l,d,s]),t.push((0,h.xn)(i.rectangle(e.width,e.height,c),e));return}if("shape_circle"===e.type){let i=new o.pJ;t.push((0,h.xn)(i.ellipse(e.width,e.height),e));return}if("shape_star"===e.type){let i=new o.pJ,{pointCount:n,innerRadius:r,cornerRadius:a}=e.data;t.push((0,h.xn)(i.star(e.width,e.height,n,r,a),e));return}if("shape_polygon"===e.type){let{pointCount:i,cornerRadius:n}=e.data,r=new o.pJ;t.push((0,h.xn)(r.polygon(e.width,e.height,i,n),e));return}if("text"===e.type)return void e.richData.derivedTextData.glyphs.forEach(i=>{let{commandsBlob:n,position:r}=i,o=new a.a(n,void 0,!0).vectorNetwork;t.push((0,h.xn)(o,e,{x:r.x,y:r.y}))});"group"===e.type&&e.elements.forEach(i=>v(i,t,e))},w=e=>{let t={vertices:[],segments:[],regions:[]};return e.forEach(e=>{let{vertices:i,segments:n,regions:r}=e;r.forEach(e=>{e.loops.forEach(e=>{e.forEach((i,n)=>{e[n]+=t.segments.length})})}),n.forEach(e=>{e.start+=t.vertices.length,e.end+=t.vertices.length}),t.vertices=t.vertices.concat(i),t.segments=t.segments.concat(n),t.regions=t.regions.concat(r)}),t};n()}catch(e){n(e)}})},16627:function(e,t,i){i.a(e,async function(e,n){try{i.d(t,{$3:()=>c,B1:()=>u,xn:()=>h});var r=i(6082),o=i(39378),a=i(81949),l=e([a]);a=(l.then?(await l)():l)[0];let d=["shape_square","shape_circle","vector","text","group","vector_group","shape_star","shape_polygon"],c=e=>{let t=[];return e.forEach(e=>{"group"===e.type?t.push(...c(e.children)):(e.isVector||d.includes(e.type))&&t.push(e.originElement||e)}),t},u=e=>{if(e.includes("rgba")||e.includes("rgb")){let[t,i,n,o]=(0,r.h2)(e,[0,0,0,0]);return{r:t,g:i,b:n,a:o}}if(e.includes("#")){let t=(0,r.a7)(e);return{r:t.r/255,g:t.g/255,b:t.b/255,a:t.a/255}}return e},h=function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{x:0,y:0},{x:n,y:r,rotation:l,width:d,height:c}=(0,a.eT)("sceneGraph").findById(t.id).getAbsoluteTransform(),u=(0,o.cloneDeep)(e),{vertices:h,segments:f}=u;return l&&(f.forEach(e=>{let{tangentEnd:t,tangentStart:i}=e;if(t){let{x:e,y:i}=s(t.x,t.y,0,0,l);t.x=e,t.y=i}if(i){let{x:e,y:t}=s(i.x,i.y,0,0,l);i.x=e,i.y=t}}),h.forEach(e=>{let{x:t,y:i}=s(e.x,e.y,0,0,l);e.x=t,e.y=i})),h.forEach(e=>{e.x+=i.x+n,e.y+=i.y+r}),u};function s(e,t,i,n,r){let o=r*Math.PI/180,a=Math.cos(o),l=Math.sin(o),s=e-i,d=t-n;return{x:s*a-d*l+i,y:s*l+d*a+n}}n()}catch(e){n(e)}})},49604:function(e,t,i){i.a(e,async function(e,n){try{i.d(t,{Hz:()=>T,ZH:()=>x,r5:()=>R,z$:()=>k});var r=i(79988),o=i(98516),a=i(16627),l=i(65196),s=i(82465),d=i(75232),c=i(34727),u=i(11041),h=i(39378),f=i(12634),g=i.n(f),m=i(33320),p=i(81949),y=i(91020),v=e([a,c,o,r,m,l,p,s]);[a,c,o,r,m,l,p,s]=v.then?(await v)():v;let x=()=>{let e=(0,r.Kl)("selection"),t=(0,p.eT)("sceneGraph"),i=e.map(e=>t.findById(e)),n=(0,a.$3)(i);if(0===n.length)return;let l=[];!function e(t,i){t.forEach(t=>{if("group"===t.type)e(t.elements,i);else{var n;null==(n=b[t.type])||n.call(b,t,i)}})}(n,l);let s=c.ZP.canvas.insertElements(l,{name:"outline",__keepTracking:!0});s.forEach(e=>{e.startsWith("element-group-")&&((0,o.rI)(e).key=e.replace("element-group-","element-group-key-"))}),(0,r.L$)({selection:s}),(0,m.removeElements)(n.map(e=>e.id))},b={vector:function(e,t){let{fillPaint:i,stroke:n,fillGeometry:r,strokeGeometry:o}=e.data;if(r.length&&i.visible&&i.opacity>0){let i=(0,l.U)({disableStroke:!0,elementArray:[e],isCreate:!1,isDelete:!1});t.push(i)}if(n.opacity>0&&n.strokeWidth>0&&n.visible){let i=T(e),{fBottom:r,fTop:o,fLeft:a,fRight:l}=i.computeTightBounds();i.transform(1,0,-a,0,1,-o,0,0,1);let s=i.toSVGString(),c=0===i.getFillType().value?"NONZERO":"EVENODD",h=new d.a(s,void 0,!0,c).vectorNetwork,f=(0,p.eT)("sceneGraph").findById(e.id).getAbsoluteTransform(),g=E(n),m={type:"vector",x:f.x+a,y:f.y+o,width:l-a,height:r-o,scaleX:f.scaleX,scaleY:f.scaleY,rotation:f.rotation,data:{fillPaint:g,stroke:{...u.R$,visible:!1},vectorData:{vectorNetwork:h}}};t.push(m),i.isDeleted()||i.delete()}},shape_square:w,shape_circle:w,shape_star:w,shape_polygon:w,text:function(e,t){let{richData:i,strokeData:n}=e,{derivedTextData:r,textData:o,style:a}=i,{glyphs:l}=r,{styleOverrideTable:c,characterStyleIDs:f}=o,m=(0,p.eT)("sceneGraph").findById(e.id).getAbsoluteTransform(),y={type:"group",elements:[],name:o.characters,title:o.characters,x:m.x,y:m.y,width:m.width,height:m.height,scaleX:m.scaleX,scaleY:m.scaleY,rotation:m.rotation},v=(0,h.cloneDeep)(y);v.title+="(stroke)",v.name+="(stroke)",l.forEach((t,i)=>{let{commandsBlob:r,position:o}=t;if(!r)return;let l=s.Z.pathKit.FromSVGString(r),{fBottom:m,fTop:p,fLeft:w,fRight:x}=l.computeTightBounds();l.transform(1,0,-w,0,1,-p,0,0,1);let b=l.toSVGString(),E=new d.a(b,void 0,!0).vectorNetwork,T=(null==f?void 0:f[i])||0,k=(0,h.cloneDeep)(a.fillPaints[0]),R=0===T?k:(0,h.cloneDeep)(c.find(e=>e.styleID===T)),S={type:"vector",id:`element-vector-${g()()}`,x:w+o.x,y:p+o.y,width:x-w,height:m-p,scaleX:e.scaleX,scaleY:e.scaleY,rotation:e.rotation,data:{fillPaint:R,stroke:{...u.R$,visible:!1},vectorData:{vectorNetwork:E}}};y.elements.push(S);let{strokeAlign:I,strokeWeight:P,strokePaints:A}=n,C=A[0];if(P>0&&C.visible&&C.opacity>0){let t=s.Z.pathKit.FromSVGString(r),i=s.Z.pathKit,n=i.NewPath(t).stroke({width:"CENTER"===I?P:2*P,miter_limit:10});if("CENTER"!==I){let e="INSIDE"===I?i.PathOp.INTERSECT:i.PathOp.DIFFERENCE,r=i.MakeFromOp(n,t,e);n.delete(),n=r,t.delete()}let{fBottom:a,fTop:l,fLeft:c,fRight:h}=n.computeTightBounds();n.transform(1,0,-c,0,1,-l,0,0,1);let f=n.toSVGString(),m=0===n.getFillType().value?"NONZERO":"EVENODD";n.delete();let p=new d.a(f,void 0,!0,m).vectorNetwork,y={type:"vector",id:`element-vector-${g()()}`,x:c+o.x,y:l+o.y,width:h-c,height:a-l,scaleX:e.scaleX,scaleY:e.scaleY,rotation:e.rotation,data:{fillPaint:C,stroke:{...u.R$,visible:!1},vectorData:{vectorNetwork:p}}};v.elements.push(y)}}),y.elements.length>0&&t.push(y),v.elements.length>0&&t.push(v)},vector_group:function(e,t){let{fillPaint:i,stroke:n,fillGeometry:r}=e.data;if(r.length&&i.visible&&i.opacity>0){let i=(0,l.U)({disableStroke:!0,elementArray:[e],isCreate:!1,isDelete:!1});t.push(i)}if(n.opacity>0&&n.strokeWidth>0&&n.visible){let i=R(e),{fBottom:r,fTop:o,fLeft:a,fRight:l}=i.computeTightBounds();i.transform(1,0,-a,0,1,-o,0,0,1);let s=i.toSVGString(),c=0===i.getFillType().value?"NONZERO":"EVENODD",h=new d.a(s,void 0,!0,c).vectorNetwork,f=(0,p.eT)("sceneGraph").findById(e.id).getAbsoluteTransform(),g=E(n),m={type:"vector",x:f.x+a,y:f.y+o,width:l-a,height:r-o,scaleX:f.scaleX,scaleY:f.scaleY,rotation:f.rotation,data:{fillPaint:g,stroke:{...u.R$,visible:!1},vectorData:{vectorNetwork:h}}};t.push(m),i.isDeleted()||i.delete()}}},E=e=>{let t=(0,h.cloneDeep)(e);return delete t.strokeWidth,delete t.strokePosition,t.type="SOLID",t},T=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2?arguments[2]:void 0,n=s.Z.pathKit,{stroke:r}=i||e.data,o=(0,p.eT)("sceneGraph").findById(e.id),a=o.fillGeometry;if(!r||!r.strokeWidth||!r.visible)return null;let l=o.strokeGeometry,d=o.vectorData.vectorNetwork,c="CENTER"===r.strokePosition||"center"===r.strokePosition,u=c?new y.R(d).getResultPath().map(e=>e.data).join(" "):l[0].data,h=s.Z.pathKit.FromSVGString(u),f=c?h.stroke({width:r.strokeWidth,miter_limit:10}):(()=>{if(null==a||!a.length)return h;{let e=h,t="INSIDE"===r.strokePosition?n.PathOp.INTERSECT:n.PathOp.DIFFERENCE;return a.forEach(i=>{let r=s.Z.pathKit.FromSVGString(i.data),o="EVENODD"===i.windingRule?n.FillType.EVENODD:n.FillType.WINDING;r.setFillType(o);let a=n.MakeFromOp(e,r,t);e.delete(),e=a,r.delete()}),e}})();if(t){let e=f.toSVGString();return f.delete(),e}return f},k=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{data:i}=e,{stroke:n}=i;if(!n||!n.strokeWidth||!n.visible)return null;let r=(0,p.eT)("sceneGraph").findById(e.id).fillGeometry.map(e=>e.data).join(" ");return t?r:s.Z.pathKit.FromSVGString(r).stroke({width:n.strokeWidth,miter_limit:10})},R=e=>{let{fillGeometry:t,stroke:i}=e.data,n=t.map(e=>e.data).join(" "),r=s.Z.pathKit,o=r.FromSVGString(n);if("CENTER"===i.strokePosition)return o.stroke({width:i.strokeWidth,miter_limit:10});let a=r.NewPath(o).stroke({width:2*i.strokeWidth,miter_limit:10}),l="INSIDE"===i.strokePosition?r.PathOp.INTERSECT:r.PathOp.DIFFERENCE,d=r.MakeFromOp(a,o,l);return o.delete(),a.delete(),d};function w(e,t){let{data:i}=e,{stroke:n,fillPaint:r}=i;if(r.visible&&r.opacity>0){let i=(0,l.U)({disableStroke:!0,elementArray:[e],isCreate:!1,isDelete:!1});t.push(i)}if(n&&n.strokeWidth&&n.visible){let i=k(e.originElement||e),{fBottom:r,fTop:o,fLeft:a,fRight:l}=i.computeTightBounds();i.transform(1,0,-a,0,1,-o,0,0,1);let s=i.toSVGString();i.delete();let c=new d.a(s,void 0,!0).vectorNetwork,h=(0,p.eT)("sceneGraph").findById(e.id).getAbsoluteTransform(),f=E(n),g={type:"vector",x:h.x+a,y:h.y+o,width:l-a,height:r-o,scaleX:h.scaleX,scaleY:h.scaleY,rotation:h.rotation,data:{fillPaint:f,stroke:{...u.R$,visible:!1},vectorData:{vectorNetwork:c}}};t.push(g)}}n()}catch(e){n(e)}})},42632:function(e,t,i){i.d(t,{g:()=>n});let n=function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"OUTSIDE",n="INSIDE"===i?t.width:e.width,r="INSIDE"===i?t.height:e.height,o=t.data.stroke;t.data.stroke.strokeWidth;let a=2*(window.devicePixelRatio||1),l=Math.max(n,r);l*a>4096&&(a=Math.min(2,4096/l));let s=new OffscreenCanvas(n*a,r*a),d=s.getContext("2d");d.scale(a,a);let c=`rgba(${255*o.color.r},${255*o.color.g},${255*o.color.b},${o.opacity})`;if("OUTSIDE"===i){d.save(),d.translate(-e.x,-e.y);let t=new Path2D(e.fillPath),i=new Path2D(e.data);d.fillStyle=c,d.fill(i),d.globalCompositeOperation="destination-out",d.fillStyle="black",d.fill(t),d.restore()}if("INSIDE"===i){d.save();let t=new Path2D(e.data),i=new Path2D(e.fillPath);d.translate(e.x,e.y),d.clip(i),d.fillStyle=c,d.fill(t),d.restore()}return s}},4800:function(e,t,i){i.a(e,async function(e,n){try{i.d(t,{V:()=>x});var r=i(752),o=i.n(r),a=i(52983),l=i(79988),s=i(9867),d=i(91020),c=i(82465),u=i(42632),h=i(88119),f=i(81949),g=i(76145),m=i(35962),p=i(43755),y=i(60612),v=i(29725),w=e([l,m,p,c,f]);[l,m,p,c,f]=w.then?(await w)():w;let x=e=>{let t=(0,a.useRef)(null),i=(0,s.qQ)("groupRenderDep"),n=(0,l.eD)("selection"),r=(0,s.qQ)("editorId"),w=(0,s.qQ)("imageLoadDep"),[,x]=(0,a.useReducer)(e=>e+1,0),b=(0,f.eT)("sceneGraph").findById(e.id),E=(0,s.qQ)("isInitVectorEditor");function T(){t.current.destroyChildren(),function(){var i,n,r,a;let l=b.vectorData.vectorNetwork,f=new d.R(l).getResultPath(),w=0,x=0,E=e.data.fillPaint,T=E.color??{r:0,g:0,b:0,a:1},k=e.data.stroke,R=k.color,S=E.visible?`rgba(${255*T.r},${255*T.g},${255*T.b},${null==(i=e.data.fillPaint)?void 0:i.opacity})`:"",I=f.map(e=>e.data).join(" ");e.data.linePath=[];let P=b.fillGeometry;if(!P)if(l.regions.length>0)e.data.linePath=[{data:f.filter(e=>"NONE"===e.windingRule&&e.data).map(e=>e.data).join(" "),windingRule:"NONE"}];else{let t={otherPath:null,fillPath:null};try{let{otherPath:e,fillPath:i}=(0,y.O4)(new y.h9(I));i&&(t.fillPath=i),e&&(t.otherPath=e)}catch(e){t.otherPath=null,t.fillPath=new v.m}let{otherPath:i,fillPath:n}=t;n.commands.length>0&&P.push({data:n.toVectorPath().data,windingRule:"NONZERO"}),i&&e.data.linePath.push({data:i.toVectorPath().data,windingRule:"NONZERO"})}if(P.length>0){let{fTop:e,fLeft:i,fBottom:n,fRight:r}=c.Z.pathKit.FromSVGString(P.map(e=>e.data).join(" ")).computeTightBounds();P.forEach(a=>{var l;if("NONE"!==a.windingRule){if((null==E||null==(l=E.type)?void 0:l.startsWith("GRADIENT"))&&E.gradient){let l=(0,p.WZ)({width:r-i,height:n-e},E.gradient.stops,E.gradient.start,E.gradient.end,E.type,{x:-i,y:-e}),s=new(o()).Path({id:"vector-fillpath",data:a.data,...l,fillRule:"EVENODD"===a.windingRule?"evenodd":"nonzero",listening:!1});t.current.add(s);return}if("IMAGE"===E.type){let l=E.imageUrl;if(!l){let e=(0,g.z)(),i=new(o()).Path({id:"vector-fillpath",data:a.data,fillPatternImage:e,fillPatternRepeat:"repeat",fillRule:"EVENODD"===a.windingRule?"evenodd":"nonzero",listening:!1});t.current.add(i);return}let d=(0,m.um)(l);if(!d)return void(0,m.kE)(l).then(e=>{e&&(0,s.Dq)({imageLoadDep:!(0,s.IG)("imageLoadDep")})});let c=(0,p.R1)({width:null==d?void 0:d.width,height:null==d?void 0:d.height},{width:r-i,height:n-e}),u=new(o()).Path({id:"vector-fillpath",data:a.data,fillPatternX:i,fillPatternY:e,fillPatternImage:d,fillPatternRepeat:"no-repeat",fillPatternOffset:{x:c.offsetX,y:c.offsetY},fillPatternScale:{x:c.scale,y:c.scale},fillRule:"EVENODD"===a.windingRule?"evenodd":"nonzero",listening:!1});return void t.current.add(u)}if(S){let e=new(o()).Path({id:"vector-fillpath",data:a.data,fill:S,fillRule:"EVENODD"===a.windingRule?"evenodd":"nonzero",listening:!1});t.current.add(e)}}})}let A=(null==P?void 0:P.map(e=>e.data).join(" "))||"",C=(null==(n=e.data.strokeGeometry[0])?void 0:n.data)||"";if(k.visible&&k.strokeWidth>0&&k.opacity>0)if("CENTER"!==k.strokePosition&&"center"!==k.strokePosition&&A){let i="",n={x1:Number.MAX_SAFE_INTEGER,y1:Number.MAX_SAFE_INTEGER,x2:Number.MIN_SAFE_INTEGER,y2:Number.MIN_SAFE_INTEGER};if(C){let e=c.Z.pathKit.FromSVGString(C),{fBottom:t,fTop:i,fLeft:r,fRight:o}=e.computeTightBounds();n.x1=Math.min(n.x1,r),n.y1=Math.min(n.y1,i),n.x2=Math.max(n.x2,o),n.y2=Math.max(n.y2,t),e.delete()}else{let t=(null==(a=e.data.linePath)?void 0:a.map(e=>e.data).join(" "))||"";if("INSIDE"===k.strokePosition){let e=c.Z.pathKit.FromSVGString(t+" "+A);i=e.stroke({width:2*k.strokeWidth,miter_limit:10}).toSVGString(),e.delete()}else{let e=new c.Z.pathKit.SkPath;if(t){let i=c.Z.pathKit.FromSVGString(t),r=i.stroke({width:k.strokeWidth,miter_limit:10}),{fBottom:o,fTop:a,fLeft:l,fRight:s}=r.computeTightBounds();n.x1=Math.min(n.x1,l),n.y1=Math.min(n.y1,a),n.x2=Math.max(n.x2,s),n.y2=Math.max(n.y2,o),e.addPath(r),i.delete()}if(A){let t=c.Z.pathKit.FromSVGString(A),i=t.stroke({width:2*k.strokeWidth,miter_limit:10}),{fBottom:r,fTop:o,fLeft:a,fRight:l}=i.computeTightBounds();n.x1=Math.min(n.x1,a),n.y1=Math.min(n.y1,o),n.x2=Math.max(n.x2,l),n.y2=Math.max(n.y2,r),e.addPath(i),t.delete()}i=e.toSVGString(),e.delete()}e.data.strokeGeometry=[{data:i,windingRule:"NONZERO"}]}let l="INSIDE"===k.strokePosition,s=(0,u.g)({x:l?0:n.x1,y:l?0:n.y1,width:l?e.width:n.x2-n.x1,height:l?e.height:n.y2-n.y1,data:(null==(r=e.data.strokeGeometry[0])?void 0:r.data)||"",fillPath:A||""},e,k.strokePosition),d=new(o()).Image({x:l?0:n.x1,y:l?0:n.y1,width:l?e.width:n.x2-n.x1,height:l?e.height:n.y2-n.y1,image:s,listening:!1});t.current.add(d)}else f.forEach(e=>{let i=new(o()).Path({id:"vector-path",data:e.data,stroke:k.visible?`rgba(${255*R.r},${255*R.g},${255*R.b},${k.opacity})`:"",strokeWidth:k.strokeWidth,fill:"",listening:!1}),{x:n,y:r,width:a,height:l}=i.getClientRect();w=Math.max(w,n+a),x=Math.max(x,r+l),t.current.add(i)});let[D,M,F,L]=h.J.calcBounds(l);w=F-D,x=L-M,t.current.add(new(o()).Rect({role:"element",name:e.id,textContainer:!0,width:w,height:x,draggable:!1}))}(),x()}return(0,a.useEffect)(()=>{E&&(n.map(e=>(0,f.eT)("sceneGraph").findById(e)).some(t=>t.hasDescendantWithId(e.id,!0))||r===e.id)&&T()},[i,E]),(0,a.useEffect)(()=>{E&&T()},[E,w]),t};n()}catch(e){n(e)}})},1141:function(e,t,i){i.d(t,{fj:()=>l,fq:()=>d,pJ:()=>s});var n=i(29725),r=i(40340),o=i(92079);let a=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new n.m;return e?t.toCmdPath():t.toVectorPath()};class l{getFillGeometry(e){let{type:t,width:i,height:n,pointCount:o,innerRadius:a}=e;switch(t){case r.Hd.Vector:case r.Hd.ShapeSquare:return this.rectangle(i,n);case r.Hd.ShapeCircle:return this.ellipse(i,n,{startingAngle:0,endingAngle:6.2831854820251465,innerRadius:0});case r.Hd.ShapeStar:return this.star(i,n,o,a);case r.Hd.ShapePolygon:return this.polygon(i,n,o);default:return this.rectangle(i,n)}}rectangle(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=new n.m;return r.moveTo({x:0,y:0}),r.lineTo({x:e,y:0}),r.lineTo({x:e,y:t}),r.lineTo({x:0,y:t}),r.lineTo({x:0,y:0}),r.closePath(),i?r.toCmdPath():r.toVectorPath()}ellipse(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(0===i.startingAngle&&6.2831854820251465===i.endingAngle&&0===i.innerRadius){let i=e/2,r=t/2;return this.oval(i,r,i,r,n)}return a(n)}oval(e,t,i,r){let o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=.5522847498307936*i,l=.5522847498307936*r,s=new n.m;return s.moveTo({x:e+i,y:t}),s.curveTo({x:e+i,y:t+l},{x:e+a,y:t+r},{x:e,y:t+r}),s.curveTo({x:e-a,y:t+r},{x:e-i,y:t+l},{x:e-i,y:t}),s.curveTo({x:e-i,y:t-l},{x:e-a,y:t-r},{x:e,y:t-r}),s.curveTo({x:e+a,y:t-r},{x:e+i,y:t-l},{x:e+i,y:t}),s.closePath(),o?s.toCmdPath():s.toVectorPath()}star(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],l=new n.m,s=(0,o.Y7)(e,t,i,r);for(let e=0;e<s.length;e+=2){let t=s[e],i=s[e+1];0===e?l.moveTo({x:t,y:i}):l.lineTo({x:t,y:i})}return l.closePath(),a?l.toCmdPath():l.toVectorPath()}polygon(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=new n.m,l=(0,o._B)(e,t,i);for(let e=0;e<l.length;e+=2){let t=l[e],i=l[e+1];0===e?a.moveTo({x:t,y:i}):a.lineTo({x:t,y:i})}return a.closePath(),r?a.toCmdPath():a.toVectorPath()}constructor(){}}class s{rectangle(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return{regions:[{windingRule:"NONZERO",loops:[[0,1,2,3]]}],segments:[{start:0,end:1,tangentStart:{x:0,y:0},tangentEnd:{x:0,y:0}},{start:1,end:2,tangentStart:{x:0,y:0},tangentEnd:{x:0,y:0}},{start:2,end:3,tangentStart:{x:0,y:0},tangentEnd:{x:0,y:0}},{start:3,end:0,tangentStart:{x:0,y:0},tangentEnd:{x:0,y:0}}],vertices:[{x:0,y:0,cornerRadius:"number"==typeof i?i:i[0]},{x:e,y:0,cornerRadius:"number"==typeof i?i:i[1]},{x:e,y:t,cornerRadius:"number"==typeof i?i:i[2]},{x:0,y:t,cornerRadius:"number"==typeof i?i:i[3]}]}}ellipse(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{startingAngle:0,endingAngle:6.2831854820251465,innerRadius:0};if(0===i.startingAngle&&6.2831854820251465===i.endingAngle&&0===i.innerRadius){let i=e/2,n=t/2;return this.oval(i,n,i,n)}}oval(e,t,i,n){let r=.5522847498307936*i,o=.5522847498307936*n;return{regions:[{windingRule:"NONZERO",loops:[[0,1,2,3]]}],segments:[{start:0,end:1,tangentStart:{x:0,y:o},tangentEnd:{x:r,y:0}},{start:1,end:2,tangentStart:{x:-r,y:0},tangentEnd:{x:0,y:o}},{start:2,end:3,tangentStart:{x:0,y:-o},tangentEnd:{x:-r,y:0}},{start:3,end:0,tangentStart:{x:r,y:0},tangentEnd:{x:0,y:-o}}],vertices:[{x:e+i,y:t},{x:e,y:t+n},{x:e-i,y:t},{x:e,y:t-n}]}}star(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5,n=arguments.length>3?arguments[3]:void 0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=(0,o.Y7)(e,t,i,n),l=[];for(let e=0;e<a.length;e+=2){let t=a[e],i=a[e+1];l.push({x:t,y:i,cornerRadius:r})}return{regions:[{windingRule:"NONZERO",loops:[Array.from({length:2*i},(e,t)=>t)]}],segments:Array.from({length:2*i},(e,t)=>({start:t,end:t===2*i-1?0:t+1,tangentStart:{x:0,y:0},tangentEnd:{x:0,y:0}})),vertices:l}}polygon(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=(0,o._B)(e,t,i),a=[];for(let e=0;e<r.length;e+=2){let t=r[e],i=r[e+1];a.push({x:t,y:i,cornerRadius:n})}return{regions:[{windingRule:"NONZERO",loops:[Array.from({length:i},(e,t)=>t)]}],segments:Array.from({length:i},(e,t)=>({start:t,end:t===i-1?0:t+1,tangentStart:{x:0,y:0},tangentEnd:{x:0,y:0}})),vertices:a}}constructor(){}}let d=e=>{let{type:t,width:i,height:n}=e,{cornerRadius:o,rectangleCornerRadiiIndependent:a,rectangleBottomLeftCornerRadius:l,rectangleBottomRightCornerRadius:d,rectangleTopLeftCornerRadius:c,rectangleTopRightCornerRadius:u}=e.data,h=new s;if(t===r.Hd.ShapeSquare)return{vectorNetwork:h.rectangle(i,n,a?[c,u,d,l]:o)};if(t===r.Hd.ShapeCircle)return{vectorNetwork:h.ellipse(i,n)};if(t===r.Hd.ShapeStar){let{pointCount:t,innerRadius:r}=e.data;return{vectorNetwork:h.star(i,n,t,r,o)}}if(t===r.Hd.ShapePolygon){let{pointCount:t}=e.data;return{vectorNetwork:h.polygon(i,n,t,o)}}}},9867:function(e,t,i){i.d(t,{Dq:()=>h,IG:()=>f,qQ:()=>u});var n=i(98830),r=i(80413),o=i(11041),a=i(21437),l=i(40340),s=i(39378);let d={id:"tempElement",type:l.Hd.Vector,data:{stroke:{...(0,s.cloneDeep)(o.R$),strokeWidth:20},fillPaint:(0,s.cloneDeep)(o.qF)}},c=(0,r.F)()(()=>({pen:null,editorId:"",editorRenderDep:!1,hoverVectorId:"",groupRenderDep:!1,dataRenderDep:!1,selectContent:{points:[],tangentPoints:[],segments:[]},selectBox:[],isInitVectorEditor:!1,cursor:"",cursorPos:[0,0],fillPaint:o.qF,stroke:o.R$,cornerRadius:0,currentState:null,width:0,height:0,lockRatio:!1,vectorNetwork:{vertices:[],segments:[]},tempElement:d,alignLines:[],history:new a.E({},100),imageLoadDep:!1,shapeTextTool:"rectangle"})),{useStore:u,setState:h,getState:f}=(0,n.b)(c)},2529:function(e,t,i){i.a(e,async function(e,n){try{i.d(t,{Z:()=>d});var r=i(97458),o=i(52983),a=i(30967),l=i(35962),s=e([l]);l=(s.then?(await s)():s)[0];let d=(0,o.memo)(e=>{let{element:t}=e,{width:i,height:n,coverUrl:s}=t,[d,c]=(0,o.useState)(null);return(0,o.useEffect)(()=>{(0,l.kE)(s).then(c)},[s]),(0,r.jsx)(a.ZA,{children:(0,r.jsx)(a.Ee,{name:t.id,id:t.id+"-video",role:"element",roleType:"video",image:d,fill:d?void 0:"#b3dbd830",imageUrl:s,width:i,height:n})})});n()}catch(e){n(e)}})},98516:function(e,t,i){i.a(e,async function(e,n){try{i.d(t,{Ze:()=>s,eD:()=>d,rI:()=>l,to:()=>c});var r=i(81949),o=i(79988),a=e([o,r]);[o,r]=a.then?(await a)():a;let l=e=>{var t;return null==(t=(0,r.eT)("sceneGraph").findById(e))?void 0:t.originElement},s=e=>(0,r.eT)("sceneGraph").findById(e),d=()=>{let{selection:e,elements:t}=(0,o.Kl)();return t.filter(t=>e.includes(t.id))},c=e=>{let t=(0,r.eT)("sceneGraph").findById(e.id);if(!t)return{x:0,y:0};let{x:i,y:n}=t.getAbsoluteTransform();return{x:i,y:n}};n()}catch(e){n(e)}})},95421:function(e,t,i){i.d(t,{Sr:()=>a,xl:()=>o});var n=i(98830);let r=(0,i(80413).F)()(()=>({pathKitReady:!1})),{useStore:o,setState:a,getState:l}=(0,n.b)(r)},60896:function(e,t,i){i.a(e,async function(e,n){try{i.d(t,{sC:()=>a});var r=i(621),o=e([r]);r=(o.then?(await o)():o)[0];let a=function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=(0,r.getMinScale)(),o=(0,r.getMaxScale)(),a=Math.abs(t||0),l=!!i.ctrlKey&&!i.metaKey&&(i.deltaMode??0)===0&&a<40,s=Math.max(Math.min(t,70),-70),d=Math.pow(l?1.23:1.09,s/20);return{scale:Math.max(n,Math.min(o,e*d))}};n()}catch(e){n(e)}})}}]);
//# sourceMappingURL=991.5e4ab084.js.map