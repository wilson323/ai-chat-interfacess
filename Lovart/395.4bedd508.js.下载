try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},o=(new e.Error).stack;o&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[o]="4cf93fa2-c11e-4652-b13e-1fc78037f359",e._sentryDebugIdIdentifier="sentry-dbid-4cf93fa2-c11e-4652-b13e-1fc78037f359")}catch(e){}("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{}).SENTRY_RELEASE={id:"ee8681250888aa891f2587e8576c9c5e77457690"};"use strict";(self.webpackChunk_shakkerai_web_pro=self.webpackChunk_shakkerai_web_pro||[]).push([["395"],{31794:function(e,o,t){t.d(o,{Z:()=>r});var n=t(97458);t(52983);let r=e=>(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:32,height:32,fill:"none",viewBox:"0 0 32 32",...e,children:[(0,n.jsx)("path",{fill:"#00A8B7",d:"m10.347 14.464 5.695 5.695-1.06 1.06-5.695-5.694z"}),(0,n.jsx)("path",{fill:"#00A8B7",d:"m13.934 20.196 9.677-9.678 1.06 1.06-9.677 9.679z"})]})},16131:function(e,o,t){t.d(o,{C8:()=>c,XQ:()=>d,v_:()=>u});var n=t(66085),r=t(22281),l=t(53032),a=t(34158),s=t(42676);function i(){return n.config&&n.config.language?{"accept-language":n.config.language}:{}}let c=async(e,o,t)=>{let n=Object.assign(t||{},i());return n.token=(0,a.FV)(),f(await (0,r.hj)(l.U2,e,o,n,"get"))},u=async(e,o,t)=>{let n=Object.assign(t||{},i());return f(await (0,r.hj)(l.v_,e,o,n,"post"))},d=async function(e){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{timeout:6e4},s=Object.assign(t||{},i());s.token=(0,a.FV)();let c=(0,a.ey)();return f(await (0,r.hj)((e,o)=>(0,l.v_)(e,{...o,...n}),e,{...o,cid:c},s,"post"))};function f(e){if(401!==e.code)return e;(0,s.S)();let o=window.location;return n.config&&"aws"===n.config.env?(!["/","/pro","/canvas"].includes(o.pathname)||o.hash)&&window.location.reload():(!["/","/pro"].includes(o.pathname)||o.hash)&&(window.location.href="/"),e}},42904:function(e,o,t){t.d(o,{n:()=>a});var n=t(16131),r=t(29274),l=t(37865);async function a(e,o){let t=(0,l.Gr)(r.nGW);return await (0,n.C8)(t,{url:e,type:o||"sd"})}},80350:function(e,o,t){t.d(o,{p:()=>u});var n=t(94331),r=t.n(n),l=t(66085),a=t(16131),s=t(29274),i=t(37865);async function c(e){var o;let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t?s.cZw:s.sDq,r=(0,i.Gr)(n+`/${e}`),l=await (0,a.C8)(r);if(!t&&(null==l||null==(o=l.data)?void 0:o.securityToken)){let e=l.data,o=(0,i.vO)(e.securityToken,e.expiration);e.securityToken=o}return l}let u=async function(e){let o=arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{let t=await d(e);if(!t)return;let n={region:l.config.oss.ossRegion,bucket:o?l.config.oss.ossBucketForSDTmp:l.config.oss.ossBucket,stsToken:t.securityToken,accessKeyId:t.accessKeyId,accessKeySecret:t.accessKeySecret,refreshSTSTokenInterval:14400},a=new(r())({...n,refreshSTSToken:async()=>await f(e)});return a.customBaseConfig=n,a}catch(e){return console.error("getOssConfig","get oss token error"),console.error("getOssConfig",e),{code:-1,message:(null==e?void 0:e.message)||"get oss client error"}}};async function d(e){let o=await c(e,"aws"===l.config.env);if(-1===o.code)throw console.error("getOssConfig","get oss token error"),Error("get oss token error");let t=o.data;if(!t)throw console.error("getOssConfig","no res.data"),Error("no res.data");return t}async function f(e){let o=await d(e);return o?{accessKeyId:o.accessKeyId,accessKeySecret:o.accessKeySecret,stsToken:o.securityToken}:void console.error("refreshSTSToken","get oss config fail")}},94035:function(e,o,t){t.d(o,{G:()=>l});var n=t(46803),r=t.n(n);let l=async(e,o)=>{var t,n;let l=null==(n=globalThis)||null==(t=n.crypto)?void 0:t.subtle;if(l&&"function"==typeof l.digest)try{let t=await a(e);return null==o||o(t),t}catch(e){}return new Promise((t,n)=>{let l=Math.ceil(e.size/1048576);e.name,e.size,e.lastModified;let a=0,s=r().algo.SHA256.create(),i=new FileReader;function c(){let o=1048576*a,t=o+1048576>=e.size?e.size:o+1048576;i.readAsArrayBuffer(e.slice(o,t))}i.onload=function(e){var n;if(s.update(r().lib.WordArray.create(null==e||null==(n=e.target)?void 0:n.result)),++a<l)c();else{let e=s.finalize().toString(r().enc.Hex);null==o||o(e),t(e)}},i.onerror=function(){null==o||o(),n("Unable to calculate hash")},c()})};async function a(e){let o=await e.arrayBuffer();return Array.from(new Uint8Array(await crypto.subtle.digest("SHA-1",o))).map(e=>e.toString(16).padStart(2,"0")).join("")}},67154:function(e,o,t){t.r(o),t.d(o,{singleUploadForTraining:()=>r.qg,singleUploadForPro:()=>r.ag,singleUploadForCommunityImage:()=>r.VJ,getOssClient:()=>n.p,generateStringByLength:()=>r.fl,copyObjectToTmp:()=>i,modelUpload:()=>s,singleUploadForSD:()=>r.AR,singleUploadForSDTmp:()=>r.EY,copyObjectToOnline:()=>c,singleUploadForStarFlowFile:()=>r.MK,singleUploadForTemplate:()=>r.vo,singleUploadForCommunityOther:()=>r.ws,singleUploadImageForPro:()=>r.vi});var n=t(80350),r=t(97871),l=t(66085),a=t(94035);let s=async(e,o,t,r)=>{let s="modelUpload";try{if(!e||!o)return;let i=await (0,a.G)(o,t);if(!i)return;let c=await (0,n.p)("1");if(!c||-1===c.code)return;let u=o.name,d=u.substring(u.lastIndexOf("."));d&&i&&(u=i+d);let f=`web/model/${e}/${u}`,g=l.config.modelUploadPartSize,p=new URLSearchParams(location.search).get("partsize");if(p){let e=parseInt(p);e>0&&e<=20&&(g=1024*e*1024)}let y={timeout:l.config.modelUploadTimeout,parallel:l.config.modelUploadParallel,partSize:g,progress:(e,o,t)=>{r&&r(e,o,t)}},w=await c.multipartUpload(f,o,y);if(!w||!w.res||200!==w.res.status)return void console.error(s,"model upload fail");let h=`${l.config.oss.cdnHost}/${f}`;return{bucket:w.bucket,etag:w.etag,file:f,url:h}}catch(e){console.error(s,"model upload error"),console.error(s,e)}},i=async(e,o,t)=>{let n="copyObjectToTmp";try{return await u(e,!0,o,t)}catch(e){console.error(n,"error"),console.error(n,e)}},c=async(e,o,t)=>{let n="copyObjectToOnline";try{return await u(e,!1,o,t)}catch(e){console.error(n,"error"),console.error(n,e)}};async function u(e,o,t,r){let a="copys";try{if(!e)return;t=t||"0";let s=await (0,n.p)(t,o);if(!s||-1===s.code)return;let i=o?l.config.oss.cdnHost:l.config.oss.cdnHostForSDTmp,c=o?l.config.oss.ossBucket:l.config.oss.ossBucketForSDTmp,u=o?l.config.oss.cdnHostForSDTmp:l.config.oss.cdnHost,d=e.split(`${i}/`),f=d[d.length-1],g=`copy/${r||f}`,p=await s.copy(g,f,c);if(!p||!p.res||200!==p.res.status)return void console.error(a,"copy failed");return{file:g,url:`${u}/${g}`}}catch(e){console.error(a,"error"),console.error(a,e)}}},97871:function(e,o,t){t.d(o,{vi:()=>h,fl:()=>s,VJ:()=>g,qg:()=>f,ag:()=>d,AR:()=>i,ws:()=>p,vo:()=>u,EY:()=>c,MK:()=>y});var n=t(66085);let r=["0","1","2"];var l=t(80350),a=t(94035);let s=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:64,o="",t=Math.floor(e/10);for(let e=0;e<t;e++)o+=Math.random().toString(16).slice(2);return o.slice(0,e)},i=async(e,o,t)=>await w("0",e,o,null,null,t),c=async(e,o,t)=>await w("0",e,o,null,!0,t),u=async(e,o,t)=>await w("0",e,o,null,null,t),d=async(e,o,t)=>await w("0",e,o,null,null,t),f=async(e,o,t)=>await w("2",e,o,null,null,t),g=async(e,o,t)=>await w("1",e,o,"image",null,t),p=async(e,o,t)=>await w("1",e,o,"other",null,t),y=async(e,o,t)=>await w("3",e,o,null,null,t);async function w(e,o,t,s,i,c){let u=arguments.length>6&&void 0!==arguments[6]&&arguments[6],d="singleUpload",f=`bizCode: ${e}, uuid: ${o}, communityType: ${s},isSDTmp: ${i}, isImage: ${u}`;try{let u;if(!e)throw Error(`bizCode is empty: ${f}`);if(-1===r.indexOf(e))throw Error(`\u{975E}\u{6CD5}\u{7684}bizCode: ${f}`);if(!o)throw Error(`uuid is empty: ${f}`);if(!t)throw Error(`file is empty: ${f}`);let g=await (0,a.G)(t,c);if(!g)throw Error(`fileHash is empty: ${f}`);let p=await (0,l.p)(e,!!i);if(!p||-1===p.code)throw Error(`${(null==p?void 0:p.message)||"get oss client error"}: ${f}`);let y=t.name,w=y.substring(y.lastIndexOf("."));w&&g&&(y=g+w),"0"===e&&(u="img"),"1"===e&&(u="web","image"==s&&(u="web/image"),"other"==s&&(u="web")),"2"===e&&(u="train_img"),"3"===e&&(u="flow_file");let h=`${u}/${o}/${y}`;for(let e=0;e<3;e++)try{await p.put(h,t,{timeout:12e4});break}catch(o){console.error(d,"put oss error",o);let e=(null==o?void 0:o.message)+"requestId: "+(null==o?void 0:o.requestId);throw p.customBaseConfig&&(e=e+"customBaseConfig: "+JSON.stringify(p.customBaseConfig)),Error(e)}let m=`${i?n.config.oss.cdnHostForSDTmp:n.config.oss.cdnHost}/${h}`;return{file:h,url:m}}catch(o){var g,p;console.error(d,"get oss token error"),console.error(d,o);let e=null==(p=window)||null==(g=p.RumSDK)?void 0:g.default;throw(null==e?void 0:e.sendException)&&e.sendException({name:"customProImageUploadError",message:null==o?void 0:o.message,file:"single-upload",stack:(null==o?void 0:o.stack)||""}),Error(`${null==o?void 0:o.message}: ${f}`)}}let h=async(e,o,t)=>await w("0",e,o,null,null,t,!0)},29532:function(){}}]);
//# sourceMappingURL=395.4bedd508.js.map